
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>What&#39;s New in Pyramid 1.1 &#8212; The Pyramid Web Framework v1.9.2</title>
    <link rel="stylesheet" href="_static/pylons.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="copyright" title="著作権" href="copyright.html" />
    <link rel="next" title="What&#39;s New in Pyramid 1.0" href="whatsnew-1.0.html" />
    <link rel="prev" title="What&#39;s New in Pyramid 1.2" href="whatsnew-1.2.html" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/nobile/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/neuton/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="shortcut icon" href="_static/pyramid.ico"/>

  </head><body>







<div class="header-small">
	
	<div class="logo-small">
		<a href="index.html">
      		<img class="logo" src="_static/pyramid-small.png" alt="Logo"/>
		</a>
  	</div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="whatsnew-1.0.html" title="What&#39;s New in Pyramid 1.0"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="whatsnew-1.2.html" title="What&#39;s New in Pyramid 1.2"
             accesskey="P">前へ</a> |</li>
    	<li><a href="index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="what-s-new-in-pyramid-1-1">
<h1>What's New in Pyramid 1.1<a class="headerlink" href="#what-s-new-in-pyramid-1-1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>This article explains the new features in Pyramid version 1.1 as compared to
its predecessor, <span>Pyramid</span> 1.0.  It also documents backwards
incompatibilities between the two versions and deprecations added to Pyramid
1.1, as well as software dependency changes and notable documentation
additions.</p>
<div class="section" id="terminology-changes">
<h2>Terminology Changes<a class="headerlink" href="#terminology-changes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The term &quot;template&quot; used by the Pyramid documentation used to refer to both
&quot;paster templates&quot; and &quot;rendered templates&quot; (templates created by a rendering
engine.  i.e. Mako, Chameleon, Jinja, etc.).  &quot;Paster templates&quot; will now be
referred to as &quot;scaffolds&quot;, whereas the name for &quot;rendered templates&quot; will
remain as &quot;templates.&quot;</p>
</div>
<div class="section" id="major-feature-additions">
<h2>Major Feature Additions<a class="headerlink" href="#major-feature-additions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The major feature additions in Pyramid 1.1 are:</p>
<ul class="simple">
<li>Support for the <code class="docutils literal notranslate"><span class="pre">request.response</span></code> attribute.</li>
<li>New views introspection feature: <code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">pviews</span></code>.</li>
<li>Support for &quot;static&quot; routes.</li>
<li>Default HTTP exception view.</li>
<li><code class="docutils literal notranslate"><span class="pre">http_cache</span></code> view configuration parameter causes Pyramid to set HTTP
caching headers.</li>
<li>Features that make it easier to write scripts that work in a <span>Pyramid</span>
environment.</li>
</ul>
<div class="section" id="request-response">
<h3><code class="docutils literal notranslate"><span class="pre">request.response</span></code><a class="headerlink" href="#request-response" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul>
<li><p class="first">Instances of the <a class="reference internal" href="api/request.html#pyramid.request.Request" title="pyramid.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.request.Request</span></code></a> class now have a
<code class="docutils literal notranslate"><span class="pre">response</span></code> attribute.</p>
<p>The object passed to a view callable as <code class="docutils literal notranslate"><span class="pre">request</span></code> is an instance of
<a class="reference internal" href="api/request.html#pyramid.request.Request" title="pyramid.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.request.Request</span></code></a>. <code class="docutils literal notranslate"><span class="pre">request.response</span></code> is an instance of
the class <a class="reference internal" href="api/response.html#pyramid.response.Response" title="pyramid.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.response.Response</span></code></a>.  View callables that are
configured with a <a class="reference internal" href="glossary.html#term-renderer"><span class="xref std std-term">renderer</span></a> will return this response object to the
Pyramid router.  Therefore, code in a renderer-using view callable can set
response attributes such as <code class="docutils literal notranslate"><span class="pre">request.response.content_type</span></code> (before they
return, e.g. a dictionary to the renderer) and this will influence the HTTP
return value of the view callable.</p>
<p><code class="docutils literal notranslate"><span class="pre">request.response</span></code> can also be used in view callable code that is not
configured to use a renderer.  For example, a view callable might do
<code class="docutils literal notranslate"><span class="pre">request.response.body</span> <span class="pre">=</span> <span class="pre">'123';</span> <span class="pre">return</span> <span class="pre">request.response</span></code>.  However, the
response object that is produced by <code class="docutils literal notranslate"><span class="pre">request.response</span></code> must be <em>returned</em>
when a renderer is not in play in order to have any effect on the HTTP
response (it is not a &quot;global&quot; response, and modifications to it are not
somehow merged into a separately returned response object).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">request.response</span></code> object is lazily created, so its introduction does
not negatively impact performance.</p>
</li>
</ul>
</div>
<div class="section" id="paster-pviews">
<h3><code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">pviews</span></code><a class="headerlink" href="#paster-pviews" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>A new paster command named <code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">pviews</span></code> was added.  This command
prints a summary of potentially matching views for a given path.  See
the section entitled <a class="reference internal" href="narr/commandline.html#displaying-matching-views"><span class="std std-ref">Displaying Matching Views for a Given URL</span></a> for more
information.</li>
</ul>
</div>
<div class="section" id="static-routes">
<h3>Static Routes<a class="headerlink" href="#static-routes" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">add_route</span></code> method of the Configurator now accepts a <code class="docutils literal notranslate"><span class="pre">static</span></code>
argument.  If this argument is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the added route will never be
considered for matching when a request is handled.  Instead, it will only
be useful for URL generation via <code class="docutils literal notranslate"><span class="pre">route_url</span></code> and <code class="docutils literal notranslate"><span class="pre">route_path</span></code>.  See the
section entitled <a class="reference internal" href="narr/urldispatch.html#static-route-narr"><span class="std std-ref">Static Routes</span></a> for more information.</li>
</ul>
</div>
<div class="section" id="default-http-exception-view">
<h3>Default HTTP Exception View<a class="headerlink" href="#default-http-exception-view" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul>
<li><p class="first">A default exception view for the interface
<a class="reference internal" href="api/interfaces.html#pyramid.interfaces.IExceptionResponse" title="pyramid.interfaces.IExceptionResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.interfaces.IExceptionResponse</span></code></a> is now registered by
default.  This means that an instance of any exception class imported from
<a class="reference internal" href="api/httpexceptions.html#module-pyramid.httpexceptions" title="pyramid.httpexceptions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyramid.httpexceptions</span></code></a> (such as <code class="docutils literal notranslate"><span class="pre">HTTPFound</span></code>) can now be raised
from within view code; when raised, this exception view will render the
exception to a response.</p>
<p>To allow for configuration of this feature, the <a class="reference internal" href="glossary.html#term-configurator"><span class="xref std std-term">Configurator</span></a> now
accepts an additional keyword argument named <code class="docutils literal notranslate"><span class="pre">exceptionresponse_view</span></code>.
By default, this argument is populated with a default exception view
function that will be used when an HTTP exception is raised.  When <code class="docutils literal notranslate"><span class="pre">None</span></code>
is passed for this value, an exception view for HTTP exceptions will not be
registered.  Passing <code class="docutils literal notranslate"><span class="pre">None</span></code> returns the behavior of raising an HTTP
exception to that of Pyramid 1.0 (the exception will propagate to
<a class="reference internal" href="glossary.html#term-middleware"><span class="xref std std-term">middleware</span></a> and to the WSGI server).</p>
</li>
</ul>
</div>
<div class="section" id="http-cache">
<h3><code class="docutils literal notranslate"><span class="pre">http_cache</span></code><a class="headerlink" href="#http-cache" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>A new value <code class="docutils literal notranslate"><span class="pre">http_cache</span></code> can be used as a <a class="reference internal" href="glossary.html#term-view-configuration"><span class="xref std std-term">view configuration</span></a>
parameter.</p>
<p>When you supply an <code class="docutils literal notranslate"><span class="pre">http_cache</span></code> value to a view configuration, the
<code class="docutils literal notranslate"><span class="pre">Expires</span></code> and <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code> headers of a response generated by the
associated view callable are modified.  The value for <code class="docutils literal notranslate"><span class="pre">http_cache</span></code> may be
one of the following:</p>
<ul class="simple">
<li>A nonzero integer.  If it's a nonzero integer, it's treated as a number
of seconds.  This number of seconds will be used to compute the
<code class="docutils literal notranslate"><span class="pre">Expires</span></code> header and the <code class="docutils literal notranslate"><span class="pre">Cache-Control:</span> <span class="pre">max-age</span></code> parameter of
responses to requests which call this view.  For example:
<code class="docutils literal notranslate"><span class="pre">http_cache=3600</span></code> instructs the requesting browser to 'cache this
response for an hour, please'.</li>
<li>A <code class="docutils literal notranslate"><span class="pre">datetime.timedelta</span></code> instance.  If it's a <code class="docutils literal notranslate"><span class="pre">datetime.timedelta</span></code>
instance, it will be converted into a number of seconds, and that number
of seconds will be used to compute the <code class="docutils literal notranslate"><span class="pre">Expires</span></code> header and the
<code class="docutils literal notranslate"><span class="pre">Cache-Control:</span> <span class="pre">max-age</span></code> parameter of responses to requests which call
this view.  For example: <code class="docutils literal notranslate"><span class="pre">http_cache=datetime.timedelta(days=1)</span></code>
instructs the requesting browser to 'cache this response for a day,
please'.</li>
<li>Zero (<code class="docutils literal notranslate"><span class="pre">0</span></code>).  If the value is zero, the <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code> and
<code class="docutils literal notranslate"><span class="pre">Expires</span></code> headers present in all responses from this view will be
composed such that client browser cache (and any intermediate caches) are
instructed to never cache the response.</li>
<li>A two-tuple.  If it's a two tuple (e.g. <code class="docutils literal notranslate"><span class="pre">http_cache=(1,</span>
<span class="pre">{'public':True})</span></code>), the first value in the tuple may be a nonzero
integer or a <code class="docutils literal notranslate"><span class="pre">datetime.timedelta</span></code> instance; in either case this value
will be used as the number of seconds to cache the response.  The second
value in the tuple must be a dictionary.  The values present in the
dictionary will be used as input to the <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code> response
header.  For example: <code class="docutils literal notranslate"><span class="pre">http_cache=(3600,</span> <span class="pre">{'public':True})</span></code> means 'cache
for an hour, and add <code class="docutils literal notranslate"><span class="pre">public</span></code> to the Cache-Control header of the
response'.  All keys and values supported by the
<code class="docutils literal notranslate"><span class="pre">webob.cachecontrol.CacheControl</span></code> interface may be added to the
dictionary.  Supplying <code class="docutils literal notranslate"><span class="pre">{'public':True}</span></code> is equivalent to calling
<code class="docutils literal notranslate"><span class="pre">response.cache_control.public</span> <span class="pre">=</span> <span class="pre">True</span></code>.</li>
</ul>
<p>Providing a non-tuple value as <code class="docutils literal notranslate"><span class="pre">http_cache</span></code> is equivalent to calling
<code class="docutils literal notranslate"><span class="pre">response.cache_expires(value)</span></code> within your view's body.</p>
<p>Providing a two-tuple value as <code class="docutils literal notranslate"><span class="pre">http_cache</span></code> is equivalent to calling
<code class="docutils literal notranslate"><span class="pre">response.cache_expires(value[0],</span> <span class="pre">**value[1])</span></code> within your view's body.</p>
<p>If you wish to avoid influencing, the <code class="docutils literal notranslate"><span class="pre">Expires</span></code> header, and instead wish
to only influence <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code> headers, pass a tuple as <code class="docutils literal notranslate"><span class="pre">http_cache</span></code>
with the first element of <code class="docutils literal notranslate"><span class="pre">None</span></code>, e.g.: <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">{'public':True})</span></code>.</p>
<p>The environment setting <code class="docutils literal notranslate"><span class="pre">PYRAMID_PREVENT_HTTP_CACHE</span></code> and configuration
file value <code class="docutils literal notranslate"><span class="pre">prevent_http_cache</span></code> are synonymous and allow you to prevent
HTTP cache headers from being set by Pyramid's <code class="docutils literal notranslate"><span class="pre">http_cache</span></code> machinery
globally in a process.  see <a class="reference internal" href="narr/viewconfig.html#influencing-http-caching"><span class="std std-ref">Influencing HTTP Caching</span></a> and
<a class="reference internal" href="narr/environment.html#preventing-http-caching"><span class="std std-ref">Preventing HTTP Caching</span></a>.</p>
</div>
<div class="section" id="easier-scripting-writing">
<h3>Easier Scripting Writing<a class="headerlink" href="#easier-scripting-writing" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>A new API function <a class="reference internal" href="api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.paster.bootstrap()</span></code></a> has been added to make
writing scripts that need to work under Pyramid environment easier, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.paster</span> <span class="kn">import</span> <span class="n">bootstrap</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">(</span><span class="s1">&#39;/path/to/my/development.ini&#39;</span><span class="p">)</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]</span>
<span class="k">print</span> <span class="n">request</span><span class="o">.</span><span class="n">route_url</span><span class="p">(</span><span class="s1">&#39;myroute&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="narr/commandline.html#writing-a-script"><span class="std std-ref">Writing a Script</span></a> for more details.</p>
</div>
</div>
<div class="section" id="minor-feature-additions">
<h2>Minor Feature Additions<a class="headerlink" href="#minor-feature-additions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<ul>
<li><p class="first">It is now possible to invoke <code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">pshell</span></code> even if the paste ini file
section name pointed to in its argument is not actually a Pyramid WSGI
application.  The shell will work in a degraded mode, and will warn the
user.  See &quot;The Interactive Shell&quot; in the &quot;Creating a Pyramid Project&quot;
narrative documentation section.</p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">pshell</span></code>, <code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">pviews</span></code>, and <code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">proutes</span></code> commands
each now under the hood uses <a class="reference internal" href="api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.paster.bootstrap()</span></code></a>, which makes
it possible to supply an <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file without naming the &quot;right&quot; section
in the file that points at the actual Pyramid application.  Instead, you
can generally just run <code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">{pshell|proutes|pviews}</span> <span class="pre">development.ini</span></code>
and it will do mostly the right thing.</p>
</li>
<li><p class="first">It is now possible to add a <code class="docutils literal notranslate"><span class="pre">[pshell]</span></code> section to your application's .ini
configuration file, which influences the global names available to a pshell
session.  See <a class="reference internal" href="narr/commandline.html#extending-pshell"><span class="std std-ref">Extending the Shell</span></a>.</p>
</li>
<li><p class="first">The <a class="reference internal" href="api/config.html#pyramid.config.Configurator.scan" title="pyramid.config.Configurator.scan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.scan()</span></code></a> method has grown a <code class="docutils literal notranslate"><span class="pre">**kw</span></code>
argument.  <code class="docutils literal notranslate"><span class="pre">kw</span></code> argument represents a set of keyword arguments to pass to
the Venusian <code class="docutils literal notranslate"><span class="pre">Scanner</span></code> object created by Pyramid.  (See the
<a class="reference internal" href="glossary.html#term-venusian"><span class="xref std std-term">Venusian</span></a> documentation for more information about <code class="docutils literal notranslate"><span class="pre">Scanner</span></code>).</p>
</li>
<li><p class="first">New request property: <code class="docutils literal notranslate"><span class="pre">json_body</span></code>. This property will return the
JSON-decoded variant of the request body.  If the request body is not
well-formed JSON, this property will raise an exception.</p>
</li>
<li><p class="first">A <a class="reference external" href="http://en.wikipedia.org/wiki/JSONP">JSONP</a> renderer.  See
<a class="reference internal" href="narr/renderers.html#jsonp-renderer"><span class="std std-ref">JSONP Renderer</span></a> for more details.</p>
</li>
<li><p class="first">New authentication policy:
<a class="reference internal" href="api/authentication.html#pyramid.authentication.SessionAuthenticationPolicy" title="pyramid.authentication.SessionAuthenticationPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.authentication.SessionAuthenticationPolicy</span></code></a>, which uses a
session to store credentials.</p>
</li>
<li><p class="first">A function named <a class="reference internal" href="api/httpexceptions.html#pyramid.httpexceptions.exception_response" title="pyramid.httpexceptions.exception_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.httpexceptions.exception_response()</span></code></a> is a
shortcut that can be used to create HTTP exception response objects using
an HTTP integer status code.</p>
</li>
<li><p class="first">Integers and longs passed as <code class="docutils literal notranslate"><span class="pre">elements</span></code> to
<a class="reference internal" href="api/url.html#pyramid.url.resource_url" title="pyramid.url.resource_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.url.resource_url()</span></code></a> or
<a class="reference internal" href="api/request.html#pyramid.request.Request.resource_url" title="pyramid.request.Request.resource_url"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.request.Request.resource_url()</span></code></a> e.g. <code class="docutils literal notranslate"><span class="pre">resource_url(context,</span>
<span class="pre">request,</span> <span class="pre">1,</span> <span class="pre">2)</span></code> (<code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">2</span></code> are the <code class="docutils literal notranslate"><span class="pre">elements</span></code>) will now be
converted implicitly to strings in the result.  Previously passing integers
or longs as elements would cause a TypeError.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">pyramid_alchemy</span></code> scaffold now uses <code class="docutils literal notranslate"><span class="pre">query.get</span></code> rather than
<code class="docutils literal notranslate"><span class="pre">query.filter_by</span></code> to take better advantage of identity map caching.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">pyramid_alchemy</span></code> scaffold now has unit tests.</p>
</li>
<li><p class="first">Added a <a class="reference internal" href="api/i18n.html#pyramid.i18n.make_localizer" title="pyramid.i18n.make_localizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.i18n.make_localizer()</span></code></a> API.</p>
</li>
<li><p class="first">An exception raised by a <a class="reference internal" href="api/events.html#pyramid.events.NewRequest" title="pyramid.events.NewRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.events.NewRequest</span></code></a> event
subscriber can now be caught by an exception view.</p>
</li>
<li><p class="first">It is now possible to get information about why Pyramid raised a Forbidden
exception from within an exception view.  The <code class="docutils literal notranslate"><span class="pre">ACLDenied</span></code> object returned
by the <code class="docutils literal notranslate"><span class="pre">permits</span></code> method of each stock authorization policy
(<a class="reference internal" href="api/interfaces.html#pyramid.interfaces.IAuthorizationPolicy.permits" title="pyramid.interfaces.IAuthorizationPolicy.permits"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.interfaces.IAuthorizationPolicy.permits()</span></code></a>) is now attached
to the Forbidden exception as its <code class="docutils literal notranslate"><span class="pre">result</span></code> attribute.  Therefore, if
you've created a Forbidden exception view, you can see the ACE, ACL,
permission, and principals involved in the request as
eg. <code class="docutils literal notranslate"><span class="pre">context.result.permission</span></code>, <code class="docutils literal notranslate"><span class="pre">context.result.acl</span></code>, etc within the
logic of the Forbidden exception view.</p>
</li>
<li><p class="first">Don't explicitly prevent the <code class="docutils literal notranslate"><span class="pre">timeout</span></code> from being lower than the
<code class="docutils literal notranslate"><span class="pre">reissue_time</span></code> when setting up an
<a class="reference internal" href="api/authentication.html#pyramid.authentication.AuthTktAuthenticationPolicy" title="pyramid.authentication.AuthTktAuthenticationPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.authentication.AuthTktAuthenticationPolicy</span></code></a> (previously
such a configuration would raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>, now it's allowed,
although typically nonsensical).  Allowing the nonsensical configuration
made the code more understandable and required fewer tests.</p>
</li>
<li><p class="first">The <a class="reference internal" href="api/request.html#pyramid.request.Request" title="pyramid.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.request.Request</span></code></a> class now has a <code class="docutils literal notranslate"><span class="pre">ResponseClass</span></code>
attribute which points at <a class="reference internal" href="api/response.html#pyramid.response.Response" title="pyramid.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.response.Response</span></code></a>.</p>
</li>
<li><p class="first">The <a class="reference internal" href="api/response.html#pyramid.response.Response" title="pyramid.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.response.Response</span></code></a> class now has a <code class="docutils literal notranslate"><span class="pre">RequestClass</span></code>
interface which points at <a class="reference internal" href="api/request.html#pyramid.request.Request" title="pyramid.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.request.Request</span></code></a>.</p>
</li>
<li><p class="first">It is now possible to return an arbitrary object from a Pyramid view
callable even if a renderer is not used, as long as a suitable adapter to
<a class="reference internal" href="api/interfaces.html#pyramid.interfaces.IResponse" title="pyramid.interfaces.IResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.interfaces.IResponse</span></code></a> is registered for the type of the
returned object by using the new
<a class="reference internal" href="api/config.html#pyramid.config.Configurator.add_response_adapter" title="pyramid.config.Configurator.add_response_adapter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.add_response_adapter()</span></code></a> API.  See the
section in the Hooks chapter of the documentation entitled
<a class="reference internal" href="narr/hooks.html#using-iresponse"><span class="std std-ref">Changing How Pyramid Treats View Responses</span></a>.</p>
</li>
<li><p class="first">The Pyramid router will now, by default, call the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method of
response objects when returning a WSGI response.  This means that, among
other things, the <code class="docutils literal notranslate"><span class="pre">conditional_response</span></code> feature response objects
inherited from WebOb will now behave properly.</p>
</li>
<li><p class="first">New method named <a class="reference internal" href="api/request.html#pyramid.request.Request.is_response" title="pyramid.request.Request.is_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.request.Request.is_response()</span></code></a>.  This method
should be used instead of the <code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.view.is_response()</span></code> function,
which has been deprecated.</p>
</li>
<li><p class="first"><a class="reference internal" href="api/exceptions.html#pyramid.exceptions.NotFound" title="pyramid.exceptions.NotFound"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.exceptions.NotFound</span></code></a> is now just an alias for
<a class="reference internal" href="api/httpexceptions.html#pyramid.httpexceptions.HTTPNotFound" title="pyramid.httpexceptions.HTTPNotFound"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.httpexceptions.HTTPNotFound</span></code></a>.</p>
</li>
<li><p class="first"><a class="reference internal" href="api/exceptions.html#pyramid.exceptions.Forbidden" title="pyramid.exceptions.Forbidden"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.exceptions.Forbidden</span></code></a> is now just an alias for
<a class="reference internal" href="api/httpexceptions.html#pyramid.httpexceptions.HTTPForbidden" title="pyramid.httpexceptions.HTTPForbidden"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.httpexceptions.HTTPForbidden</span></code></a>.</p>
</li>
<li><p class="first">Added <code class="docutils literal notranslate"><span class="pre">mako.preprocessor</span></code> config file parameter; allows for a Mako
preprocessor to be specified as a Python callable or Python dotted name.
See <a class="reference external" href="https://github.com/Pylons/pyramid/pull/183">https://github.com/Pylons/pyramid/pull/183</a> for rationale.</p>
</li>
<li><p class="first">New API class: <a class="reference internal" href="api/static.html#pyramid.static.static_view" title="pyramid.static.static_view"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.static.static_view</span></code></a>.  This supersedes the
(now deprecated) <code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.view.static</span></code> class.
<a class="reference internal" href="api/static.html#pyramid.static.static_view" title="pyramid.static.static_view"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.static.static_view</span></code></a>, by default, serves up documents as the
result of the request's <code class="docutils literal notranslate"><span class="pre">path_info</span></code>, attribute rather than it's
<code class="docutils literal notranslate"><span class="pre">subpath</span></code> attribute (the inverse was true of
<code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.view.static</span></code>, and still is).
<a class="reference internal" href="api/static.html#pyramid.static.static_view" title="pyramid.static.static_view"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.static.static_view</span></code></a> exposes a <code class="docutils literal notranslate"><span class="pre">use_subpath</span></code> flag for use
when you want the static view to behave like the older deprecated version.</p>
</li>
<li><p class="first">A new api function <a class="reference internal" href="api/scripting.html#pyramid.scripting.prepare" title="pyramid.scripting.prepare"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.scripting.prepare()</span></code></a> has been added.  It is
a lower-level analogue of <a class="reference internal" href="api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.paster.bootstrap()</span></code></a> that accepts a
request and a registry instead of a config file argument, and is used for
the same purpose:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.scripting</span> <span class="kn">import</span> <span class="n">prepare</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">prepare</span><span class="p">(</span><span class="n">registry</span><span class="o">=</span><span class="n">myregistry</span><span class="p">)</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]</span>
<span class="k">print</span> <span class="n">request</span><span class="o">.</span><span class="n">route_url</span><span class="p">(</span><span class="s1">&#39;myroute&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">A new API function <code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.scripting.make_request()</span></code> has been added.
The resulting request will have a <code class="docutils literal notranslate"><span class="pre">registry</span></code> attribute.  It is meant to
be used in conjunction with <a class="reference internal" href="api/scripting.html#pyramid.scripting.prepare" title="pyramid.scripting.prepare"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.scripting.prepare()</span></code></a> and/or
<a class="reference internal" href="api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.paster.bootstrap()</span></code></a> (both of which accept a request as an
argument):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.scripting</span> <span class="kn">import</span> <span class="n">make_request</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">make_request</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">New API attribute <a class="reference internal" href="api/config.html#pyramid.config.global_registries" title="pyramid.config.global_registries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pyramid.config.global_registries</span></code></a> is an iterable
object that contains references to every Pyramid registry loaded into the
current process via <a class="reference internal" href="api/config.html#pyramid.config.Configurator.make_wsgi_app" title="pyramid.config.Configurator.make_wsgi_app"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.make_wsgi_app()</span></code></a>.  It also
has a <code class="docutils literal notranslate"><span class="pre">last</span></code> attribute containing the last registry loaded.  This is used
by the scripting machinery, and is available for introspection.</p>
</li>
<li><p class="first">Added the <a class="reference internal" href="api/renderers.html#pyramid.renderers.null_renderer" title="pyramid.renderers.null_renderer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pyramid.renderers.null_renderer</span></code></a> object as an API.  The
null renderer is an object that can be used in advanced integration cases
as input to the view configuration <code class="docutils literal notranslate"><span class="pre">renderer=</span></code> argument.  When the null
renderer is used as a view renderer argument, Pyramid avoids converting the
view callable result into a Response object.  This is useful if you want to
reuse the view configuration and lookup machinery outside the context of
its use by the Pyramid router.  (This feature was added for consumption by
the <code class="docutils literal notranslate"><span class="pre">pyramid_rpc</span></code> package, which uses view configuration and lookup
outside the context of a router in exactly this way.)</p>
</li>
</ul>
</div>
<div class="section" id="backwards-incompatibilities">
<h2>Backwards Incompatibilities<a class="headerlink" href="#backwards-incompatibilities" title="このヘッドラインへのパーマリンク">¶</a></h2>
<ul>
<li><p class="first">Pyramid no longer supports Python 2.4.  Python 2.5 or better is required to
run Pyramid 1.1+.  Pyramid, however, does not work under any version of
Python 3 yet.</p>
</li>
<li><p class="first">The Pyramid router now, by default, expects response objects returned from
view callables to implement the <a class="reference internal" href="api/interfaces.html#pyramid.interfaces.IResponse" title="pyramid.interfaces.IResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.interfaces.IResponse</span></code></a>
interface.  Unlike the Pyramid 1.0 version of this interface, objects which
implement IResponse now must define a <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method that accepts
<code class="docutils literal notranslate"><span class="pre">environ</span></code> and <code class="docutils literal notranslate"><span class="pre">start_response</span></code>, and which returns an <code class="docutils literal notranslate"><span class="pre">app_iter</span></code>
iterable, among other things.  Previously, it was possible to return any
object which had the three WebOb <code class="docutils literal notranslate"><span class="pre">app_iter</span></code>, <code class="docutils literal notranslate"><span class="pre">headerlist</span></code>, and
<code class="docutils literal notranslate"><span class="pre">status</span></code> attributes as a response, so this is a backwards
incompatibility.  It is possible to get backwards compatibility back by
registering an adapter to IResponse from the type of object you're now
returning from view callables.  See the section in the Hooks chapter of the
documentation entitled <a class="reference internal" href="narr/hooks.html#using-iresponse"><span class="std std-ref">Changing How Pyramid Treats View Responses</span></a>.</p>
</li>
<li><p class="first">The <a class="reference internal" href="api/interfaces.html#pyramid.interfaces.IResponse" title="pyramid.interfaces.IResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.interfaces.IResponse</span></code></a> interface is now much more
extensive.  Previously it defined only <code class="docutils literal notranslate"><span class="pre">app_iter</span></code>, <code class="docutils literal notranslate"><span class="pre">status</span></code> and
<code class="docutils literal notranslate"><span class="pre">headerlist</span></code>; now it is basically intended to directly mirror the
<code class="docutils literal notranslate"><span class="pre">webob.Response</span></code> API, which has many methods and attributes.</p>
</li>
<li><p class="first">The <a class="reference internal" href="api/httpexceptions.html#module-pyramid.httpexceptions" title="pyramid.httpexceptions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyramid.httpexceptions</span></code></a> classes named <code class="docutils literal notranslate"><span class="pre">HTTPFound</span></code>,
<code class="docutils literal notranslate"><span class="pre">HTTPMultipleChoices</span></code>, <code class="docutils literal notranslate"><span class="pre">HTTPMovedPermanently</span></code>, <code class="docutils literal notranslate"><span class="pre">HTTPSeeOther</span></code>,
<code class="docutils literal notranslate"><span class="pre">HTTPUseProxy</span></code>, and <code class="docutils literal notranslate"><span class="pre">HTTPTemporaryRedirect</span></code> now accept <code class="docutils literal notranslate"><span class="pre">location</span></code> as
their first positional argument rather than <code class="docutils literal notranslate"><span class="pre">detail</span></code>.  This means that
you can do, e.g. <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">pyramid.httpexceptions.HTTPFound('http://foo')</span></code>
rather than <code class="docutils literal notranslate"><span class="pre">return</span>
<span class="pre">pyramid.httpexceptions.HTTPFound(location='http//foo')</span></code> (the latter will
of course continue to work).</p>
</li>
<li><p class="first">The pyramid Router attempted to set a value into the key
<code class="docutils literal notranslate"><span class="pre">environ['repoze.bfg.message']</span></code> when it caught a view-related exception
for backwards compatibility with applications written for <code class="xref py py-mod docutils literal notranslate"><span class="pre">repoze.bfg</span></code>
during error handling.  It did this by using code that looked like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># &quot;why&quot; is an exception object</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">why</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="n">environ</span><span class="p">[</span><span class="s1">&#39;repoze.bfg.message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msg</span>
</pre></div>
</div>
<p>Use of the value <code class="docutils literal notranslate"><span class="pre">environ['repoze.bfg.message']</span></code> was docs-deprecated in
Pyramid 1.0.  Our standing policy is to not remove features after a
deprecation for two full major releases, so this code was originally slated
to be removed in Pyramid 1.2.  However, computing the
<code class="docutils literal notranslate"><span class="pre">repoze.bfg.message</span></code> value was the source of at least one bug found in
the wild (<a class="reference external" href="https://github.com/Pylons/pyramid/issues/199">https://github.com/Pylons/pyramid/issues/199</a>), and there isn't a
foolproof way to both preserve backwards compatibility and to fix the bug.
Therefore, the code which sets the value has been removed in this release.
Code in exception views which relies on this value's presence in the
environment should now use the <code class="docutils literal notranslate"><span class="pre">exception</span></code> attribute of the request
(e.g. <code class="docutils literal notranslate"><span class="pre">request.exception[0]</span></code>) to retrieve the message instead of relying
on <code class="docutils literal notranslate"><span class="pre">request.environ['repoze.bfg.message']</span></code>.</p>
</li>
</ul>
</div>
<div class="section" id="deprecations-and-behavior-differences">
<h2>Deprecations and Behavior Differences<a class="headerlink" href="#deprecations-and-behavior-differences" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">Under Python 2.7+, it's necessary to pass the Python interpreter
the correct warning flags to see deprecation warnings emitted by Pyramid
when porting your application from an older version of Pyramid.  Use the
<code class="docutils literal notranslate"><span class="pre">PYTHONWARNINGS</span></code> environment variable with the value <code class="docutils literal notranslate"><span class="pre">all</span></code> in the
shell you use to invoke <code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">serve</span></code> to see these warnings, e.g. on
UNIX, <code class="docutils literal notranslate"><span class="pre">PYTHONWARNINGS=all</span> <span class="pre">$VENV/bin/paster</span> <span class="pre">serve</span> <span class="pre">development.ini</span></code>.
Python 2.5 and 2.6 show deprecation warnings by default,
so this is unnecessary there.
All deprecation warnings are emitted to the console.</p>
</div>
<ul>
<li><p class="first">The <code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.view.static</span></code> class has been deprecated in favor of the
newer <a class="reference internal" href="api/static.html#pyramid.static.static_view" title="pyramid.static.static_view"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.static.static_view</span></code></a> class.  A deprecation warning is
raised when it is used.  You should replace it with a reference to
<a class="reference internal" href="api/static.html#pyramid.static.static_view" title="pyramid.static.static_view"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.static.static_view</span></code></a> with the <code class="docutils literal notranslate"><span class="pre">use_subpath=True</span></code> argument.</p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">pshell</span></code>, <code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">proutes</span></code>, and <code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">pviews</span></code> commands
now take a single argument in the form <code class="docutils literal notranslate"><span class="pre">/path/to/config.ini#sectionname</span></code>
rather than the previous 2-argument spelling <code class="docutils literal notranslate"><span class="pre">/path/to/config.ini</span>
<span class="pre">sectionname</span></code>.  <code class="docutils literal notranslate"><span class="pre">#sectionname</span></code> may be omitted, in which case <code class="docutils literal notranslate"><span class="pre">#main</span></code> is
assumed.</p>
</li>
<li><p class="first">The default Mako renderer is now configured to escape all HTML in
expression tags. This is intended to help prevent XSS attacks caused by
rendering unsanitized input from users. To revert this behavior in user's
templates, they need to filter the expression through the 'n' filter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>${ myhtml | n }.
</pre></div>
</div>
<p>See <a class="reference external" href="https://github.com/Pylons/pyramid/issues/193">https://github.com/Pylons/pyramid/issues/193</a>.</p>
</li>
<li><p class="first">Deprecated all assignments to <code class="docutils literal notranslate"><span class="pre">request.response_*</span></code> attributes (for
example <code class="docutils literal notranslate"><span class="pre">request.response_content_type</span> <span class="pre">=</span> <span class="pre">'foo'</span></code> is now deprecated).
Assignments and mutations of assignable request attributes that were
considered by the framework for response influence are now deprecated:
<code class="docutils literal notranslate"><span class="pre">response_content_type</span></code>, <code class="docutils literal notranslate"><span class="pre">response_headerlist</span></code>, <code class="docutils literal notranslate"><span class="pre">response_status</span></code>,
<code class="docutils literal notranslate"><span class="pre">response_charset</span></code>, and <code class="docutils literal notranslate"><span class="pre">response_cache_for</span></code>.  Instead of assigning
these to the request object for later detection by the rendering machinery,
users should use the appropriate API of the Response object created by
accessing <code class="docutils literal notranslate"><span class="pre">request.response</span></code> (e.g. code which does
<code class="docutils literal notranslate"><span class="pre">request.response_content_type</span> <span class="pre">=</span> <span class="pre">'abc'</span></code> should be changed to
<code class="docutils literal notranslate"><span class="pre">request.response.content_type</span> <span class="pre">=</span> <span class="pre">'abc'</span></code>).</p>
</li>
<li><p class="first">Passing view-related parameters to
<a class="reference internal" href="api/config.html#pyramid.config.Configurator.add_route" title="pyramid.config.Configurator.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.add_route()</span></code></a> is now deprecated.
Previously, a view was permitted to be connected to a route using a set of
<code class="docutils literal notranslate"><span class="pre">view*</span></code> parameters passed to the <code class="docutils literal notranslate"><span class="pre">add_route</span></code> method of the
Configurator.  This was a shorthand which replaced the need to perform a
subsequent call to <code class="docutils literal notranslate"><span class="pre">add_view</span></code>. For example, it was valid (and often
recommended) to do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;mypackage.views.myview&#39;</span><span class="p">,</span>
                  <span class="n">view_renderer</span><span class="o">=</span><span class="s1">&#39;some/renderer.pt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Passing <code class="docutils literal notranslate"><span class="pre">view*</span></code> arguments to <code class="docutils literal notranslate"><span class="pre">add_route</span></code> is now deprecated in favor of
connecting a view to a predefined route via
<a class="reference internal" href="api/config.html#pyramid.config.Configurator.add_view" title="pyramid.config.Configurator.add_view"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.add_view()</span></code></a> using the route's
<code class="docutils literal notranslate"><span class="pre">route_name</span></code> parameter.  As a result, the above example should now be
spelled:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="n">config</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="s1">&#39;mypackage.views.myview&#39;</span><span class="p">,</span> <span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;home&#39;</span><span class="p">,</span>
                <span class="n">renderer</span><span class="o">=</span><span class="s1">&#39;some/renderer.pt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This deprecation was done to reduce confusion observed in IRC, as well as
to (eventually) reduce documentation burden.  A deprecation warning is
now issued when any view-related parameter is passed to <code class="docutils literal notranslate"><span class="pre">add_route</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">See also <a class="reference external" href="https://github.com/Pylons/pyramid/issues/164">issue #164 on GitHub</a>.</p>
</div>
</li>
<li><p class="first">Passing an <code class="docutils literal notranslate"><span class="pre">environ</span></code> dictionary to the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method of a
&quot;traverser&quot; (e.g. an object that implements
<code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.interfaces.ITraverser</span></code> such as an instance of
<code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.traversal.ResourceTreeTraverser</span></code>) as its <code class="docutils literal notranslate"><span class="pre">request</span></code>
argument now causes a deprecation warning to be emitted.  Consumer code
should pass a <code class="docutils literal notranslate"><span class="pre">request</span></code> object instead.  The fact that passing an environ
dict is permitted has been documentation-deprecated since <code class="docutils literal notranslate"><span class="pre">repoze.bfg</span></code>
1.1, and this capability will be removed entirely in a future version.</p>
</li>
<li><p class="first">The following (undocumented, dictionary-like) methods of the
<a class="reference internal" href="api/request.html#pyramid.request.Request" title="pyramid.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.request.Request</span></code></a> object have been deprecated:
<code class="docutils literal notranslate"><span class="pre">__contains__</span></code>, <code class="docutils literal notranslate"><span class="pre">__delitem__</span></code>, <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>, <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>,
<code class="docutils literal notranslate"><span class="pre">__setitem__</span></code>, <code class="docutils literal notranslate"><span class="pre">get</span></code>, <code class="docutils literal notranslate"><span class="pre">has_key</span></code>, <code class="docutils literal notranslate"><span class="pre">items</span></code>, <code class="docutils literal notranslate"><span class="pre">iteritems</span></code>,
<code class="docutils literal notranslate"><span class="pre">itervalues</span></code>, <code class="docutils literal notranslate"><span class="pre">keys</span></code>, <code class="docutils literal notranslate"><span class="pre">pop</span></code>, <code class="docutils literal notranslate"><span class="pre">popitem</span></code>, <code class="docutils literal notranslate"><span class="pre">setdefault</span></code>, <code class="docutils literal notranslate"><span class="pre">update</span></code>,
and <code class="docutils literal notranslate"><span class="pre">values</span></code>.  Usage of any of these methods will cause a deprecation
warning to be emitted.  These methods were added for internal compatibility
in <code class="docutils literal notranslate"><span class="pre">repoze.bfg</span></code> 1.1 (code that currently expects a request object
expected an environ object in BFG 1.0 and before).  In a future version,
these methods will be removed entirely.</p>
</li>
<li><p class="first">A custom request factory is now required to return a request object that
has a <code class="docutils literal notranslate"><span class="pre">response</span></code> attribute (or &quot;reified&quot;/lazy property) if the
request is meant to be used in a view that uses a renderer.  This
<code class="docutils literal notranslate"><span class="pre">response</span></code> attribute should be an instance of the class
<a class="reference internal" href="api/response.html#pyramid.response.Response" title="pyramid.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.response.Response</span></code></a>.</p>
</li>
<li><p class="first">The JSON and string renderer factories now assign to
<code class="docutils literal notranslate"><span class="pre">request.response.content_type</span></code> rather than
<code class="docutils literal notranslate"><span class="pre">request.response_content_type</span></code>.</p>
</li>
<li><p class="first">Each built-in renderer factory now determines whether it should change the
content type of the response by comparing the response's content type
against the response's default content type; if the content type is the
default content type (usually <code class="docutils literal notranslate"><span class="pre">text/html</span></code>), the renderer changes the
content type (to <code class="docutils literal notranslate"><span class="pre">application/json</span></code> or <code class="docutils literal notranslate"><span class="pre">text/plain</span></code> for JSON and string
renderers respectively).</p>
</li>
<li><p class="first">The <a class="reference internal" href="api/wsgi.html#pyramid.wsgi.wsgiapp2" title="pyramid.wsgi.wsgiapp2"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.wsgi.wsgiapp2()</span></code></a> now uses a slightly different method of
figuring out how to &quot;fix&quot; <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code> and <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> for the
downstream application.  As a result, those values may differ slightly from
the perspective of the downstream application (for example, <code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code>
will now never possess a trailing slash).</p>
</li>
<li><p class="first">Previously, <a class="reference internal" href="api/request.html#pyramid.request.Request" title="pyramid.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.request.Request</span></code></a> inherited from
<a class="reference external" href="https://docs.pylonsproject.org/projects/webob/en/latest/api/request.html#webob.request.Request" title="(in WebOb v1.8.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">webob.request.Request</span></code></a> and implemented <code class="docutils literal notranslate"><span class="pre">__getattr__</span></code>,
<code class="docutils literal notranslate"><span class="pre">__setattr__</span></code> and <code class="docutils literal notranslate"><span class="pre">__delattr__</span></code> itself in order to override &quot;adhoc
attr&quot; WebOb behavior where attributes of the request are stored in the
environ.  Now, <a class="reference internal" href="api/request.html#pyramid.request.Request" title="pyramid.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.request.Request</span></code></a> inherits from (the more
recent) <a class="reference external" href="https://docs.pylonsproject.org/projects/webob/en/latest/api/request.html#webob.request.BaseRequest" title="(in WebOb v1.8.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">webob.request.BaseRequest</span></code></a> instead of
<a class="reference external" href="https://docs.pylonsproject.org/projects/webob/en/latest/api/request.html#webob.request.Request" title="(in WebOb v1.8.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">webob.request.Request</span></code></a>, which provides the same behavior.
<a class="reference internal" href="api/request.html#pyramid.request.Request" title="pyramid.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.request.Request</span></code></a> no longer implements its own
<code class="docutils literal notranslate"><span class="pre">__getattr__</span></code>, <code class="docutils literal notranslate"><span class="pre">__setattr__</span></code> or <code class="docutils literal notranslate"><span class="pre">__delattr__</span></code> as a result.</p>
</li>
<li><p class="first">Deprecated <code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.view.is_response()</span></code> function in favor of
(newly-added) <a class="reference internal" href="api/request.html#pyramid.request.Request.is_response" title="pyramid.request.Request.is_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.request.Request.is_response()</span></code></a> method.
Determining if an object is truly a valid response object now requires
access to the registry, which is only easily available as a request
attribute.  The <code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.view.is_response()</span></code> function will still work
until it is removed, but now may return an incorrect answer under some
(very uncommon) circumstances.</p>
</li>
<li><p class="first"><a class="reference internal" href="api/response.html#pyramid.response.Response" title="pyramid.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.response.Response</span></code></a> is now a <em>subclass</em> of
<code class="docutils literal notranslate"><span class="pre">webob.response.Response</span></code> (in order to directly implement the
<a class="reference internal" href="api/interfaces.html#pyramid.interfaces.IResponse" title="pyramid.interfaces.IResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.interfaces.IResponse</span></code></a> interface, to speed up response
generation).</p>
</li>
<li><p class="first">The &quot;exception response&quot; objects importable from <code class="docutils literal notranslate"><span class="pre">pyramid.httpexceptions</span></code>
(e.g. <code class="docutils literal notranslate"><span class="pre">HTTPNotFound</span></code>) are no longer just import aliases for classes that
actually live in <code class="docutils literal notranslate"><span class="pre">webob.exc</span></code>.  Instead, we've defined our own exception
classes within the module that mirror and emulate the <code class="docutils literal notranslate"><span class="pre">webob.exc</span></code>
exception response objects almost entirely.  See
<a class="reference internal" href="designdefense.html#http-exception-hierarchy"><span class="std std-ref">Pyramid uses its own HTTP exception class hierarchy rather than webob.exc</span></a> in the Design Defense chapter for more
information.</p>
</li>
<li><p class="first">When visiting a URL that represented a static view which resolved to a
subdirectory, the <code class="docutils literal notranslate"><span class="pre">index.html</span></code> of that subdirectory would not be served
properly.  Instead, a redirect to <code class="docutils literal notranslate"><span class="pre">/subdir</span></code> would be issued.  This has
been fixed, and now visiting a subdirectory that contains an <code class="docutils literal notranslate"><span class="pre">index.html</span></code>
within a static view returns the index.html properly.</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">See also <a class="reference external" href="https://github.com/Pylons/pyramid/issues/67">issue #67 on GitHub</a>.</p>
</div>
</li>
<li><p class="first">Deprecated the <code class="docutils literal notranslate"><span class="pre">pyramid.config.Configurator.set_renderer_globals_factory</span></code>
method and the <code class="docutils literal notranslate"><span class="pre">renderer_globals</span></code> Configurator constructor parameter.
Users should convert code using this feature to use a BeforeRender event. See
the section <a class="reference internal" href="narr/hooks.html#beforerender-event"><span class="std std-ref">Using the Before Render Event</span></a> in the Hooks chapter.</p>
</li>
<li><p class="first">In Pyramid 1.0, the <a class="reference internal" href="api/events.html#pyramid.events.subscriber" title="pyramid.events.subscriber"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.events.subscriber</span></code></a> directive behaved
contrary to the documentation when passed more than one interface object to
its constructor.  For example, when the following listener was registered:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@subscriber</span><span class="p">(</span><span class="n">IFoo</span><span class="p">,</span> <span class="n">IBar</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">expects_ifoo_events_and_ibar_events</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="nb">print</span> <span class="n">event</span>
</pre></div>
</div>
<p>The Events chapter docs claimed that the listener would be registered and
listening for both <code class="docutils literal notranslate"><span class="pre">IFoo</span></code> and <code class="docutils literal notranslate"><span class="pre">IBar</span></code> events.  Instead, it registered an
&quot;object event&quot; subscriber which would only be called if an IObjectEvent was
emitted where the object interface was <code class="docutils literal notranslate"><span class="pre">IFoo</span></code> and the event interface was
<code class="docutils literal notranslate"><span class="pre">IBar</span></code>.</p>
<p>The behavior now matches the documentation. If you were relying on the
buggy behavior of the 1.0 <code class="docutils literal notranslate"><span class="pre">subscriber</span></code> directive in order to register an
object event subscriber, you must now pass a sequence to indicate you'd
like to register a subscriber for an object event. e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@subscriber</span><span class="p">([</span><span class="n">IFoo</span><span class="p">,</span> <span class="n">IBar</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">expects_object_event</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="nb">print</span> <span class="nb">object</span><span class="p">,</span> <span class="n">event</span>
</pre></div>
</div>
</li>
<li><p class="first">In 1.0, if a <a class="reference internal" href="api/events.html#pyramid.events.BeforeRender" title="pyramid.events.BeforeRender"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.events.BeforeRender</span></code></a> event subscriber added a
value via the <code class="docutils literal notranslate"><span class="pre">__setitem__</span></code> or <code class="docutils literal notranslate"><span class="pre">update</span></code> methods of the event object
with a key that already existed in the renderer globals dictionary, a
<code class="docutils literal notranslate"><span class="pre">KeyError</span></code> was raised.  With the deprecation of the
&quot;add_renderer_globals&quot; feature of the configurator, there was no way to
override an existing value in the renderer globals dictionary that already
existed.  Now, the event object will overwrite an older value that is
already in the globals dictionary when its <code class="docutils literal notranslate"><span class="pre">__setitem__</span></code> or <code class="docutils literal notranslate"><span class="pre">update</span></code> is
called (as well as the new <code class="docutils literal notranslate"><span class="pre">setdefault</span></code> method), just like a plain old
dictionary.  As a result, for maximum interoperability with other
third-party subscribers, if you write an event subscriber meant to be used
as a BeforeRender subscriber, your subscriber code will now need to (using
<code class="docutils literal notranslate"><span class="pre">.get</span></code> or <code class="docutils literal notranslate"><span class="pre">__contains__</span></code> of the event object) ensure no value already
exists in the renderer globals dictionary before setting an overriding
value.</p>
</li>
<li><p class="first">The <a class="reference internal" href="api/config.html#pyramid.config.Configurator.add_route" title="pyramid.config.Configurator.add_route"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.add_route()</span></code></a> method allowed two routes
with the same route to be added without an intermediate call to
<a class="reference internal" href="api/config.html#pyramid.config.Configurator.commit" title="pyramid.config.Configurator.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.commit()</span></code></a>.  If you now receive a
<code class="docutils literal notranslate"><span class="pre">ConfigurationError</span></code> at startup time that appears to be <code class="docutils literal notranslate"><span class="pre">add_route</span></code>
related, you'll need to either a) ensure that all of your route names are
unique or b) call <code class="docutils literal notranslate"><span class="pre">config.commit()</span></code> before adding a second route with the
name of a previously added name or c) use a Configurator that works in
<code class="docutils literal notranslate"><span class="pre">autocommit</span></code> mode.</p>
</li>
</ul>
</div>
<div class="section" id="dependency-changes">
<h2>Dependency Changes<a class="headerlink" href="#dependency-changes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<ul class="simple">
<li>Pyramid now depends on <a class="reference internal" href="glossary.html#term-webob"><span class="xref std std-term">WebOb</span></a> &gt;= 1.0.2 as tests depend on the bugfix
in that release: &quot;Fix handling of WSGI environs with missing
<code class="docutils literal notranslate"><span class="pre">SCRIPT_NAME</span></code>&quot;.  (Note that in reality, everyone should probably be using
1.0.4 or better though, as WebOb 1.0.2 and 1.0.3 were effectively brownbag
releases.)</li>
</ul>
</div>
<div class="section" id="documentation-enhancements">
<h2>Documentation Enhancements<a class="headerlink" href="#documentation-enhancements" title="このヘッドラインへのパーマリンク">¶</a></h2>
<ul class="simple">
<li>Added a section entitled <a class="reference internal" href="narr/commandline.html#writing-a-script"><span class="std std-ref">Writing a Script</span></a> to the &quot;Command-Line
Pyramid&quot; chapter.</li>
<li>The <a class="reference internal" href="tutorials/wiki/index.html#bfg-wiki-tutorial"><span class="std std-ref">ZODB + Traversal Wiki Tutorial</span></a> was updated slightly.</li>
<li>The <a class="reference internal" href="tutorials/wiki2/index.html#bfg-sql-wiki-tutorial"><span class="std std-ref">SQLAlchemy + URL dispatch wiki tutorial</span></a> was updated slightly.</li>
<li>Made <a class="reference internal" href="api/interfaces.html#pyramid.interfaces.IAuthenticationPolicy" title="pyramid.interfaces.IAuthenticationPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.interfaces.IAuthenticationPolicy</span></code></a> and
<a class="reference internal" href="api/interfaces.html#pyramid.interfaces.IAuthorizationPolicy" title="pyramid.interfaces.IAuthorizationPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.interfaces.IAuthorizationPolicy</span></code></a> public interfaces, and
they are now referred to within the <a class="reference internal" href="api/authentication.html#module-pyramid.authentication" title="pyramid.authentication"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyramid.authentication</span></code></a> and
<a class="reference internal" href="api/authorization.html#module-pyramid.authorization" title="pyramid.authorization"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyramid.authorization</span></code></a> API docs.</li>
<li>Render the function definitions for each exposed interface in
<a class="reference internal" href="api/interfaces.html#module-pyramid.interfaces" title="pyramid.interfaces"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyramid.interfaces</span></code></a>.</li>
<li>Add missing docs reference to
<a class="reference internal" href="api/config.html#pyramid.config.Configurator.set_view_mapper" title="pyramid.config.Configurator.set_view_mapper"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.set_view_mapper()</span></code></a> and refer to it within
the documentation section entitled <a class="reference internal" href="narr/hooks.html#using-a-view-mapper"><span class="std std-ref">Using a View Mapper</span></a>.</li>
<li>Added section to the &quot;Environment Variables and <code class="docutils literal notranslate"><span class="pre">.ini</span></code> File Settings&quot;
chapter in the narrative documentation section entitled
<a class="reference internal" href="narr/environment.html#adding-a-custom-setting"><span class="std std-ref">Adding a Custom Setting</span></a>.</li>
<li>Added documentation for a <a class="reference internal" href="glossary.html#term-multidict"><span class="xref std std-term">multidict</span></a> as
<a class="reference internal" href="api/interfaces.html#pyramid.interfaces.IMultiDict" title="pyramid.interfaces.IMultiDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.interfaces.IMultiDict</span></code></a>.</li>
<li>Added a section to the &quot;URL Dispatch&quot; narrative chapter regarding the new
&quot;static&quot; route feature entitled <a class="reference internal" href="narr/urldispatch.html#static-route-narr"><span class="std std-ref">Static Routes</span></a>.</li>
<li>Added API docs for <a class="reference internal" href="api/httpexceptions.html#pyramid.httpexceptions.exception_response" title="pyramid.httpexceptions.exception_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.httpexceptions.exception_response()</span></code></a>.</li>
<li>Added <a class="reference internal" href="narr/views.html#http-exceptions"><span class="std std-ref">HTTP Exceptions</span></a> section to Views narrative chapter including a
description of <a class="reference internal" href="api/httpexceptions.html#pyramid.httpexceptions.exception_response" title="pyramid.httpexceptions.exception_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.httpexceptions.exception_response()</span></code></a>.</li>
<li>Added API docs for
<a class="reference internal" href="api/authentication.html#pyramid.authentication.SessionAuthenticationPolicy" title="pyramid.authentication.SessionAuthenticationPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.authentication.SessionAuthenticationPolicy</span></code></a>.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">What's New in Pyramid 1.1</a><ul>
<li><a class="reference internal" href="#terminology-changes">Terminology Changes</a></li>
<li><a class="reference internal" href="#major-feature-additions">Major Feature Additions</a><ul>
<li><a class="reference internal" href="#request-response"><code class="docutils literal notranslate"><span class="pre">request.response</span></code></a></li>
<li><a class="reference internal" href="#paster-pviews"><code class="docutils literal notranslate"><span class="pre">paster</span> <span class="pre">pviews</span></code></a></li>
<li><a class="reference internal" href="#static-routes">Static Routes</a></li>
<li><a class="reference internal" href="#default-http-exception-view">Default HTTP Exception View</a></li>
<li><a class="reference internal" href="#http-cache"><code class="docutils literal notranslate"><span class="pre">http_cache</span></code></a></li>
<li><a class="reference internal" href="#easier-scripting-writing">Easier Scripting Writing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#minor-feature-additions">Minor Feature Additions</a></li>
<li><a class="reference internal" href="#backwards-incompatibilities">Backwards Incompatibilities</a></li>
<li><a class="reference internal" href="#deprecations-and-behavior-differences">Deprecations and Behavior Differences</a></li>
<li><a class="reference internal" href="#dependency-changes">Dependency Changes</a></li>
<li><a class="reference internal" href="#documentation-enhancements">Documentation Enhancements</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="whatsnew-1.2.html"
                        title="前の章へ">What's New in Pyramid 1.2</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="whatsnew-1.0.html"
                        title="次の章へ">What's New in Pyramid 1.0</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/whatsnew-1.1.rst.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="whatsnew-1.0.html" title="What&#39;s New in Pyramid 1.0"
             >次へ</a> |</li>
        <li class="right" >
          <a href="whatsnew-1.2.html" title="What&#39;s New in Pyramid 1.2"
             >前へ</a> |</li>
    	<li><a href="index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="copyright.html">Copyright</a> 2008-2018, Agendaless Consulting.
      最終更新: 8月 12, 2018
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4 で生成しました。
    </div>
  </body>
</html>