
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Views &#8212; The Pyramid Web Framework v1.9.2</title>
    <link rel="stylesheet" href="../_static/pylons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="next" title="Renderers" href="renderers.html" />
    <link rel="prev" title="URL Dispatch" href="urldispatch.html" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/nobile/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/neuton/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="shortcut icon" href="../_static/pyramid.ico"/>

  </head><body>







<div class="header-small">
	
	<div class="logo-small">
		<a href="../index.html">
      		<img class="logo" src="../_static/pyramid-small.png" alt="Logo"/>
		</a>
  	</div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="renderers.html" title="Renderers"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="urldispatch.html" title="URL Dispatch"
             accesskey="P">前へ</a> |</li>
    	<li><a href="../index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="views">
<span id="views-chapter"></span><h1>Views<a class="headerlink" href="#views" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>One of the primary jobs of <span>Pyramid</span> is to find and invoke a <a class="reference internal" href="../glossary.html#term-view-callable"><span class="xref std std-term">view
callable</span></a> when a <a class="reference internal" href="../glossary.html#term-request"><span class="xref std std-term">request</span></a> reaches your application.  View callables are
bits of code which do something interesting in response to a request made to
your application.  They are the &quot;meat&quot; of any interesting web application.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">A <span>Pyramid</span> <a class="reference internal" href="../glossary.html#term-view-callable"><span class="xref std std-term">view callable</span></a> is often referred to in
conversational shorthand as a <a class="reference internal" href="../glossary.html#term-view"><span class="xref std std-term">view</span></a>.  In this documentation, however,
we need to use less ambiguous terminology because there are significant
differences between view <em>configuration</em>, the code that implements a view
<em>callable</em>, and the process of view <em>lookup</em>.</p>
</div>
<p>This chapter describes how view callables should be defined. We'll have to wait
until a following chapter (entitled <a class="reference internal" href="viewconfig.html#view-config-chapter"><span class="std std-ref">View Configuration</span></a>) to find out how
we actually tell <span>Pyramid</span> to wire up view callables to particular URL
patterns and other request circumstances.</p>
<div class="section" id="view-callables">
<span id="index-0"></span><h2>View Callables<a class="headerlink" href="#view-callables" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>View callables are, at the risk of sounding obvious, callable Python objects.
Specifically, view callables can be functions, classes, or instances that
implement a <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method (making the instance callable).</p>
<p>View callables must, at a minimum, accept a single argument named <code class="docutils literal notranslate"><span class="pre">request</span></code>.
This argument represents a <span>Pyramid</span> <a class="reference internal" href="../glossary.html#term-request"><span class="xref std std-term">Request</span></a> object.  A request
object represents a <a class="reference internal" href="../glossary.html#term-wsgi"><span class="xref std std-term">WSGI</span></a> environment provided to <span>Pyramid</span> by the
upstream WSGI server. As you might expect, the request object contains
everything your application needs to know about the specific HTTP request being
made.</p>
<p>A view callable's ultimate responsibility is to create a <span>Pyramid</span>
<a class="reference internal" href="../glossary.html#term-response"><span class="xref std std-term">Response</span></a> object. This can be done by creating a <a class="reference internal" href="../glossary.html#term-response"><span class="xref std std-term">Response</span></a> object
in the view callable code and returning it directly or by raising special kinds
of exceptions from within the body of a view callable.</p>
</div>
<div class="section" id="defining-a-view-callable-as-a-function">
<span id="function-as-view"></span><span id="index-1"></span><h2>Defining a View Callable as a Function<a class="headerlink" href="#defining-a-view-callable-as-a-function" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>One of the easiest ways to define a view callable is to create a function that
accepts a single argument named <code class="docutils literal notranslate"><span class="pre">request</span></code>, and which returns a
<a class="reference internal" href="../glossary.html#term-response"><span class="xref std std-term">Response</span></a> object.  For example, this is a &quot;hello world&quot; view callable
implemented as a function:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.response</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="k">def</span> <span class="nf">hello_world</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="s1">&#39;Hello world!&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="defining-a-view-callable-as-a-class">
<span id="class-as-view"></span><span id="index-2"></span><h2>Defining a View Callable as a Class<a class="headerlink" href="#defining-a-view-callable-as-a-class" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A view callable may also be represented by a Python class instead of a
function.  When a view callable is a class, the calling semantics are slightly
different than when it is a function or another non-class callable. When a view
callable is a class, the class's <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method is called with a
<code class="docutils literal notranslate"><span class="pre">request</span></code> parameter.  As a result, an instance of the class is created.
Subsequently, that instance's <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method is invoked with no
parameters.  Views defined as classes must have the following traits.</p>
<ul class="simple">
<li>an <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method that accepts a <code class="docutils literal notranslate"><span class="pre">request</span></code> argument</li>
<li>a <code class="docutils literal notranslate"><span class="pre">__call__</span></code> (or other) method that accepts no parameters and which returns
a response</li>
</ul>
<p>For example:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.response</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="k">class</span> <span class="nc">MyView</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">request</span> <span class="o">=</span> <span class="n">request</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The request object passed to <code class="docutils literal notranslate"><span class="pre">__init__</span></code> is the same type of request object
described in <a class="reference internal" href="#function-as-view"><span class="std std-ref">Defining a View Callable as a Function</span></a>.</p>
<p>If you'd like to use a different attribute than <code class="docutils literal notranslate"><span class="pre">__call__</span></code> to represent the
method expected to return a response, you can use an <code class="docutils literal notranslate"><span class="pre">attr</span></code> value as part of
the configuration for the view.  See <a class="reference internal" href="viewconfig.html#view-configuration-parameters"><span class="std std-ref">View Configuration Parameters</span></a>. The
same view callable class can be used in different view configuration statements
with different <code class="docutils literal notranslate"><span class="pre">attr</span></code> values, each pointing at a different method of the
class if you'd like the class to represent a collection of related view
callables.</p>
</div>
<div class="section" id="view-callable-responses">
<span id="the-response"></span><span id="index-3"></span><h2>View Callable Responses<a class="headerlink" href="#view-callable-responses" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A view callable may return an object that implements the <span>Pyramid</span>
<a class="reference internal" href="../glossary.html#term-response"><span class="xref std std-term">Response</span></a> interface.  The easiest way to return something that
implements the <a class="reference internal" href="../glossary.html#term-response"><span class="xref std std-term">Response</span></a> interface is to return a
<a class="reference internal" href="../api/response.html#pyramid.response.Response" title="pyramid.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.response.Response</span></code></a> object instance directly.  For example:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.response</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p><span>Pyramid</span> provides a range of different &quot;exception&quot; classes which inherit
from <a class="reference internal" href="../api/response.html#pyramid.response.Response" title="pyramid.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.response.Response</span></code></a>.  For example, an instance of the class
<a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.HTTPFound" title="pyramid.httpexceptions.HTTPFound"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.httpexceptions.HTTPFound</span></code></a> is also a valid response object
because it inherits from <a class="reference internal" href="../api/response.html#pyramid.response.Response" title="pyramid.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a>.  For examples,
see <a class="reference internal" href="#http-exceptions"><span class="std std-ref">HTTP Exceptions</span></a> and <a class="reference internal" href="#http-redirect"><span class="std std-ref">Using a View Callable to do an HTTP Redirect</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">You can also return objects from view callables that aren't instances of
<a class="reference internal" href="../api/response.html#pyramid.response.Response" title="pyramid.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.response.Response</span></code></a> in various circumstances.  This can be
helpful when writing tests and when attempting to share code between view
callables.  See <a class="reference internal" href="renderers.html#renderers-chapter"><span class="std std-ref">Renderers</span></a> for the common way to allow for
this.  A much less common way to allow for view callables to return
non-Response objects is documented in <a class="reference internal" href="hooks.html#using-iresponse"><span class="std std-ref">Changing How Pyramid Treats View Responses</span></a>.</p>
</div>
</div>
<div class="section" id="using-special-exceptions-in-view-callables">
<span id="special-exceptions-in-callables"></span><span id="index-4"></span><h2>Using Special Exceptions in View Callables<a class="headerlink" href="#using-special-exceptions-in-view-callables" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Usually when a Python exception is raised within a view callable,
<span>Pyramid</span> allows the exception to propagate all the way out to the
<a class="reference internal" href="../glossary.html#term-wsgi"><span class="xref std std-term">WSGI</span></a> server which invoked the application.  It is usually caught and
logged there.</p>
<p>However, for convenience, a special set of exceptions exists.  When one of
these exceptions is raised within a view callable, it will always cause
<span>Pyramid</span> to generate a response.  These are known as <a class="reference internal" href="../glossary.html#term-http-exception"><span class="xref std std-term">HTTP
exception</span></a> objects.</p>
<div class="section" id="http-exceptions">
<span id="index-5"></span><span id="id1"></span><h3>HTTP Exceptions<a class="headerlink" href="#http-exceptions" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>All <a class="reference internal" href="../api/httpexceptions.html#module-pyramid.httpexceptions" title="pyramid.httpexceptions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyramid.httpexceptions</span></code></a> classes which are documented as inheriting
from the <a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.HTTPException" title="pyramid.httpexceptions.HTTPException"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.httpexceptions.HTTPException</span></code></a> are <a class="reference internal" href="../glossary.html#term-http-exception"><span class="xref std std-term">http
exception</span></a> objects.  Instances of an HTTP exception object may either be
<em>returned</em> or <em>raised</em> from within view code.  In either case (return or raise)
the instance will be used as the view's response.</p>
<p>For example, the <a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.HTTPUnauthorized" title="pyramid.httpexceptions.HTTPUnauthorized"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.httpexceptions.HTTPUnauthorized</span></code></a> exception can
be raised.  This will cause a response to be generated with a <code class="docutils literal notranslate"><span class="pre">401</span>
<span class="pre">Unauthorized</span></code> status:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.httpexceptions</span> <span class="kn">import</span> <span class="n">HTTPUnauthorized</span>

<span class="k">def</span> <span class="nf">aview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">HTTPUnauthorized</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>An HTTP exception, instead of being raised, can alternately be <em>returned</em> (HTTP
exceptions are also valid response objects):</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.httpexceptions</span> <span class="kn">import</span> <span class="n">HTTPUnauthorized</span>

<span class="k">def</span> <span class="nf">aview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">HTTPUnauthorized</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>A shortcut for creating an HTTP exception is the
<a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.exception_response" title="pyramid.httpexceptions.exception_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.httpexceptions.exception_response()</span></code></a> function.  This function
accepts an HTTP status code and returns the corresponding HTTP exception. For
example, instead of importing and constructing a
<a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.HTTPUnauthorized" title="pyramid.httpexceptions.HTTPUnauthorized"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTPUnauthorized</span></code></a> response object, you can use
the <a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.exception_response" title="pyramid.httpexceptions.exception_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">exception_response()</span></code></a> function to construct
and return the same object.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.httpexceptions</span> <span class="kn">import</span> <span class="n">exception_response</span>

<span class="k">def</span> <span class="nf">aview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">exception_response</span><span class="p">(</span><span class="mi">401</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>This is the case because <code class="docutils literal notranslate"><span class="pre">401</span></code> is the HTTP status code for &quot;HTTP
Unauthorized&quot;.  Therefore, <code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">exception_response(401)</span></code> is functionally
equivalent to <code class="docutils literal notranslate"><span class="pre">raise</span> <span class="pre">HTTPUnauthorized()</span></code>.  Documentation which maps each HTTP
response code to its purpose and its associated HTTP exception object is
provided within <a class="reference internal" href="../api/httpexceptions.html#module-pyramid.httpexceptions" title="pyramid.httpexceptions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyramid.httpexceptions</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.1 で追加: </span>The <a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.exception_response" title="pyramid.httpexceptions.exception_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">exception_response()</span></code></a> function.</p>
</div>
</div>
<div class="section" id="how-pyramid-uses-http-exceptions">
<h3>How Pyramid Uses HTTP Exceptions<a class="headerlink" href="#how-pyramid-uses-http-exceptions" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>HTTP exceptions are meant to be used directly by application developers.
However, Pyramid itself will raise two HTTP exceptions at various points during
normal operations.</p>
<ul class="simple">
<li><a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.HTTPNotFound" title="pyramid.httpexceptions.HTTPNotFound"><code class="xref py py-exc docutils literal notranslate"><span class="pre">HTTPNotFound</span></code></a> gets raised when a view to
service a request is not found.</li>
<li><a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.HTTPForbidden" title="pyramid.httpexceptions.HTTPForbidden"><code class="xref py py-exc docutils literal notranslate"><span class="pre">HTTPForbidden</span></code></a> gets raised when authorization
was forbidden by a security policy.</li>
</ul>
<p>If <a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.HTTPNotFound" title="pyramid.httpexceptions.HTTPNotFound"><code class="xref py py-exc docutils literal notranslate"><span class="pre">HTTPNotFound</span></code></a> is raised by Pyramid itself or
within view code, the result of the <a class="reference internal" href="../glossary.html#term-not-found-view"><span class="xref std std-term">Not Found View</span></a> will be returned to
the user agent which performed the request.</p>
<p>If <a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.HTTPForbidden" title="pyramid.httpexceptions.HTTPForbidden"><code class="xref py py-exc docutils literal notranslate"><span class="pre">HTTPForbidden</span></code></a> is raised by Pyramid itself
or within view code, the result of the <a class="reference internal" href="../glossary.html#term-forbidden-view"><span class="xref std std-term">Forbidden View</span></a> will be returned to
the user agent which performed the request.</p>
</div>
</div>
<div class="section" id="custom-exception-views">
<span id="exception-views"></span><span id="index-6"></span><h2>Custom Exception Views<a class="headerlink" href="#custom-exception-views" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The machinery which allows HTTP exceptions to be raised and caught by
specialized views as described in <a class="reference internal" href="#special-exceptions-in-callables"><span class="std std-ref">Using Special Exceptions in View Callables</span></a> can
also be used by application developers to convert arbitrary exceptions to
responses.</p>
<p>To register an <a class="reference internal" href="../glossary.html#term-exception-view"><span class="xref std std-term">exception view</span></a> that should be called whenever a
particular exception is raised from within <span>Pyramid</span> view code, use
<a class="reference internal" href="../api/config.html#pyramid.config.Configurator.add_exception_view" title="pyramid.config.Configurator.add_exception_view"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.add_exception_view()</span></code></a> to register a view
configuration which matches the exception (or a subclass of the exception) and
points at a view callable for which you'd like to generate a response. The
exception will be passed as the <code class="docutils literal notranslate"><span class="pre">context</span></code> argument to any
<a class="reference internal" href="../glossary.html#term-view-predicate"><span class="xref std std-term">view predicate</span></a> registered with the view, as well as to the view itself.
For convenience a new decorator exists,
<code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.views.exception_view_config</span></code>, which may be used to easily
register exception views.</p>
<p>For example, given the following exception class in a module named
<code class="docutils literal notranslate"><span class="pre">helloworld.exceptions</span></code>:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ValidationFailure</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span>
</pre></div>
</td></tr></table></div>
<p>You can wire a view callable to be called whenever any of your <em>other</em> code
raises a <code class="docutils literal notranslate"><span class="pre">helloworld.exceptions.ValidationFailure</span></code> exception:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.view</span> <span class="kn">import</span> <span class="n">exception_view_config</span>
<span class="kn">from</span> <span class="nn">helloworld.exceptions</span> <span class="kn">import</span> <span class="n">ValidationFailure</span>

<span class="nd">@exception_view_config</span><span class="p">(</span><span class="n">ValidationFailure</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">failed_validation</span><span class="p">(</span><span class="n">exc</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span>  <span class="n">Response</span><span class="p">(</span><span class="s1">&#39;Failed validation: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">exc</span><span class="o">.</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">status_int</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</td></tr></table></div>
<p>Assuming that a <a class="reference internal" href="../glossary.html#term-scan"><span class="xref std std-term">scan</span></a> was run to pick up this view registration, this
view callable will be invoked whenever a
<code class="docutils literal notranslate"><span class="pre">helloworld.exceptions.ValidationFailure</span></code> is raised by your application's
view code.  The same exception raised by a custom root factory, a custom
traverser, or a custom view or route predicate is also caught and hooked.</p>
<p>Other normal view predicates can also be used in combination with an exception
view registration:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.view</span> <span class="kn">import</span> <span class="n">view_config</span>
<span class="kn">from</span> <span class="nn">helloworld.exceptions</span> <span class="kn">import</span> <span class="n">ValidationFailure</span>

<span class="nd">@exception_view_config</span><span class="p">(</span><span class="n">ValidationFailure</span><span class="p">,</span> <span class="n">route_name</span><span class="o">=</span><span class="s1">&#39;home&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">failed_validation</span><span class="p">(</span><span class="n">exc</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span>  <span class="n">Response</span><span class="p">(</span><span class="s1">&#39;Failed validation: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">exc</span><span class="o">.</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">status_int</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</td></tr></table></div>
<p>The above exception view names the <code class="docutils literal notranslate"><span class="pre">route_name</span></code> of <code class="docutils literal notranslate"><span class="pre">home</span></code>, meaning that it
will only be called when the route matched has a name of <code class="docutils literal notranslate"><span class="pre">home</span></code>.  You can
therefore have more than one exception view for any given exception in the
system: the &quot;most specific&quot; one will be called when the set of request
circumstances match the view registration.</p>
<p>The only view predicate that cannot be used successfully when creating an
exception view configuration is <code class="docutils literal notranslate"><span class="pre">name</span></code>.  The name used to look up an
exception view is always the empty string.  Views registered as exception views
which have a name will be ignored.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>In most cases, you should register an <a class="reference internal" href="../glossary.html#term-exception-view"><span class="xref std std-term">exception view</span></a> by using
<a class="reference internal" href="../api/config.html#pyramid.config.Configurator.add_exception_view" title="pyramid.config.Configurator.add_exception_view"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.add_exception_view()</span></code></a>. However, it is
possible to register &quot;normal&quot; (i.e., non-exception) views against a context
resource type which inherits from <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.7)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Exception</span></code></a> (i.e.,
<code class="docutils literal notranslate"><span class="pre">config.add_view(context=Exception)</span></code>).  When the view configuration is
processed, <em>two</em> views are registered.  One as a &quot;normal&quot; view, the other
as an <a class="reference internal" href="../glossary.html#term-exception-view"><span class="xref std std-term">exception view</span></a>.  This means that you can use an exception as
<code class="docutils literal notranslate"><span class="pre">context</span></code> for a normal view.</p>
<p class="last">The view derivers that wrap these two views may behave differently.
See <a class="reference internal" href="hooks.html#exception-view-derivers"><span class="std std-ref">Exception Views and View Derivers</span></a> for more information about this.</p>
</div>
<p>Exception views can be configured with any view registration mechanism:
<code class="docutils literal notranslate"><span class="pre">&#64;exception_view_config</span></code> decorator or imperative <code class="docutils literal notranslate"><span class="pre">add_exception_view</span></code>
styles.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">Pyramid's <a class="reference internal" href="../glossary.html#term-exception-view"><span class="xref std std-term">exception view</span></a> handling logic is implemented as a tween
factory function: <a class="reference internal" href="../api/tweens.html#pyramid.tweens.excview_tween_factory" title="pyramid.tweens.excview_tween_factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.tweens.excview_tween_factory()</span></code></a>.  If Pyramid
exception view handling is desired, and tween factories are specified via
the <code class="docutils literal notranslate"><span class="pre">pyramid.tweens</span></code> configuration setting, the
<a class="reference internal" href="../api/tweens.html#pyramid.tweens.excview_tween_factory" title="pyramid.tweens.excview_tween_factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.tweens.excview_tween_factory()</span></code></a> function must be added to the
<code class="docutils literal notranslate"><span class="pre">pyramid.tweens</span></code> configuration setting list explicitly.  If it is not
present, Pyramid will not perform exception view handling.</p>
</div>
</div>
<div class="section" id="using-a-view-callable-to-do-an-http-redirect">
<span id="http-redirect"></span><span id="index-7"></span><h2>Using a View Callable to do an HTTP Redirect<a class="headerlink" href="#using-a-view-callable-to-do-an-http-redirect" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>You can issue an HTTP redirect by using the
<a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.HTTPFound" title="pyramid.httpexceptions.HTTPFound"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.httpexceptions.HTTPFound</span></code></a> class.  Raising or returning an
instance of this class will cause the client to receive a &quot;302 Found&quot; response.</p>
<p>To do so, you can <em>return</em> a <a class="reference internal" href="../api/httpexceptions.html#pyramid.httpexceptions.HTTPFound" title="pyramid.httpexceptions.HTTPFound"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.httpexceptions.HTTPFound</span></code></a> instance.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.httpexceptions</span> <span class="kn">import</span> <span class="n">HTTPFound</span>

<span class="k">def</span> <span class="nf">myview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">HTTPFound</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;http://example.com&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Alternately, you can <em>raise</em> an HTTPFound exception instead of returning one.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.httpexceptions</span> <span class="kn">import</span> <span class="n">HTTPFound</span>

<span class="k">def</span> <span class="nf">myview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">HTTPFound</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;http://example.com&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>When the instance is raised, it is caught by the default <a class="reference internal" href="../glossary.html#term-exception-response"><span class="xref std std-term">exception
response</span></a> handler and turned into a response.</p>
</div>
<div class="section" id="handling-form-submissions-in-view-callables-unicode-and-character-set-issues">
<span id="index-8"></span><h2>Handling Form Submissions in View Callables (Unicode and Character Set Issues)<a class="headerlink" href="#handling-form-submissions-in-view-callables-unicode-and-character-set-issues" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Most web applications need to accept form submissions from web browsers and
various other clients.  In <span>Pyramid</span>, form submission handling logic is
always part of a <a class="reference internal" href="../glossary.html#term-view"><span class="xref std std-term">view</span></a>.  For a general overview of how to handle form
submission data using the <a class="reference internal" href="../glossary.html#term-webob"><span class="xref std std-term">WebOb</span></a> API, see <a class="reference internal" href="webob.html#webob-chapter"><span class="std std-ref">Request and Response Objects</span></a> and
<a class="reference external" href="http://docs.webob.org/en/latest/reference.html#query-post-variables">&quot;Query and POST variables&quot; within the WebOb documentation</a>.
<span>Pyramid</span> defers to WebOb for its request and response implementations,
and handling form submission data is a property of the request implementation.
Understanding WebOb's request API is the key to understanding how to process
form submission data.</p>
<p>There are some defaults that you need to be aware of when trying to handle form
submission data in a <span>Pyramid</span> view.  Having high-order (i.e., non-ASCII)
characters in data contained within form submissions is exceedingly common, and
the UTF-8 encoding is the most common encoding used on the web for character
data. Since Unicode values are much saner than working with and storing
bytestrings, <span>Pyramid</span> configures the <a class="reference internal" href="../glossary.html#term-webob"><span class="xref std std-term">WebOb</span></a> request machinery to
attempt to decode form submission values into Unicode from UTF-8 implicitly.
This implicit decoding happens when view code obtains form field values via the
<code class="docutils literal notranslate"><span class="pre">request.params</span></code>, <code class="docutils literal notranslate"><span class="pre">request.GET</span></code>, or <code class="docutils literal notranslate"><span class="pre">request.POST</span></code> APIs (see
<a class="reference internal" href="../api/request.html#request-module"><span class="std std-ref">pyramid.request</span></a> for details about these APIs).</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">Many people find the difference between Unicode and UTF-8 confusing. Unicode
is a standard for representing text that supports most of the world's
writing systems. However, there are many ways that Unicode data can be
encoded into bytes for transit and storage. UTF-8 is a specific encoding for
Unicode that is backwards-compatible with ASCII. This makes UTF-8 very
convenient for encoding data where a large subset of that data is ASCII
characters, which is largely true on the web. UTF-8 is also the standard
character encoding for URLs.</p>
</div>
<p>As an example, let's assume that the following form page is served up to a
browser client, and its <code class="docutils literal notranslate"><span class="pre">action</span></code> points at some <span>Pyramid</span> view code:</p>
<div class="highlight-xml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=UTF-8&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">&quot;POST&quot;</span> <span class="na">action=</span><span class="s">&quot;myview&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;firstname&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;lastname&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Submit&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</td></tr></table></div>
<p>The <code class="docutils literal notranslate"><span class="pre">myview</span></code> view code in the <span>Pyramid</span> application <em>must</em> expect that
the values returned by <code class="docutils literal notranslate"><span class="pre">request.params</span></code> will be of type <code class="docutils literal notranslate"><span class="pre">unicode</span></code>, as
opposed to type <code class="docutils literal notranslate"><span class="pre">str</span></code>. The following will work to accept a form post from the
above form:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">myview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">firstname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;firstname&#39;</span><span class="p">]</span>
    <span class="n">lastname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;lastname&#39;</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
<p>But the following <code class="docutils literal notranslate"><span class="pre">myview</span></code> view code <em>may not</em> work, as it tries to decode
already-decoded (<code class="docutils literal notranslate"><span class="pre">unicode</span></code>) values obtained from <code class="docutils literal notranslate"><span class="pre">request.params</span></code>:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">myview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c1"># the .decode(&#39;utf-8&#39;) will break below if there are any high-order</span>
    <span class="c1"># characters in the firstname or lastname</span>
    <span class="n">firstname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;firstname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="n">lastname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;lastname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>For implicit decoding to work reliably, you should ensure that every form you
render that posts to a <span>Pyramid</span> view explicitly defines a charset
encoding of UTF-8. This can be done via a response that has a
<code class="docutils literal notranslate"><span class="pre">;charset=UTF-8</span></code> in its <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header; or, as in the form above,
with a <code class="docutils literal notranslate"><span class="pre">meta</span> <span class="pre">http-equiv</span></code> tag that implies that the charset is UTF-8 within
the HTML <code class="docutils literal notranslate"><span class="pre">head</span></code> of the page containing the form.  This must be done
explicitly because all known browser clients assume that they should encode
form data in the same character set implied by the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> value of
the response containing the form when subsequently submitting that form. There
is no other generally accepted way to tell browser clients which charset to use
to encode form data.  If you do not specify an encoding explicitly, the browser
client will choose to encode form data in its default character set before
submitting it, which may not be UTF-8 as the server expects.  If a request
containing form data encoded in a non-UTF-8 <code class="docutils literal notranslate"><span class="pre">charset</span></code> is handled by your view
code, eventually the request code accessed within your view will throw an error
when it can't decode some high-order character encoded in another character set
within form data, e.g., when <code class="docutils literal notranslate"><span class="pre">request.params['somename']</span></code> is accessed.</p>
<p>If you are using the <a class="reference internal" href="../api/response.html#pyramid.response.Response" title="pyramid.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a> class to generate a
response, or if you use the <code class="docutils literal notranslate"><span class="pre">render_template_*</span></code> templating APIs, the UTF-8
<code class="docutils literal notranslate"><span class="pre">charset</span></code> is set automatically as the default via the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code>
header. If you return a <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header without an explicit
<code class="docutils literal notranslate"><span class="pre">charset</span></code>, a request will add a <code class="docutils literal notranslate"><span class="pre">;charset=utf-8</span></code> trailer to the
<code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header value for you for response content types that are
textual (e.g., <code class="docutils literal notranslate"><span class="pre">text/html</span></code> or <code class="docutils literal notranslate"><span class="pre">application/xml</span></code>) as it is rendered.  If you
are using your own response object, you will need to ensure you do this
yourself.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">Only the <em>values</em> of request params obtained via <code class="docutils literal notranslate"><span class="pre">request.params</span></code>,
<code class="docutils literal notranslate"><span class="pre">request.GET</span></code> or <code class="docutils literal notranslate"><span class="pre">request.POST</span></code> are decoded to Unicode objects
implicitly in the <span>Pyramid</span> default configuration.  The keys are still
(byte) strings.</p>
</div>
</div>
<div class="section" id="alternate-view-callable-argument-calling-conventions">
<span id="request-and-context-view-definitions"></span><span id="index-9"></span><h2>Alternate View Callable Argument/Calling Conventions<a class="headerlink" href="#alternate-view-callable-argument-calling-conventions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Usually view callables are defined to accept only a single argument:
<code class="docutils literal notranslate"><span class="pre">request</span></code>.  However, a view callable may alternately be defined as any class, function, or callable that accepts <em>two</em> positional arguments: a
<a class="reference internal" href="../glossary.html#term-context"><span class="xref std std-term">context</span></a> resource as the first argument and a <a class="reference internal" href="../glossary.html#term-request"><span class="xref std std-term">request</span></a> as the
second argument.</p>
<p>The <a class="reference internal" href="../glossary.html#term-context"><span class="xref std std-term">context</span></a> and <a class="reference internal" href="../glossary.html#term-request"><span class="xref std std-term">request</span></a> arguments passed to a view function
defined in this style can be defined as follows:</p>
<dl class="docutils">
<dt>context</dt>
<dd>The <a class="reference internal" href="../glossary.html#term-resource"><span class="xref std std-term">resource</span></a> object found via tree <a class="reference internal" href="../glossary.html#term-traversal"><span class="xref std std-term">traversal</span></a> or <a class="reference internal" href="../glossary.html#term-url-dispatch"><span class="xref std std-term">URL
dispatch</span></a>.</dd>
<dt>request</dt>
<dd>A <span>Pyramid</span> Request object representing the current WSGI request.</dd>
</dl>
<p>The following types work as view callables in this style:</p>
<ol class="arabic">
<li><p class="first">Functions that accept two arguments: <code class="docutils literal notranslate"><span class="pre">context</span></code> and <code class="docutils literal notranslate"><span class="pre">request</span></code>, e.g.:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.response</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</li>
<li><p class="first">Classes that have an <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method that accepts <code class="docutils literal notranslate"><span class="pre">context,</span> <span class="pre">request</span></code>,
and a <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method which accepts no arguments, e.g.:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.response</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="k">class</span> <span class="nc">view</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">context</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">request</span> <span class="o">=</span> <span class="n">request</span>

   <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</li>
<li><p class="first">Arbitrary callables that have a <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method that accepts <code class="docutils literal notranslate"><span class="pre">context,</span>
<span class="pre">request</span></code>, e.g.:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.response</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="k">class</span> <span class="nc">View</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">View</span><span class="p">()</span> <span class="c1"># this is the view callable</span>
</pre></div>
</td></tr></table></div>
</li>
</ol>
<p>This style of calling convention is most useful for <a class="reference internal" href="../glossary.html#term-traversal"><span class="xref std std-term">traversal</span></a> based
applications, where the context object is frequently used within the view
callable code itself.</p>
<p>No matter which view calling convention is used, the view code always has
access to the context via <code class="docutils literal notranslate"><span class="pre">request.context</span></code>.</p>
</div>
<div class="section" id="passing-configuration-variables-to-a-view">
<span id="passing-in-config-variables"></span><span id="index-10"></span><h2>Passing Configuration Variables to a View<a class="headerlink" href="#passing-configuration-variables-to-a-view" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>For information on passing a variable from the configuration .ini files to a
view, see <a class="reference internal" href="startup.html#deployment-settings"><span class="std std-ref">Deployment Settings</span></a>.</p>
</div>
<div class="section" id="pylons-1-0-style-controller-dispatch">
<span id="index-11"></span><h2>Pylons-1.0-Style &quot;Controller&quot; Dispatch<a class="headerlink" href="#pylons-1-0-style-controller-dispatch" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A package named <a class="reference internal" href="../glossary.html#term-pyramid-handlers"><span class="xref std std-term">pyramid_handlers</span></a> (available from PyPI) provides an
analogue of <a class="reference internal" href="../glossary.html#term-pylons"><span class="xref std std-term">Pylons</span></a>-style &quot;controllers&quot;, which are a special kind of
view class which provides more automation when your application uses <a class="reference internal" href="../glossary.html#term-url-dispatch"><span class="xref std std-term">URL
dispatch</span></a> solely.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">Views</a><ul>
<li><a class="reference internal" href="#view-callables">View Callables</a></li>
<li><a class="reference internal" href="#defining-a-view-callable-as-a-function">Defining a View Callable as a Function</a></li>
<li><a class="reference internal" href="#defining-a-view-callable-as-a-class">Defining a View Callable as a Class</a></li>
<li><a class="reference internal" href="#view-callable-responses">View Callable Responses</a></li>
<li><a class="reference internal" href="#using-special-exceptions-in-view-callables">Using Special Exceptions in View Callables</a><ul>
<li><a class="reference internal" href="#http-exceptions">HTTP Exceptions</a></li>
<li><a class="reference internal" href="#how-pyramid-uses-http-exceptions">How Pyramid Uses HTTP Exceptions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-exception-views">Custom Exception Views</a></li>
<li><a class="reference internal" href="#using-a-view-callable-to-do-an-http-redirect">Using a View Callable to do an HTTP Redirect</a></li>
<li><a class="reference internal" href="#handling-form-submissions-in-view-callables-unicode-and-character-set-issues">Handling Form Submissions in View Callables (Unicode and Character Set Issues)</a></li>
<li><a class="reference internal" href="#alternate-view-callable-argument-calling-conventions">Alternate View Callable Argument/Calling Conventions</a></li>
<li><a class="reference internal" href="#passing-configuration-variables-to-a-view">Passing Configuration Variables to a View</a></li>
<li><a class="reference internal" href="#pylons-1-0-style-controller-dispatch">Pylons-1.0-Style &quot;Controller&quot; Dispatch</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="urldispatch.html"
                        title="前の章へ">URL Dispatch</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="renderers.html"
                        title="次の章へ">Renderers</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/narr/views.rst.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="renderers.html" title="Renderers"
             >次へ</a> |</li>
        <li class="right" >
          <a href="urldispatch.html" title="URL Dispatch"
             >前へ</a> |</li>
    	<li><a href="../index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2008-2018, Agendaless Consulting.
      最終更新: 8月 09, 2018
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4 で生成しました。
    </div>
  </body>
</html>