
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Command-Line Pyramid &#8212; The Pyramid Web Framework v1.9.2</title>
    <link rel="stylesheet" href="../_static/pylons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="next" title="Internationalization and Localization" href="i18n.html" />
    <link rel="prev" title="PasteDeploy Configuration Files" href="paste.html" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/nobile/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/neuton/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="shortcut icon" href="../_static/pyramid.ico"/>

  </head><body>







<div class="header-small">
	
	<div class="logo-small">
		<a href="../index.html">
      		<img class="logo" src="../_static/pyramid-small.png" alt="Logo"/>
		</a>
  	</div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="i18n.html" title="Internationalization and Localization"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="paste.html" title="PasteDeploy Configuration Files"
             accesskey="P">前へ</a> |</li>
    	<li><a href="../index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="command-line-pyramid">
<span id="command-line-chapter"></span><h1>Command-Line Pyramid<a class="headerlink" href="#command-line-pyramid" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>Your <span>Pyramid</span> application can be controlled and inspected using a variety
of command-line utilities.  These utilities are documented in this chapter.</p>
<div class="section" id="displaying-matching-views-for-a-given-url">
<span id="displaying-matching-views"></span><span id="index-0"></span><h2>Displaying Matching Views for a Given URL<a class="headerlink" href="#displaying-matching-views-for-a-given-url" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">See also the output of <a class="reference internal" href="../pscripts/pviews.html#pviews-script"><span class="std std-ref">pviews --help</span></a>.</p>
</div>
<p>For a big application with several views, it can be hard to keep the view
configuration details in your head, even if you defined all the views yourself.
You can use the <code class="docutils literal notranslate"><span class="pre">pviews</span></code> command in a terminal window to print a summary of
matching routes and views for a given URL in your application. The <code class="docutils literal notranslate"><span class="pre">pviews</span></code>
command accepts two arguments. The first argument to <code class="docutils literal notranslate"><span class="pre">pviews</span></code> is the path to
your application's <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file and section name inside the <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file
which points to your application.  This should be of the format
<code class="docutils literal notranslate"><span class="pre">config_file#section_name</span></code>. The second argument is the URL to test for
matching views.  The <code class="docutils literal notranslate"><span class="pre">section_name</span></code> may be omitted; if it is, it's considered
to be <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p>
<p>Here is an example for a simple view configuration using <a class="reference internal" href="../glossary.html#term-traversal"><span class="xref std std-term">traversal</span></a>:</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ $VENV/bin/pviews development.ini#tutorial /FrontPage

URL = /FrontPage

    context: &lt;tutorial.models.Page object at 0xa12536c&gt;
    view name:

    View:
    -----
    tutorial.views.view_page
    required permission = view
</pre></div>
</td></tr></table></div>
<p>The output always has the requested URL at the top and below that all the views
that matched with their view configuration details. In this example only one
view matches, so there is just a single <em>View</em> section. For each matching view,
the full code path to the associated view callable is shown, along with any
permissions and predicates that are part of that view configuration.</p>
<p>A more complex configuration might generate something like this:</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ $VENV/bin/pviews development.ini#shootout /about

URL = /about

    context: &lt;shootout.models.RootFactory object at 0xa56668c&gt;
    view name: about

    Route:
    ------
    route name: about
    route pattern: /about
    route path: /about
    subpath:
    route predicates (request method = GET)

        View:
        -----
        shootout.views.about_view
        required permission = view
        view predicates (request_param testing, header X/header)

    Route:
    ------
    route name: about_post
    route pattern: /about
    route path: /about
    subpath:
    route predicates (request method = POST)

        View:
        -----
        shootout.views.about_view_post
        required permission = view
        view predicates (request_param test)

        View:
        -----
        shootout.views.about_view_post2
        required permission = view
        view predicates (request_param test2)
</pre></div>
</td></tr></table></div>
<p>In this case, we are dealing with a <a class="reference internal" href="../glossary.html#term-url-dispatch"><span class="xref std std-term">URL dispatch</span></a> application. This
specific URL has two matching routes. The matching route information is
displayed first, followed by any views that are associated with that route. As
you can see from the second matching route output, a route can be associated
with more than one view.</p>
<p>For a URL that doesn't match any views, <code class="docutils literal notranslate"><span class="pre">pviews</span></code> will simply print out a <em>Not
found</em> message.</p>
</div>
<div class="section" id="the-interactive-shell">
<span id="interactive-shell"></span><span id="index-1"></span><h2>The Interactive Shell<a class="headerlink" href="#the-interactive-shell" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">See also the output of <a class="reference internal" href="../pscripts/pshell.html#pshell-script"><span class="std std-ref">pshell --help</span></a>.</p>
</div>
<p>Once you've installed your program for development using <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></code>,
you can use an interactive Python shell to execute expressions in a Python
environment exactly like the one that will be used when your application runs
&quot;for real&quot;.  To do so, use the <code class="docutils literal notranslate"><span class="pre">pshell</span></code> command line utility.</p>
<p>The argument to <code class="docutils literal notranslate"><span class="pre">pshell</span></code> follows the format <code class="docutils literal notranslate"><span class="pre">config_file#section_name</span></code>
where <code class="docutils literal notranslate"><span class="pre">config_file</span></code> is the path to your application's <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file and
<code class="docutils literal notranslate"><span class="pre">section_name</span></code> is the <code class="docutils literal notranslate"><span class="pre">app</span></code> section name inside the <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file which
points to your application.  For example, your application <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file might
have an <code class="docutils literal notranslate"><span class="pre">[app:main]</span></code> section that looks like so:</p>
<div class="highlight-ini notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">[app:main]</span>
<span class="na">use</span> <span class="o">=</span> <span class="s">egg:MyProject</span>
<span class="na">pyramid.reload_templates</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">pyramid.debug_authorization</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">pyramid.debug_notfound</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">pyramid.debug_templates</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">pyramid.default_locale_name</span> <span class="o">=</span> <span class="s">en</span>
</pre></div>
</td></tr></table></div>
<p>If so, you can use the following command to invoke a debug shell using the name
<code class="docutils literal notranslate"><span class="pre">main</span></code> as a section name:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ $VENV/bin/pshell starter/development.ini#main
Python 2.6.5 (r265:79063, Apr 29 2010, 00:31:32)
[GCC 4.4.3] on linux2
Type &quot;help&quot; for more information.

Environment:
  app          The WSGI application.
  registry     Active Pyramid registry.
  request      Active request object.
  root         Root of the default resource tree.
  root_factory Default root factory used to create `root`.

&gt;&gt;&gt; root
&lt;myproject.resources.MyResource object at 0x445270&gt;
&gt;&gt;&gt; registry
&lt;Registry myproject&gt;
&gt;&gt;&gt; registry.settings[&#39;pyramid.debug_notfound&#39;]
False
&gt;&gt;&gt; from myproject.views import my_view
&gt;&gt;&gt; from pyramid.request import Request
&gt;&gt;&gt; r = Request.blank(&#39;/&#39;)
&gt;&gt;&gt; my_view(r)
{&#39;project&#39;: &#39;myproject&#39;}
</pre></div>
</div>
<p>The WSGI application that is loaded will be available in the shell as the
<code class="docutils literal notranslate"><span class="pre">app</span></code> global. Also, if the application that is loaded is the <span>Pyramid</span>
app with no surrounding <a class="reference internal" href="../glossary.html#term-middleware"><span class="xref std std-term">middleware</span></a>, the <code class="docutils literal notranslate"><span class="pre">root</span></code> object returned by the
default <a class="reference internal" href="../glossary.html#term-root-factory"><span class="xref std std-term">root factory</span></a>, <code class="docutils literal notranslate"><span class="pre">registry</span></code>, and <code class="docutils literal notranslate"><span class="pre">request</span></code> will be available.</p>
<p>You can also simply rely on the <code class="docutils literal notranslate"><span class="pre">main</span></code> default section name by omitting any
hash after the filename:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ $VENV/bin/pshell starter/development.ini
</pre></div>
</div>
<p>Press <code class="docutils literal notranslate"><span class="pre">Ctrl-D</span></code> to exit the interactive shell (or <code class="docutils literal notranslate"><span class="pre">Ctrl-Z</span></code> on Windows).</p>
<div class="section" id="extending-the-shell">
<span id="extending-pshell"></span><span id="index-2"></span><h3>Extending the Shell<a class="headerlink" href="#extending-the-shell" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>It is convenient when using the interactive shell often to have some variables
significant to your application already loaded as globals when you start the
<code class="docutils literal notranslate"><span class="pre">pshell</span></code>. To facilitate this, <code class="docutils literal notranslate"><span class="pre">pshell</span></code> will look for a special <code class="docutils literal notranslate"><span class="pre">[pshell]</span></code>
section in your INI file and expose the subsequent key/value pairs to the
shell.  Each key is a variable name that will be global within the pshell
session; each value is a <a class="reference internal" href="../glossary.html#term-dotted-python-name"><span class="xref std std-term">dotted Python name</span></a>. If specified, the special
key <code class="docutils literal notranslate"><span class="pre">setup</span></code> should be a <a class="reference internal" href="../glossary.html#term-dotted-python-name"><span class="xref std std-term">dotted Python name</span></a> pointing to a callable
that accepts the dictionary of globals that will be loaded into the shell. This
allows for some custom initializing code to be executed each time the
<code class="docutils literal notranslate"><span class="pre">pshell</span></code> is run. The <code class="docutils literal notranslate"><span class="pre">setup</span></code> callable can also be specified from the
commandline using the <code class="docutils literal notranslate"><span class="pre">--setup</span></code> option which will override the key in the INI
file.</p>
<p>For example, you want to expose your model to the shell along with the database
session so that you can mutate the model on an actual database. Here, we'll
assume your model is stored in the <code class="docutils literal notranslate"><span class="pre">myapp.models</span></code> package.</p>
<div class="highlight-ini notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">[pshell]</span>
<span class="na">setup</span> <span class="o">=</span> <span class="s">myapp.lib.pshell.setup</span>
<span class="na">m</span> <span class="o">=</span> <span class="s">myapp.models</span>
<span class="na">session</span> <span class="o">=</span> <span class="s">myapp.models.DBSession</span>
<span class="na">t</span> <span class="o">=</span> <span class="s">transaction</span>
</pre></div>
</td></tr></table></div>
<p>By defining the <code class="docutils literal notranslate"><span class="pre">setup</span></code> callable, we will create the module
<code class="docutils literal notranslate"><span class="pre">myapp.lib.pshell</span></code> containing a callable named <code class="docutils literal notranslate"><span class="pre">setup</span></code> that will receive
the global environment before it is exposed to the shell. Here we mutate the
environment's request as well as add a new value containing a WebTest version
of the application to which we can easily submit requests.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># myapp/lib/pshell.py</span>
<span class="kn">from</span> <span class="nn">webtest</span> <span class="kn">import</span> <span class="n">TestApp</span>

<span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="n">env</span><span class="p">):</span>
    <span class="n">env</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;www.example.com&#39;</span>
    <span class="n">env</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">scheme</span> <span class="o">=</span> <span class="s1">&#39;https&#39;</span>
    <span class="n">env</span><span class="p">[</span><span class="s1">&#39;testapp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TestApp</span><span class="p">(</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;app&#39;</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<p>When this INI file is loaded, the extra variables <code class="docutils literal notranslate"><span class="pre">m</span></code>, <code class="docutils literal notranslate"><span class="pre">session</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>
will be available for use immediately. Since a <code class="docutils literal notranslate"><span class="pre">setup</span></code> callable was also
specified, it is executed and a new variable <code class="docutils literal notranslate"><span class="pre">testapp</span></code> is exposed, and the
request is configured to generate urls from the host
<code class="docutils literal notranslate"><span class="pre">http://www.example.com</span></code>. For example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ $VENV/bin/pshell starter/development.ini
Python 2.6.5 (r265:79063, Apr 29 2010, 00:31:32)
[GCC 4.4.3] on linux2
Type &quot;help&quot; for more information.

Environment:
  app          The WSGI application.
  registry     Active Pyramid registry.
  request      Active request object.
  root         Root of the default resource tree.
  root_factory Default root factory used to create `root`.
  testapp      &lt;webtest.TestApp object at ...&gt;

Custom Variables:
  m            myapp.models
  session      myapp.models.DBSession
  t            transaction

&gt;&gt;&gt; testapp.get(&#39;/&#39;)
&lt;200 OK text/html body=&#39;&lt;!DOCTYPE...l&gt;\n&#39;/3337&gt;
&gt;&gt;&gt; request.route_url(&#39;home&#39;)
&#39;https://www.example.com/&#39;
</pre></div>
</div>
</div>
<div class="section" id="alternative-shells">
<span id="ipython-or-bpython"></span><h3>Alternative Shells<a class="headerlink" href="#alternative-shells" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">pshell</span></code> command can be easily extended with alternate REPLs if the
default python REPL is not satisfactory. Assuming you have a binding
installed such as <code class="docutils literal notranslate"><span class="pre">pyramid_ipython</span></code> it will normally be auto-selected and
used. You may also specifically invoke your choice with the <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">choice</span></code> or
<code class="docutils literal notranslate"><span class="pre">--python-shell</span> <span class="pre">choice</span></code> option.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ $VENV/bin/pshell -p ipython development.ini#MyProject
</pre></div>
</div>
<p>You may use the <code class="docutils literal notranslate"><span class="pre">--list-shells</span></code> option to see the available shells.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ $VENV/bin/pshell --list-shells
Available shells:
  bpython
  ipython
  python
</pre></div>
</div>
<p>If you want to use a shell that isn't supported out of the box, you can
introduce a new shell by registering an entry point in your <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">setup</span><span class="p">(</span>
    <span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;pyramid.pshell_runner&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s1">&#39;myshell=my_app:ptpython_shell_factory&#39;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<p>And then your shell factory should return a function that accepts two
arguments, <code class="docutils literal notranslate"><span class="pre">env</span></code> and <code class="docutils literal notranslate"><span class="pre">help</span></code>, which would look like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ptpython.repl</span> <span class="kn">import</span> <span class="n">embed</span>

<span class="k">def</span> <span class="nf">ptpython_shell_runner</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">help</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">help</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">embed</span><span class="p">(</span><span class="nb">locals</span><span class="o">=</span><span class="n">env</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 1.6 で変更: </span>User-defined shells may be registered using entry points. Prior to this
the only supported shells were <code class="docutils literal notranslate"><span class="pre">ipython</span></code>, <code class="docutils literal notranslate"><span class="pre">bpython</span></code> and <code class="docutils literal notranslate"><span class="pre">python</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">ipython</span></code> and <code class="docutils literal notranslate"><span class="pre">bpython</span></code> have been moved into their respective
packages <code class="docutils literal notranslate"><span class="pre">pyramid_ipython</span></code> and <code class="docutils literal notranslate"><span class="pre">pyramid_bpython</span></code>.</p>
</div>
</div>
<div class="section" id="setting-a-default-shell">
<h3>Setting a Default Shell<a class="headerlink" href="#setting-a-default-shell" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>You may use the <code class="docutils literal notranslate"><span class="pre">default_shell</span></code> option in your <code class="docutils literal notranslate"><span class="pre">[pshell]</span></code> ini section to
specify a list of preferred shells.</p>
<div class="highlight-ini notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">[pshell]</span>
<span class="na">default_shell</span> <span class="o">=</span> <span class="s">ptpython ipython bpython</span>
</pre></div>
</td></tr></table></div>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.6 で追加.</span></p>
</div>
</div>
</div>
<div class="section" id="displaying-all-application-routes">
<span id="displaying-application-routes"></span><span id="index-3"></span><h2>Displaying All Application Routes<a class="headerlink" href="#displaying-all-application-routes" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">See also the output of <a class="reference internal" href="../pscripts/proutes.html#proutes-script"><span class="std std-ref">proutes --help</span></a>.</p>
</div>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">proutes</span></code> command in a terminal window to print a summary of
routes related to your application.  Much like the <code class="docutils literal notranslate"><span class="pre">pshell</span></code> command (see
<a class="reference internal" href="#interactive-shell"><span class="std std-ref">The Interactive Shell</span></a>), the <code class="docutils literal notranslate"><span class="pre">proutes</span></code> command accepts one argument with
the format <code class="docutils literal notranslate"><span class="pre">config_file#section_name</span></code>.  The <code class="docutils literal notranslate"><span class="pre">config_file</span></code> is the path to
your application's <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file, and <code class="docutils literal notranslate"><span class="pre">section_name</span></code> is the <code class="docutils literal notranslate"><span class="pre">app</span></code> section
name inside the <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file which points to your application.  By default,
the <code class="docutils literal notranslate"><span class="pre">section_name</span></code> is <code class="docutils literal notranslate"><span class="pre">main</span></code> and can be omitted.</p>
<p>For example:</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ $VENV/bin/proutes development.ini
Name                       Pattern                     View                                          Method
----                       -------                     ----                                          ------
debugtoolbar               /_debug_toolbar/*subpath    &lt;wsgiapp&gt;                                     *
__static/                  /static/*subpath            dummy_starter:static/                         *
__static2/                 /static2/*subpath           /var/www/static/                              *
__pdt_images/              /pdt_images/*subpath        pyramid_debugtoolbar:static/img/              *
a                          /                           &lt;unknown&gt;                                     *
no_view_attached           /                           &lt;unknown&gt;                                     *
route_and_view_attached    /                           app1.standard_views.route_and_view_attached   *
method_conflicts           /conflicts                  app1.standard_conflicts                       &lt;route mismatch&gt;
multiview                  /multiview                  app1.standard_views.multiview                 GET,PATCH
not_post                   /not_post                   app1.standard_views.multview                  !POST,*
</pre></div>
</td></tr></table></div>
<p><code class="docutils literal notranslate"><span class="pre">proutes</span></code> generates a table with four columns: <em>Name</em>, <em>Pattern</em>, <em>View</em>, and
<em>Method</em>.  The items listed in the Name column are route names, the items
listed in the Pattern column are route patterns, the items listed in the View
column are representations of the view callable that will be invoked when a
request matches the associated route pattern, and the items listed in the
Method column are the request methods that are associated with the route name.
The View column may show <code class="docutils literal notranslate"><span class="pre">&lt;unknown&gt;</span></code> if no associated view callable could be
found.  The Method column, for the route name, may show either <code class="docutils literal notranslate"><span class="pre">&lt;route</span>
<span class="pre">mismatch&gt;</span></code> if the view callable does not accept any of the route's request
methods, or <code class="docutils literal notranslate"><span class="pre">*</span></code> if the view callable will accept any of the route's request
methods.  If no routes are configured within your application, nothing will be
printed to the console when <code class="docutils literal notranslate"><span class="pre">proutes</span></code> is executed.</p>
<p>It is convenient when using the <code class="docutils literal notranslate"><span class="pre">proutes</span></code> command often to configure which
columns and the order you would like to view them. To facilitate this,
<code class="docutils literal notranslate"><span class="pre">proutes</span></code> will look for a special <code class="docutils literal notranslate"><span class="pre">[proutes]</span></code> section in your <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file
and use those as defaults.</p>
<p>For example you may remove the request method and place the view first:</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  [proutes]
  format = view
           name
           pattern
</pre></div>
</td></tr></table></div>
<p>You can also separate the formats with commas or spaces:</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  [proutes]
  format = view name pattern

  [proutes]
  format = view, name, pattern
</pre></div>
</td></tr></table></div>
<p>If you want to temporarily configure the columns and order, there is the
argument <code class="docutils literal notranslate"><span class="pre">--format</span></code>, which is a comma separated list of columns you want to
include. The current available formats are <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">pattern</span></code>, <code class="docutils literal notranslate"><span class="pre">view</span></code>, and
<code class="docutils literal notranslate"><span class="pre">method</span></code>.</p>
</div>
<div class="section" id="displaying-tweens">
<span id="index-4"></span><span id="id1"></span><h2>Displaying &quot;Tweens&quot;<a class="headerlink" href="#displaying-tweens" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">See also the output of <a class="reference internal" href="../pscripts/ptweens.html#ptweens-script"><span class="std std-ref">ptweens --help</span></a>.</p>
</div>
<p>A <a class="reference internal" href="../glossary.html#term-tween"><span class="xref std std-term">tween</span></a> is a bit of code that sits between the main Pyramid application
request handler and the WSGI application which calls it.  A user can get a
representation of both the implicit tween ordering (the ordering specified by
calls to <a class="reference internal" href="../api/config.html#pyramid.config.Configurator.add_tween" title="pyramid.config.Configurator.add_tween"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.add_tween()</span></code></a>) and the explicit tween
ordering (specified by the <code class="docutils literal notranslate"><span class="pre">pyramid.tweens</span></code> configuration setting) using the
<code class="docutils literal notranslate"><span class="pre">ptweens</span></code> command.  Tween factories will show up represented by their
standard Python dotted name in the <code class="docutils literal notranslate"><span class="pre">ptweens</span></code> output.</p>
<p>For example, here's the <code class="docutils literal notranslate"><span class="pre">ptweens</span></code> command run against a system configured
without any explicit tweens:</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ $VENV/bin/ptweens development.ini
&quot;pyramid.tweens&quot; config value NOT set (implicitly ordered tweens used)

Implicit Tween Chain

Position    Name                                                Alias
--------    ----                                                -----
-           -                                                   INGRESS
0           pyramid_debugtoolbar.toolbar.toolbar_tween_factory  pdbt
1           pyramid.tweens.excview_tween_factory                excview
-           -                                                   MAIN
</pre></div>
</td></tr></table></div>
<p>Here's the <code class="docutils literal notranslate"><span class="pre">ptweens</span></code> command run against a system configured <em>with</em> explicit
tweens defined in its <code class="docutils literal notranslate"><span class="pre">development.ini</span></code> file:</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ ptweens development.ini
&quot;pyramid.tweens&quot; config value set (explicitly ordered tweens used)

Explicit Tween Chain (used)

Position    Name
--------    ----
-           INGRESS
0           starter.tween_factory2
1           starter.tween_factory1
2           pyramid.tweens.excview_tween_factory
-           MAIN

Implicit Tween Chain (not used)

Position    Name
--------    ----
-           INGRESS
0           pyramid_debugtoolbar.toolbar.toolbar_tween_factory
1           pyramid.tweens.excview_tween_factory
-           MAIN
</pre></div>
</td></tr></table></div>
<p>Here's the application configuration section of the <code class="docutils literal notranslate"><span class="pre">development.ini</span></code> used by
the above <code class="docutils literal notranslate"><span class="pre">ptweens</span></code> command which reports that the explicit tween chain is
used:</p>
<div class="highlight-ini notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">[app:main]</span>
<span class="na">use</span> <span class="o">=</span> <span class="s">egg:starter</span>
<span class="na">reload_templates</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">debug_authorization</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">debug_notfound</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">debug_routematch</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">debug_templates</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">default_locale_name</span> <span class="o">=</span> <span class="s">en</span>
<span class="na">pyramid.include</span> <span class="o">=</span> <span class="s">pyramid_debugtoolbar</span>
<span class="na">pyramid.tweens</span> <span class="o">=</span> <span class="s">starter.tween_factory2</span>
<span class="s">                 starter.tween_factory1</span>
<span class="s">                 pyramid.tweens.excview_tween_factory</span>
</pre></div>
</td></tr></table></div>
<p>See <a class="reference internal" href="hooks.html#registering-tweens"><span class="std std-ref">Registering Tweens</span></a> for more information about tweens.</p>
</div>
<div class="section" id="invoking-a-request">
<span id="index-5"></span><span id="id2"></span><h2>Invoking a Request<a class="headerlink" href="#invoking-a-request" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">See also the output of <a class="reference internal" href="../pscripts/prequest.html#prequest-script"><span class="std std-ref">prequest --help</span></a>.</p>
</div>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">prequest</span></code> command-line utility to send a request to your
application and see the response body without starting a server.</p>
<p>There are two required arguments to <code class="docutils literal notranslate"><span class="pre">prequest</span></code>:</p>
<ul class="simple">
<li>The config file/section: follows the format <code class="docutils literal notranslate"><span class="pre">config_file#section_name</span></code>,
where <code class="docutils literal notranslate"><span class="pre">config_file</span></code> is the path to your application's <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file and
<code class="docutils literal notranslate"><span class="pre">section_name</span></code> is the <code class="docutils literal notranslate"><span class="pre">app</span></code> section name inside the <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file.  The
<code class="docutils literal notranslate"><span class="pre">section_name</span></code> is optional; it defaults to <code class="docutils literal notranslate"><span class="pre">main</span></code>.  For example:
<code class="docutils literal notranslate"><span class="pre">development.ini</span></code>.</li>
<li>The path: this should be the non-URL-quoted path element of the URL to the
resource you'd like to be rendered on the server.  For example, <code class="docutils literal notranslate"><span class="pre">/</span></code>.</li>
</ul>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ $VENV/bin/prequest development.ini /
</pre></div>
</div>
<p>This will print the body of the response to the console on which it was
invoked.</p>
<p>Several options are supported by <code class="docutils literal notranslate"><span class="pre">prequest</span></code>.  These should precede any config
file name or URL.</p>
<p><code class="docutils literal notranslate"><span class="pre">prequest</span></code> has a <code class="docutils literal notranslate"><span class="pre">-d</span></code> (i.e., <code class="docutils literal notranslate"><span class="pre">--display-headers</span></code>) option which prints the
status and headers returned by the server before the output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ $VENV/bin/prequest -d development.ini /
</pre></div>
</div>
<p>This will print the status, headers, and the body of the response to the
console.</p>
<p>You can add request header values by using the <code class="docutils literal notranslate"><span class="pre">--header</span></code> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ $VENV/bin/prequest --header=Host:example.com development.ini /
</pre></div>
</div>
<p>Headers are added to the WSGI environment by converting them to their CGI/WSGI
equivalents (e.g., <code class="docutils literal notranslate"><span class="pre">Host=example.com</span></code> will insert the <code class="docutils literal notranslate"><span class="pre">HTTP_HOST</span></code> header
variable as the value <code class="docutils literal notranslate"><span class="pre">example.com</span></code>).  Multiple <code class="docutils literal notranslate"><span class="pre">--header</span></code> options can be
supplied.  The special header value <code class="docutils literal notranslate"><span class="pre">content-type</span></code> sets the <code class="docutils literal notranslate"><span class="pre">CONTENT_TYPE</span></code>
in the WSGI environment.</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">prequest</span></code> sends a <code class="docutils literal notranslate"><span class="pre">GET</span></code> request.  You can change this by using
the <code class="docutils literal notranslate"><span class="pre">-m</span></code> (aka <code class="docutils literal notranslate"><span class="pre">--method</span></code>) option.  <code class="docutils literal notranslate"><span class="pre">GET</span></code>, <code class="docutils literal notranslate"><span class="pre">HEAD</span></code>, <code class="docutils literal notranslate"><span class="pre">POST</span></code>, and
<code class="docutils literal notranslate"><span class="pre">DELETE</span></code> are currently supported.  When you use <code class="docutils literal notranslate"><span class="pre">POST</span></code>, the standard input
of the <code class="docutils literal notranslate"><span class="pre">prequest</span></code> process is used as the <code class="docutils literal notranslate"><span class="pre">POST</span></code> body:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ $VENV/bin/prequest -mPOST development.ini / &lt; somefile
</pre></div>
</div>
</div>
<div class="section" id="using-custom-arguments-to-python-when-running-p-scripts">
<h2>Using Custom Arguments to Python when Running <code class="docutils literal notranslate"><span class="pre">p*</span></code> Scripts<a class="headerlink" href="#using-custom-arguments-to-python-when-running-p-scripts" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.5 で追加.</span></p>
</div>
<p>Each of Pyramid's console scripts (<code class="docutils literal notranslate"><span class="pre">pserve</span></code>, <code class="docutils literal notranslate"><span class="pre">pviews</span></code>, etc.) can be run
directly using <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">-m</span></code>, allowing custom arguments to be sent to the
Python interpreter at runtime. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pyramid</span><span class="o">.</span><span class="n">scripts</span><span class="o">.</span><span class="n">pserve</span> <span class="n">development</span><span class="o">.</span><span class="n">ini</span>
</pre></div>
</div>
</div>
<div class="section" id="showing-all-installed-distributions-and-their-versions">
<span id="showing-distributions"></span><span id="index-6"></span><h2>Showing All Installed Distributions and Their Versions<a class="headerlink" href="#showing-all-installed-distributions-and-their-versions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.5 で追加.</span></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">See also the output of <a class="reference internal" href="../pscripts/pdistreport.html#pdistreport-script"><span class="std std-ref">pdistreport --help</span></a>.</p>
</div>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">pdistreport</span></code> command to show the <span>Pyramid</span> version in
use, the Python version in use, and all installed versions of Python
distributions in your Python environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ $VENV/bin/pdistreport
Pyramid version: 1.5dev
Platform Linux-3.2.0-51-generic-x86_64-with-debian-wheezy-sid
Packages:
  authapp 0.0
    /home/chrism/projects/foo/src/authapp
  beautifulsoup4 4.1.3
    /home/chrism/projects/foo/lib/python2.7/site-packages/beautifulsoup4-4.1.3-py2.7.egg
... more output ...
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pdistreport</span></code> takes no options.  Its output is useful to paste into a
pastebin when you are having problems and need someone with more familiarity
with Python packaging and distribution than you have to look at your
environment.</p>
</div>
<div class="section" id="writing-a-script">
<span id="id3"></span><h2>Writing a Script<a class="headerlink" href="#writing-a-script" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>All web applications are, at their hearts, systems which accept a request and
return a response.  When a request is accepted by a <span>Pyramid</span> application,
the system receives state from the request which is later relied on by your
application code.  For example, one <a class="reference internal" href="../glossary.html#term-view-callable"><span class="xref std std-term">view callable</span></a> may assume it's
working against a request that has a <code class="docutils literal notranslate"><span class="pre">request.matchdict</span></code> of a particular
composition, while another assumes a different composition of the matchdict.</p>
<p>In the meantime, it's convenient to be able to write a Python script that can
work &quot;in a Pyramid environment&quot;, for instance to update database tables used by
your <span>Pyramid</span> application.  But a &quot;real&quot; Pyramid environment doesn't have
a completely static state independent of a request; your application (and
Pyramid itself) is almost always reliant on being able to obtain information
from a request.  When you run a Python script that simply imports code from
your application and tries to run it, there just is no request data, because
there isn't any real web request.  Therefore some parts of your application and
some Pyramid APIs will not work.</p>
<p>For this reason, <span>Pyramid</span> makes it possible to run a script in an
environment much like the environment produced when a particular
<a class="reference internal" href="../glossary.html#term-request"><span class="xref std std-term">request</span></a> reaches your <span>Pyramid</span> application.  This is achieved by
using the <a class="reference internal" href="../api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.paster.bootstrap()</span></code></a> command in the body of your script.</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 1.1 で追加: </span><a class="reference internal" href="../api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.paster.bootstrap()</span></code></a></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 1.8 で変更: </span>Added the ability for <code class="docutils literal notranslate"><span class="pre">bootstrap</span></code> to cleanup automatically via the
<code class="docutils literal notranslate"><span class="pre">with</span></code> statement.</p>
</div>
<p>In the simplest case, <a class="reference internal" href="../api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.paster.bootstrap()</span></code></a> can be used with a
single argument, which accepts the <a class="reference internal" href="../glossary.html#term-pastedeploy"><span class="xref std std-term">PasteDeploy</span></a> <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file
representing your Pyramid application's configuration as a single argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.paster</span> <span class="kn">import</span> <span class="n">bootstrap</span>

<span class="k">with</span> <span class="n">bootstrap</span><span class="p">(</span><span class="s1">&#39;/path/to/my/development.ini&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">env</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">route_url</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p><a class="reference internal" href="../api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.paster.bootstrap()</span></code></a> returns a dictionary containing
framework-related information.  This dictionary will always contain a
<a class="reference internal" href="../glossary.html#term-request"><span class="xref std std-term">request</span></a> object as its <code class="docutils literal notranslate"><span class="pre">request</span></code> key.</p>
<p>The following keys are available in the <code class="docutils literal notranslate"><span class="pre">env</span></code> dictionary returned by
<a class="reference internal" href="../api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.paster.bootstrap()</span></code></a>:</p>
<p>request</p>
<blockquote>
<div>A <a class="reference internal" href="../api/request.html#pyramid.request.Request" title="pyramid.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.request.Request</span></code></a> object implying the current request
state for your script.</div></blockquote>
<p>app</p>
<blockquote>
<div>The <a class="reference internal" href="../glossary.html#term-wsgi"><span class="xref std std-term">WSGI</span></a> application object generated by bootstrapping.</div></blockquote>
<p>root</p>
<blockquote>
<div>The <a class="reference internal" href="../glossary.html#term-resource"><span class="xref std std-term">resource</span></a> root of your <span>Pyramid</span> application.  This is an
object generated by the <a class="reference internal" href="../glossary.html#term-root-factory"><span class="xref std std-term">root factory</span></a> configured in your
application.</div></blockquote>
<p>registry</p>
<blockquote>
<div>The <a class="reference internal" href="../glossary.html#term-application-registry"><span class="xref std std-term">application registry</span></a> of your <span>Pyramid</span> application.</div></blockquote>
<p>closer</p>
<blockquote>
<div>A parameterless callable that can be used to pop an internal <span>Pyramid</span>
threadlocal stack (used by <a class="reference internal" href="../api/threadlocal.html#pyramid.threadlocal.get_current_registry" title="pyramid.threadlocal.get_current_registry"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.threadlocal.get_current_registry()</span></code></a>
and <a class="reference internal" href="../api/threadlocal.html#pyramid.threadlocal.get_current_request" title="pyramid.threadlocal.get_current_request"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.threadlocal.get_current_request()</span></code></a>) when your scripting
job is finished.</div></blockquote>
<p>Let's assume that the <code class="docutils literal notranslate"><span class="pre">/path/to/my/development.ini</span></code> file used in the example
above looks like so:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[pipeline:main]</span>
<span class="na">pipeline</span> <span class="o">=</span> <span class="s">translogger</span>
<span class="s">           another</span>

<span class="k">[filter:translogger]</span>
<span class="na">filter_app_factory</span> <span class="o">=</span> <span class="s">egg:Paste#translogger</span>
<span class="na">setup_console_handler</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">logger_name</span> <span class="o">=</span> <span class="s">wsgi</span>

<span class="k">[app:another]</span>
<span class="na">use</span> <span class="o">=</span> <span class="s">egg:MyProject</span>
</pre></div>
</div>
<p>The configuration loaded by the above bootstrap example will use the
configuration implied by the <code class="docutils literal notranslate"><span class="pre">[pipeline:main]</span></code> section of your configuration
file by default.  Specifying <code class="docutils literal notranslate"><span class="pre">/path/to/my/development.ini</span></code> is logically
equivalent to specifying <code class="docutils literal notranslate"><span class="pre">/path/to/my/development.ini#main</span></code>.  In this case,
we'll be using a configuration that includes an <code class="docutils literal notranslate"><span class="pre">app</span></code> object which is wrapped
in the Paste &quot;translogger&quot; <a class="reference internal" href="../glossary.html#term-middleware"><span class="xref std std-term">middleware</span></a> (which logs requests to the
console).</p>
<p>You can also specify a particular <em>section</em> of the PasteDeploy <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file to
load instead of <code class="docutils literal notranslate"><span class="pre">main</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.paster</span> <span class="kn">import</span> <span class="n">bootstrap</span>

<span class="k">with</span> <span class="n">bootstrap</span><span class="p">(</span><span class="s1">&#39;/path/to/my/development.ini#another&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">env</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">route_url</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>The above example specifies the <code class="docutils literal notranslate"><span class="pre">another</span></code> <code class="docutils literal notranslate"><span class="pre">app</span></code>, <code class="docutils literal notranslate"><span class="pre">pipeline</span></code>, or
<code class="docutils literal notranslate"><span class="pre">composite</span></code> section of your PasteDeploy configuration file. The <code class="docutils literal notranslate"><span class="pre">app</span></code>
object present in the <code class="docutils literal notranslate"><span class="pre">env</span></code> dictionary returned by
<a class="reference internal" href="../api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.paster.bootstrap()</span></code></a> will be a <span>Pyramid</span> <a class="reference internal" href="../glossary.html#term-router"><span class="xref std std-term">router</span></a>.</p>
<div class="section" id="changing-the-request">
<h3>Changing the Request<a class="headerlink" href="#changing-the-request" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>By default, Pyramid will generate a request object in the <code class="docutils literal notranslate"><span class="pre">env</span></code> dictionary
for the URL <code class="docutils literal notranslate"><span class="pre">http://localhost:80/</span></code>. This means that any URLs generated by
Pyramid during the execution of your script will be anchored here. This is
generally not what you want.</p>
<p>So how do we make Pyramid generate the correct URLs?</p>
<p>Assuming that you have a route configured in your application like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;verify&#39;</span><span class="p">,</span> <span class="s1">&#39;/verify/{code}&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You need to inform the Pyramid environment that the WSGI application is
handling requests from a certain base. For example, we want to simulate
mounting our application at <cite>https://example.com/prefix</cite>, to ensure that the
generated URLs are correct for our deployment. This can be done by either
mutating the resulting request object, or more simply by constructing the
desired request and passing it into <a class="reference internal" href="../api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">bootstrap()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.paster</span> <span class="kn">import</span> <span class="n">bootstrap</span>
<span class="kn">from</span> <span class="nn">pyramid.request</span> <span class="kn">import</span> <span class="n">Request</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">base_url</span><span class="o">=</span><span class="s1">&#39;https://example.com/prefix&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">bootstrap</span><span class="p">(</span><span class="s1">&#39;/path/to/my/development.ini#another&#39;</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span> <span class="k">as</span> <span class="n">env</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">application_url</span><span class="p">)</span>
    <span class="c1"># will print &#39;https://example.com/prefix&#39;</span>
</pre></div>
</div>
<p>Now you can readily use Pyramid's APIs for generating URLs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">route_url</span><span class="p">(</span><span class="s1">&#39;verify&#39;</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="s1">&#39;1337&#39;</span><span class="p">)</span>
<span class="c1"># will return &#39;https://example.com/prefix/verify/1337&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="cleanup">
<h3>Cleanup<a class="headerlink" href="#cleanup" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>If you're using the <code class="docutils literal notranslate"><span class="pre">with</span></code>-statement variant then there's nothing to
worry about. However if you're using the returned environment directly then
when your scripting logic finishes, it's good manners to call the <code class="docutils literal notranslate"><span class="pre">closer</span></code>
callback:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.paster</span> <span class="kn">import</span> <span class="n">bootstrap</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">(</span><span class="s1">&#39;/path/to/my/development.ini&#39;</span><span class="p">)</span>

<span class="c1"># .. do stuff ...</span>

<span class="n">env</span><span class="p">[</span><span class="s1">&#39;closer&#39;</span><span class="p">]()</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-up-logging">
<h3>Setting Up Logging<a class="headerlink" href="#setting-up-logging" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>By default, <a class="reference internal" href="../api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.paster.bootstrap()</span></code></a> does not configure logging
parameters present in the configuration file.  If you'd like to configure
logging based on <code class="docutils literal notranslate"><span class="pre">[logger]</span></code> and related sections in the configuration file,
use the following command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyramid.paster</span>
<span class="n">pyramid</span><span class="o">.</span><span class="n">paster</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">(</span><span class="s1">&#39;/path/to/my/development.ini&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="logging.html#logging-chapter"><span class="std std-ref">Logging</span></a> for more information on logging within
<span>Pyramid</span>.</p>
</div>
</div>
<div class="section" id="making-your-script-into-a-console-script">
<span id="making-a-console-script"></span><span id="index-7"></span><h2>Making Your Script into a Console Script<a class="headerlink" href="#making-your-script-into-a-console-script" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A &quot;console script&quot; is <a class="reference internal" href="../glossary.html#term-setuptools"><span class="xref std std-term">setuptools</span></a> terminology for a script that gets
installed into the <code class="docutils literal notranslate"><span class="pre">bin</span></code> directory of a Python <a class="reference internal" href="../glossary.html#term-virtual-environment"><span class="xref std std-term">virtual environment</span></a>
(or &quot;base&quot; Python environment) when a <a class="reference internal" href="../glossary.html#term-distribution"><span class="xref std std-term">distribution</span></a> which houses that
script is installed. Because it's installed into the <code class="docutils literal notranslate"><span class="pre">bin</span></code> directory of a
virtual environment when the distribution is installed, it's a convenient way
to package and distribute functionality that you can call from the
command-line. It's often more convenient to create a console script than it is
to create a <code class="docutils literal notranslate"><span class="pre">.py</span></code> script and instruct people to call it with the &quot;right&quot;
Python interpreter. A console script generates a file that lives in <code class="docutils literal notranslate"><span class="pre">bin</span></code>,
and when it's invoked it will always use the &quot;right&quot; Python environment, which
means it will always be invoked in an environment where all the libraries it
needs (such as Pyramid) are available.</p>
<p>In general, you can make your script into a console script by doing the
following:</p>
<ul class="simple">
<li>Use an existing distribution (such as one you've already created via
<code class="docutils literal notranslate"><span class="pre">cookiecutter</span></code>) or create a new distribution that possesses at least one package
or module.  It should, within any module within the distribution, house a
callable (usually a function) that takes no arguments and which runs any of
the code you wish to run.</li>
<li>Add a <code class="docutils literal notranslate"><span class="pre">[console_scripts]</span></code> section to the <code class="docutils literal notranslate"><span class="pre">entry_points</span></code> argument of the
distribution which creates a mapping between a script name and a dotted name
representing the callable you added to your distribution.</li>
<li>Run <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></code> or <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">.</span></code> to get your distribution
reinstalled. When you reinstall your distribution, a file representing the
script that you named in the last step will be in the <code class="docutils literal notranslate"><span class="pre">bin</span></code> directory of
the virtual environment in which you installed the distribution. It will be
executable. Invoking it from a terminal will execute your callable.</li>
</ul>
<p>As an example, let's create some code that can be invoked by a console script
that prints the deployment settings of a Pyramid application.  To do so, we'll
pretend you have a distribution with a package in it named <code class="docutils literal notranslate"><span class="pre">myproject</span></code>.
Within this package, we'll pretend you've added a <code class="docutils literal notranslate"><span class="pre">scripts.py</span></code> module which
contains the following code:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># myproject.scripts module</span>

<span class="kn">import</span> <span class="nn">optparse</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">textwrap</span>

<span class="kn">from</span> <span class="nn">pyramid.paster</span> <span class="kn">import</span> <span class="n">bootstrap</span>

<span class="k">def</span> <span class="nf">settings_show</span><span class="p">():</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">    Print the deployment settings for a Pyramid application.  Example:</span>
<span class="s2">    &#39;show_settings deployment.ini&#39;</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">usage</span> <span class="o">=</span> <span class="s2">&quot;usage: %prog config_uri&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">optparse</span><span class="o">.</span><span class="n">OptionParser</span><span class="p">(</span>
        <span class="n">usage</span><span class="o">=</span><span class="n">usage</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span>
        <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="s1">&#39;--omit&#39;</span><span class="p">,</span>
        <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;omit&#39;</span><span class="p">,</span>
        <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;PREFIX&#39;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;string&#39;</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s1">&#39;append&#39;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Omit settings which start with PREFIX (you can use this &quot;</span>
              <span class="s2">&quot;option multiple times)&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">options</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;You must provide at least one argument&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="n">config_uri</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">omit</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">omit</span>
    <span class="k">if</span> <span class="n">omit</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">omit</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="n">bootstrap</span><span class="p">(</span><span class="n">config_uri</span><span class="p">)</span> <span class="k">as</span> <span class="n">env</span><span class="p">:</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">env</span><span class="p">[</span><span class="s1">&#39;registry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">settings</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">omit</span><span class="p">]):</span>
                <span class="k">continue</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%-40s</span><span class="s1">     </span><span class="si">%-20s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>This script uses the Python <code class="docutils literal notranslate"><span class="pre">optparse</span></code> module to allow us to make sense out
of extra arguments passed to the script.  It uses the
<a class="reference internal" href="../api/paster.html#pyramid.paster.bootstrap" title="pyramid.paster.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.paster.bootstrap()</span></code></a> function to get information about the
application defined by a config file, and prints the deployment settings
defined in that config file.</p>
<p>After adding this script to the package, you'll need to tell your
distribution's <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> about its existence.  Within your distribution's
top-level directory, your <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file will look something like this:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">find_packages</span>

<span class="n">here</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">here</span><span class="p">,</span> <span class="s1">&#39;README.txt&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">README</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">here</span><span class="p">,</span> <span class="s1">&#39;CHANGES.txt&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">CHANGES</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">requires</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pyramid&#39;</span><span class="p">,</span> <span class="s1">&#39;pyramid_debugtoolbar&#39;</span><span class="p">]</span>

<span class="n">tests_require</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;WebTest &gt;= 1.3.1&#39;</span><span class="p">,</span>  <span class="c1"># py3 compat</span>
    <span class="s1">&#39;pytest&#39;</span><span class="p">,</span>  <span class="c1"># includes virtualenv</span>
    <span class="s1">&#39;pytest-cov&#39;</span><span class="p">,</span>
    <span class="p">]</span>

<span class="n">setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;MyProject&#39;</span><span class="p">,</span>
      <span class="n">version</span><span class="o">=</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span>
      <span class="n">description</span><span class="o">=</span><span class="s1">&#39;My project&#39;</span><span class="p">,</span>
      <span class="n">long_description</span><span class="o">=</span><span class="n">README</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">+</span>  <span class="n">CHANGES</span><span class="p">,</span>
      <span class="n">classifiers</span><span class="o">=</span><span class="p">[</span>
          <span class="s2">&quot;Programming Language :: Python&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Framework :: Pyramid&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Topic :: Internet :: WWW/HTTP&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Topic :: Internet :: WWW/HTTP :: WSGI :: Application&quot;</span><span class="p">,</span>
      <span class="p">],</span>
      <span class="n">author</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="n">author_email</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="n">url</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="n">keywords</span><span class="o">=</span><span class="s1">&#39;web pyramid pylons&#39;</span><span class="p">,</span>
      <span class="n">packages</span><span class="o">=</span><span class="n">find_packages</span><span class="p">(),</span>
      <span class="n">include_package_data</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
      <span class="n">zip_safe</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
      <span class="n">install_requires</span><span class="o">=</span><span class="n">requires</span><span class="p">,</span>
      <span class="n">extras_require</span><span class="o">=</span><span class="p">{</span>
          <span class="s1">&#39;testing&#39;</span><span class="p">:</span> <span class="n">tests_require</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="n">entry_points</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">      [paste.app_factory]</span>
<span class="s2">      main = myproject:main</span>
<span class="s2">      &quot;&quot;&quot;</span><span class="p">,</span>
      <span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>We're going to change the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file to add a <code class="docutils literal notranslate"><span class="pre">[console_scripts]</span></code>
section within the <code class="docutils literal notranslate"><span class="pre">entry_points</span></code> string. Within this section, you should
specify a <code class="docutils literal notranslate"><span class="pre">scriptname</span> <span class="pre">=</span> <span class="pre">dotted.path.to:yourfunction</span></code> line.  For example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[console_scripts]</span>
<span class="na">show_settings</span> <span class="o">=</span> <span class="s">myproject.scripts:settings_show</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">show_settings</span></code> name will be the name of the script that is installed
into <code class="docutils literal notranslate"><span class="pre">bin</span></code>.  The colon (<code class="docutils literal notranslate"><span class="pre">:</span></code>) between <code class="docutils literal notranslate"><span class="pre">myproject.scripts</span></code> and
<code class="docutils literal notranslate"><span class="pre">settings_show</span></code> above indicates that <code class="docutils literal notranslate"><span class="pre">myproject.scripts</span></code> is a Python
module, and <code class="docutils literal notranslate"><span class="pre">settings_show</span></code> is the function in that module which contains the
code you'd like to run as the result of someone invoking the <code class="docutils literal notranslate"><span class="pre">show_settings</span></code>
script from their command line.</p>
<p>The result will be something like:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">find_packages</span>

<span class="n">here</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">here</span><span class="p">,</span> <span class="s1">&#39;README.txt&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">README</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">here</span><span class="p">,</span> <span class="s1">&#39;CHANGES.txt&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">CHANGES</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">requires</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pyramid&#39;</span><span class="p">,</span> <span class="s1">&#39;pyramid_debugtoolbar&#39;</span><span class="p">]</span>

<span class="n">tests_require</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;WebTest &gt;= 1.3.1&#39;</span><span class="p">,</span>  <span class="c1"># py3 compat</span>
    <span class="s1">&#39;pytest&#39;</span><span class="p">,</span>  <span class="c1"># includes virtualenv</span>
    <span class="s1">&#39;pytest-cov&#39;</span><span class="p">,</span>
    <span class="p">]</span>

<span class="n">setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;MyProject&#39;</span><span class="p">,</span>
      <span class="n">version</span><span class="o">=</span><span class="s1">&#39;0.0&#39;</span><span class="p">,</span>
      <span class="n">description</span><span class="o">=</span><span class="s1">&#39;My project&#39;</span><span class="p">,</span>
      <span class="n">long_description</span><span class="o">=</span><span class="n">README</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">+</span>  <span class="n">CHANGES</span><span class="p">,</span>
      <span class="n">classifiers</span><span class="o">=</span><span class="p">[</span>
          <span class="s2">&quot;Programming Language :: Python&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Framework :: Pyramid&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Topic :: Internet :: WWW/HTTP&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Topic :: Internet :: WWW/HTTP :: WSGI :: Application&quot;</span><span class="p">,</span>
      <span class="p">],</span>
      <span class="n">author</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="n">author_email</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="n">url</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
      <span class="n">keywords</span><span class="o">=</span><span class="s1">&#39;web pyramid pylons&#39;</span><span class="p">,</span>
      <span class="n">packages</span><span class="o">=</span><span class="n">find_packages</span><span class="p">(),</span>
      <span class="n">include_package_data</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
      <span class="n">zip_safe</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
      <span class="n">install_requires</span><span class="o">=</span><span class="n">requires</span><span class="p">,</span>
      <span class="n">extras_require</span><span class="o">=</span><span class="p">{</span>
          <span class="s1">&#39;testing&#39;</span><span class="p">:</span> <span class="n">tests_require</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="n">entry_points</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">      [paste.app_factory]</span>
<span class="s2">      main = myproject:main</span>
<span class="hll"><span class="s2">      [console_scripts]</span>
</span><span class="hll"><span class="s2">      show_settings = myproject.scripts:settings_show</span>
</span><span class="s2">      &quot;&quot;&quot;</span><span class="p">,</span>
      <span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Once you've done this, invoking <code class="docutils literal notranslate"><span class="pre">$VENV/bin/pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></code> will install a
file named <code class="docutils literal notranslate"><span class="pre">show_settings</span></code> into the <code class="docutils literal notranslate"><span class="pre">$somevenv/bin</span></code> directory with a
small bit of Python code that points to your entry point. It will be
executable. Running it without any arguments will print an error and exit.
Running it with a single argument that is the path of a config file will print
the settings. Running it with an <code class="docutils literal notranslate"><span class="pre">--omit=foo</span></code> argument will omit the settings
that have keys that start with <code class="docutils literal notranslate"><span class="pre">foo</span></code>. Running it with two &quot;omit&quot; options
(e.g., <code class="docutils literal notranslate"><span class="pre">--omit=foo</span> <span class="pre">--omit=bar</span></code>) will omit all settings that have keys that
start with either <code class="docutils literal notranslate"><span class="pre">foo</span></code> or <code class="docutils literal notranslate"><span class="pre">bar</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nv">$VENV</span>/bin/show_settings development.ini --omit<span class="o">=</span>pyramid --omit<span class="o">=</span>debugtoolbar
debug_routematch                             False
debug_templates                              True
reload_templates                             True
mako.directories                             <span class="o">[]</span>
debug_notfound                               False
default_locale_name                          en
reload_resources                             False
debug_authorization                          False
reload_assets                                False
prevent_http_cache                           False
</pre></div>
</div>
<p>Pyramid's <code class="docutils literal notranslate"><span class="pre">pserve</span></code>, <code class="docutils literal notranslate"><span class="pre">pcreate</span></code>, <code class="docutils literal notranslate"><span class="pre">pshell</span></code>, <code class="docutils literal notranslate"><span class="pre">prequest</span></code>, <code class="docutils literal notranslate"><span class="pre">ptweens</span></code>, and
other <code class="docutils literal notranslate"><span class="pre">p*</span></code> scripts are implemented as console scripts.  When you invoke one
of those, you are using a console script.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">Command-Line Pyramid</a><ul>
<li><a class="reference internal" href="#displaying-matching-views-for-a-given-url">Displaying Matching Views for a Given URL</a></li>
<li><a class="reference internal" href="#the-interactive-shell">The Interactive Shell</a><ul>
<li><a class="reference internal" href="#extending-the-shell">Extending the Shell</a></li>
<li><a class="reference internal" href="#alternative-shells">Alternative Shells</a></li>
<li><a class="reference internal" href="#setting-a-default-shell">Setting a Default Shell</a></li>
</ul>
</li>
<li><a class="reference internal" href="#displaying-all-application-routes">Displaying All Application Routes</a></li>
<li><a class="reference internal" href="#displaying-tweens">Displaying &quot;Tweens&quot;</a></li>
<li><a class="reference internal" href="#invoking-a-request">Invoking a Request</a></li>
<li><a class="reference internal" href="#using-custom-arguments-to-python-when-running-p-scripts">Using Custom Arguments to Python when Running <code class="docutils literal notranslate"><span class="pre">p*</span></code> Scripts</a></li>
<li><a class="reference internal" href="#showing-all-installed-distributions-and-their-versions">Showing All Installed Distributions and Their Versions</a></li>
<li><a class="reference internal" href="#writing-a-script">Writing a Script</a><ul>
<li><a class="reference internal" href="#changing-the-request">Changing the Request</a></li>
<li><a class="reference internal" href="#cleanup">Cleanup</a></li>
<li><a class="reference internal" href="#setting-up-logging">Setting Up Logging</a></li>
</ul>
</li>
<li><a class="reference internal" href="#making-your-script-into-a-console-script">Making Your Script into a Console Script</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="paste.html"
                        title="前の章へ">PasteDeploy Configuration Files</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="i18n.html"
                        title="次の章へ">Internationalization and Localization</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/narr/commandline.rst.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="i18n.html" title="Internationalization and Localization"
             >次へ</a> |</li>
        <li class="right" >
          <a href="paste.html" title="PasteDeploy Configuration Files"
             >前へ</a> |</li>
    	<li><a href="../index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2008-2018, Agendaless Consulting.
      最終更新: 8月 13, 2018
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4 で生成しました。
    </div>
  </body>
</html>