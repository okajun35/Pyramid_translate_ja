
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Templates &#8212; The Pyramid Web Framework v1.9.2</title>
    <link rel="stylesheet" href="../_static/pylons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="next" title="View Configuration" href="viewconfig.html" />
    <link rel="prev" title="Renderers" href="renderers.html" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/nobile/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/neuton/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="shortcut icon" href="../_static/pyramid.ico"/>

  </head><body>







<div class="header-small">
	
	<div class="logo-small">
		<a href="../index.html">
      		<img class="logo" src="../_static/pyramid-small.png" alt="Logo"/>
		</a>
  	</div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="viewconfig.html" title="View Configuration"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="renderers.html" title="Renderers"
             accesskey="P">前へ</a> |</li>
    	<li><a href="../index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="templates">
<span id="templates-chapter"></span><h1>Templates<a class="headerlink" href="#templates" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>A <a class="reference internal" href="../glossary.html#term-template"><span class="xref std std-term">template</span></a> is a file on disk which can be used to render dynamic data
provided by a <a class="reference internal" href="../glossary.html#term-view"><span class="xref std std-term">view</span></a>.  <span>Pyramid</span> offers a number of ways to perform
templating tasks out of the box, and provides add-on templating support through
a set of bindings packages.</p>
<p>Before discussing how built-in templates are used in detail, we'll discuss two
ways to render templates within <span>Pyramid</span> in general: directly and via
renderer configuration.</p>
<div class="section" id="using-templates-directly">
<span id="templates-used-directly"></span><span id="index-0"></span><h2>Using Templates Directly<a class="headerlink" href="#using-templates-directly" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The most straightforward way to use a template within <span>Pyramid</span> is to
cause it to be rendered directly within a <a class="reference internal" href="../glossary.html#term-view-callable"><span class="xref std std-term">view callable</span></a>.  You may use
whatever API is supplied by a given templating engine to do so.</p>
<p><span>Pyramid</span> provides various APIs that allow you to render templates directly
from within a view callable.  For example, if there is a <a class="reference internal" href="../glossary.html#term-chameleon"><span class="xref std std-term">Chameleon</span></a> ZPT
template named <code class="docutils literal notranslate"><span class="pre">foo.pt</span></code> in a directory named <code class="docutils literal notranslate"><span class="pre">templates</span></code> in your
application, you can render the template from within the body of a view
callable like so:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.renderers</span> <span class="kn">import</span> <span class="n">render_to_response</span>

<span class="k">def</span> <span class="nf">sample_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render_to_response</span><span class="p">(</span><span class="s1">&#39;templates/foo.pt&#39;</span><span class="p">,</span>
                              <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span>
                              <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The <code class="docutils literal notranslate"><span class="pre">sample_view</span></code> <a class="reference internal" href="../glossary.html#term-view-callable"><span class="xref std std-term">view callable</span></a> function above returns a
<a class="reference internal" href="../glossary.html#term-response"><span class="xref std std-term">response</span></a> object which contains the body of the <code class="docutils literal notranslate"><span class="pre">templates/foo.pt</span></code>
template.  In this case, the <code class="docutils literal notranslate"><span class="pre">templates</span></code> directory should live in the same
directory as the module containing the <code class="docutils literal notranslate"><span class="pre">sample_view</span></code> function.  The template
author will have the names <code class="docutils literal notranslate"><span class="pre">foo</span></code> and <code class="docutils literal notranslate"><span class="pre">bar</span></code> available as top-level names for
replacement or comparison purposes.</p>
<p>In the example above, the path <code class="docutils literal notranslate"><span class="pre">templates/foo.pt</span></code> is relative to the
directory containing the file which defines the view configuration. In this
case, this is the directory containing the file that defines the
<code class="docutils literal notranslate"><span class="pre">sample_view</span></code> function.  Although a renderer path is usually just a simple
relative pathname, a path named as a renderer can be absolute, starting with a
slash on UNIX or a drive letter prefix on Windows. The path can alternatively
be an <a class="reference internal" href="../glossary.html#term-asset-specification"><span class="xref std std-term">asset specification</span></a> in the form
<code class="docutils literal notranslate"><span class="pre">some.dotted.package_name:relative/path</span></code>. This makes it possible to address
template assets which live in another package.  For example:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.renderers</span> <span class="kn">import</span> <span class="n">render_to_response</span>

<span class="k">def</span> <span class="nf">sample_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render_to_response</span><span class="p">(</span><span class="s1">&#39;mypackage:templates/foo.pt&#39;</span><span class="p">,</span>
                              <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span>
                              <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>An asset specification points at a file within a Python <em>package</em>. In this
case, it points at a file named <code class="docutils literal notranslate"><span class="pre">foo.pt</span></code> within the <code class="docutils literal notranslate"><span class="pre">templates</span></code> directory
of the <code class="docutils literal notranslate"><span class="pre">mypackage</span></code> package.  Using an asset specification instead of a
relative template name is usually a good idea, because calls to
<a class="reference internal" href="../api/renderers.html#pyramid.renderers.render_to_response" title="pyramid.renderers.render_to_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">render_to_response()</span></code></a> using asset specifications will
continue to work properly if you move the code containing them to another
location.</p>
<p>In the examples above we pass in a keyword argument named <code class="docutils literal notranslate"><span class="pre">request</span></code>
representing the current <span>Pyramid</span> request. Passing a request keyword
argument will cause the <code class="docutils literal notranslate"><span class="pre">render_to_response</span></code> function to supply the renderer
with more correct system values (see <a class="reference internal" href="#renderer-system-values"><span class="std std-ref">System Values Used During Rendering</span></a>), because
most of the information required to compose proper system values is present in
the request.  If your template relies on the name <code class="docutils literal notranslate"><span class="pre">request</span></code> or <code class="docutils literal notranslate"><span class="pre">context</span></code>,
or if you've configured special <a class="reference internal" href="../glossary.html#term-renderer-globals"><span class="xref std std-term">renderer globals</span></a>, make sure to pass
<code class="docutils literal notranslate"><span class="pre">request</span></code> as a keyword argument in every call to a
<code class="docutils literal notranslate"><span class="pre">pyramid.renderers.render_*</span></code> function.</p>
<p>Every view must return a <a class="reference internal" href="../glossary.html#term-response"><span class="xref std std-term">response</span></a> object, except for views which use a
<a class="reference internal" href="../glossary.html#term-renderer"><span class="xref std std-term">renderer</span></a> named via view configuration (which we'll see shortly).  The
<a class="reference internal" href="../api/renderers.html#pyramid.renderers.render_to_response" title="pyramid.renderers.render_to_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.renderers.render_to_response()</span></code></a> function is a shortcut function
that actually returns a response object. This allows the example view above to
simply return the result of its call to <code class="docutils literal notranslate"><span class="pre">render_to_response()</span></code> directly.</p>
<p>Obviously not all APIs you might call to get response data will return a
response object. For example, you might render one or more templates to a
string that you want to use as response data.  The
<a class="reference internal" href="../api/renderers.html#pyramid.renderers.render" title="pyramid.renderers.render"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.renderers.render()</span></code></a> API renders a template to a string. We can
manufacture a <a class="reference internal" href="../glossary.html#term-response"><span class="xref std std-term">response</span></a> object directly, and use that string as the body
of the response:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.renderers</span> <span class="kn">import</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">pyramid.response</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="k">def</span> <span class="nf">sample_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">render</span><span class="p">(</span><span class="s1">&#39;mypackage:templates/foo.pt&#39;</span><span class="p">,</span>
                    <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span>
                    <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</td></tr></table></div>
<p>Because <a class="reference internal" href="../glossary.html#term-view-callable"><span class="xref std std-term">view callable</span></a> functions are typically the only code in
<span>Pyramid</span> that need to know anything about templates, and because view
functions are very simple Python, you can use whatever templating system with
which you're most comfortable within <span>Pyramid</span>.  Install the templating
system, import its API functions into your views module, use those APIs to
generate a string, then return that string as the body of a <span>Pyramid</span>
<a class="reference internal" href="../glossary.html#term-response"><span class="xref std std-term">Response</span></a> object.</p>
<p>For example, here's an example of using &quot;raw&quot; <a class="reference external" href="http://www.makotemplates.org/">Mako</a> from within a
<span>Pyramid</span> <a class="reference internal" href="../glossary.html#term-view"><span class="xref std std-term">view</span></a>:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mako.template</span> <span class="kn">import</span> <span class="n">Template</span>
<span class="kn">from</span> <span class="nn">pyramid.response</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="k">def</span> <span class="nf">make_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;/templates/template.mak&#39;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</td></tr></table></div>
<p>You probably wouldn't use this particular snippet in a project, because it's
easier to use the supported <a class="reference internal" href="#available-template-system-bindings"><span class="std std-ref">Mako bindings</span></a>. But if your favorite templating system
is not supported as a renderer extension for <span>Pyramid</span>, you can create
your own simple combination as shown above.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">If you use third-party templating languages without cooperating
<span>Pyramid</span> bindings directly within view callables, the
auto-template-reload strategy explained in <a class="reference internal" href="#reload-templates-section"><span class="std std-ref">Automatically Reloading Templates</span></a>
will not be available, nor will the template asset overriding capability
explained in <a class="reference internal" href="assets.html#overriding-assets-section"><span class="std std-ref">Overriding Assets</span></a> be available, nor will it be
possible to use any template using that language as a <a class="reference internal" href="../glossary.html#term-renderer"><span class="xref std std-term">renderer</span></a>.
However, it's reasonably easy to write custom templating system binding
packages for use under <span>Pyramid</span> so that templates written in the
language can be used as renderers. See
<a class="reference internal" href="renderers.html#adding-and-overriding-renderers"><span class="std std-ref">Adding and Changing Renderers</span></a> for instructions on how to create
your own template renderer and <a class="reference internal" href="#available-template-system-bindings"><span class="std std-ref">Available Add-On Template System Bindings</span></a>
for example packages.</p>
</div>
<p>If you need more control over the status code and content-type, or other
response attributes from views that use direct templating, you may set
attributes on the response that influence these values.</p>
<p>Here's an example of changing the content-type and status of the response
object returned by <a class="reference internal" href="../api/renderers.html#pyramid.renderers.render_to_response" title="pyramid.renderers.render_to_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">render_to_response()</span></code></a>:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.renderers</span> <span class="kn">import</span> <span class="n">render_to_response</span>

<span class="k">def</span> <span class="nf">sample_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">render_to_response</span><span class="p">(</span><span class="s1">&#39;templates/foo.pt&#39;</span><span class="p">,</span>
                                  <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span>
                                  <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">content_type</span> <span class="o">=</span> <span class="s1">&#39;text/plain&#39;</span>
    <span class="n">response</span><span class="o">.</span><span class="n">status_int</span> <span class="o">=</span> <span class="mi">204</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</td></tr></table></div>
<p>Here's an example of manufacturing a response object using the result of
<a class="reference internal" href="../api/renderers.html#pyramid.renderers.render" title="pyramid.renderers.render"><code class="xref py py-func docutils literal notranslate"><span class="pre">render()</span></code></a> (a string):</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.renderers</span> <span class="kn">import</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">pyramid.response</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="k">def</span> <span class="nf">sample_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">render</span><span class="p">(</span><span class="s1">&#39;mypackage:templates/foo.pt&#39;</span><span class="p">,</span>
                    <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span>
                    <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">content_type</span> <span class="o">=</span> <span class="s1">&#39;text/plain&#39;</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</td></tr></table></div>
<span class="target" id="index-1"></span></div>
<div class="section" id="system-values-used-during-rendering">
<span id="renderer-system-values"></span><span id="index-2"></span><h2>System Values Used During Rendering<a class="headerlink" href="#system-values-used-during-rendering" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>When a template is rendered using <a class="reference internal" href="../api/renderers.html#pyramid.renderers.render_to_response" title="pyramid.renderers.render_to_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">render_to_response()</span></code></a>
or <a class="reference internal" href="../api/renderers.html#pyramid.renderers.render" title="pyramid.renderers.render"><code class="xref py py-func docutils literal notranslate"><span class="pre">render()</span></code></a>, or a <code class="docutils literal notranslate"><span class="pre">renderer=</span></code> argument to view
configuration (see <a class="reference internal" href="#templates-used-as-renderers"><span class="std std-ref">Templates Used as Renderers via Configuration</span></a>), the renderer
representing the template will be provided with a number of <em>system</em> values.
These values are provided to the template:</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">request</span></code></dt>
<dd>The value provided as the <code class="docutils literal notranslate"><span class="pre">request</span></code> keyword argument to
<code class="docutils literal notranslate"><span class="pre">render_to_response</span></code> or <code class="docutils literal notranslate"><span class="pre">render</span></code> <em>or</em> the request object passed to the
view when the <code class="docutils literal notranslate"><span class="pre">renderer=</span></code> argument to view configuration is being used to
render the template.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">req</span></code></dt>
<dd>An alias for <code class="docutils literal notranslate"><span class="pre">request</span></code>.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">context</span></code></dt>
<dd>The current <span>Pyramid</span> <a class="reference internal" href="../glossary.html#term-context"><span class="xref std std-term">context</span></a> if <code class="docutils literal notranslate"><span class="pre">request</span></code> was provided as a
keyword argument to <code class="docutils literal notranslate"><span class="pre">render_to_response</span></code> or <code class="docutils literal notranslate"><span class="pre">render</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the
<code class="docutils literal notranslate"><span class="pre">request</span></code> keyword argument was not provided.  This value will always be
provided if the template is rendered as the result of a <code class="docutils literal notranslate"><span class="pre">renderer=</span></code>
argument to the view configuration being used.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">get_csrf_token()</span></code></dt>
<dd>A convenience function to access the current CSRF token. See
<a class="reference internal" href="security.html#get-csrf-token-in-templates"><span class="std std-ref">Using the get_csrf_token global in templates</span></a> for more information.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">renderer_name</span></code></dt>
<dd>The renderer name used to perform the rendering, e.g.,
<code class="docutils literal notranslate"><span class="pre">mypackage:templates/foo.pt</span></code>.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">renderer_info</span></code></dt>
<dd>An object implementing the <a class="reference internal" href="../api/interfaces.html#pyramid.interfaces.IRendererInfo" title="pyramid.interfaces.IRendererInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.interfaces.IRendererInfo</span></code></a>
interface.  Basically, an object with the following attributes: <code class="docutils literal notranslate"><span class="pre">name</span></code>,
<code class="docutils literal notranslate"><span class="pre">package</span></code>, and <code class="docutils literal notranslate"><span class="pre">type</span></code>.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">view</span></code></dt>
<dd>The view callable object that was used to render this template.  If the view
callable is a method of a class-based view, this will be an instance of the
class that the method was defined on.  If the view callable is a function or
instance, it will be that function or instance.  Note that this value will
only be automatically present when a template is rendered as a result of a
<code class="docutils literal notranslate"><span class="pre">renderer=</span></code> argument; it will be <code class="docutils literal notranslate"><span class="pre">None</span></code> when the <code class="docutils literal notranslate"><span class="pre">render_to_response</span></code>
or <code class="docutils literal notranslate"><span class="pre">render</span></code> APIs are used.</dd>
</dl>
<p>You can define more values which will be passed to every template executed as a
result of rendering by defining <a class="reference internal" href="../glossary.html#term-renderer-globals"><span class="xref std std-term">renderer globals</span></a>.</p>
<p>What any particular renderer does with these system values is up to the
renderer itself, but most template renderers make these names available as
top-level template variables.</p>
</div>
<div class="section" id="templates-used-as-renderers-via-configuration">
<span id="templates-used-as-renderers"></span><span id="index-3"></span><h2>Templates Used as Renderers via Configuration<a class="headerlink" href="#templates-used-as-renderers-via-configuration" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>An alternative to using <a class="reference internal" href="../api/renderers.html#pyramid.renderers.render_to_response" title="pyramid.renderers.render_to_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">render_to_response()</span></code></a> to render
templates manually in your view callable code is to specify the template as a
<a class="reference internal" href="../glossary.html#term-renderer"><span class="xref std std-term">renderer</span></a> in your <em>view configuration</em>. This can be done with any of the
templating languages supported by <span>Pyramid</span>.</p>
<p>To use a renderer via view configuration, specify a template <a class="reference internal" href="../glossary.html#term-asset-specification"><span class="xref std std-term">asset
specification</span></a> as the <code class="docutils literal notranslate"><span class="pre">renderer</span></code> argument, or attribute to the <a class="reference internal" href="../glossary.html#term-view-configuration"><span class="xref std std-term">view
configuration</span></a> of a <a class="reference internal" href="../glossary.html#term-view-callable"><span class="xref std std-term">view callable</span></a>.  Then return a <em>dictionary</em> from
that view callable.  The dictionary items returned by the view callable will be
made available to the renderer template as top-level names.</p>
<p>The association of a template as a renderer for a <a class="reference internal" href="../glossary.html#term-view-configuration"><span class="xref std std-term">view configuration</span></a>
makes it possible to replace code within a <a class="reference internal" href="../glossary.html#term-view-callable"><span class="xref std std-term">view callable</span></a> that handles
the rendering of a template.</p>
<p>Here's an example of using a <a class="reference internal" href="../api/view.html#pyramid.view.view_config" title="pyramid.view.view_config"><code class="xref py py-class docutils literal notranslate"><span class="pre">view_config</span></code></a> decorator to
specify a <a class="reference internal" href="../glossary.html#term-view-configuration"><span class="xref std std-term">view configuration</span></a> that names a template renderer:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.view</span> <span class="kn">import</span> <span class="n">view_config</span>

<span class="nd">@view_config</span><span class="p">(</span><span class="n">renderer</span><span class="o">=</span><span class="s1">&#39;templates/foo.pt&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">You do not need to supply the <code class="docutils literal notranslate"><span class="pre">request</span></code> value as a key in the dictionary
result returned from a renderer-configured view callable. <span>Pyramid</span>
automatically supplies this value for you, so that the &quot;most correct&quot; system
values are provided to the renderer.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">renderer</span></code> argument to the <code class="docutils literal notranslate"><span class="pre">&#64;view_config</span></code> configuration decorator
shown above is the template <em>path</em>.  In the example above, the path
<code class="docutils literal notranslate"><span class="pre">templates/foo.pt</span></code> is <em>relative</em>.  Relative to what, you ask?  Because
we're using a Chameleon renderer, it means &quot;relative to the directory in
which the file that defines the view configuration lives&quot;.  In this case,
this is the directory containing the file that defines the <code class="docutils literal notranslate"><span class="pre">my_view</span></code>
function.</p>
</div>
<p>Similar renderer configuration can be done imperatively.  See
<a class="reference internal" href="renderers.html#views-which-use-a-renderer"><span class="std std-ref">Writing View Callables Which Use a Renderer</span></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last">See also <a class="reference internal" href="renderers.html#built-in-renderers"><span class="std std-ref">Built-in Renderers</span></a>.</p>
</div>
<p>Although a renderer path is usually just a simple relative pathname, a path
named as a renderer can be absolute, starting with a slash on UNIX or a drive
letter prefix on Windows.  The path can alternatively be an <a class="reference internal" href="../glossary.html#term-asset-specification"><span class="xref std std-term">asset
specification</span></a> in the form <code class="docutils literal notranslate"><span class="pre">some.dotted.package_name:relative/path</span></code>, making
it possible to address template assets which live in another package.</p>
<p>Not just any template from any arbitrary templating system may be used as a
renderer.  Bindings must exist specifically for <span>Pyramid</span> to use a
templating language template as a renderer.</p>
<div class="sidebar">
<p class="first sidebar-title">Why Use a Renderer via View Configuration</p>
<p class="last">Using a renderer in view configuration is usually a better way to render
templates than using any rendering API directly from within a <a class="reference internal" href="../glossary.html#term-view-callable"><span class="xref std std-term">view
callable</span></a> because it makes the view callable more unit-testable.  Views
which use templating or rendering APIs directly must return a
<a class="reference internal" href="../glossary.html#term-response"><span class="xref std std-term">Response</span></a> object.  Making testing assertions about response objects
is typically an indirect process, because it means that your test code often
needs to somehow parse information out of the response body (often HTML).
View callables configured with renderers externally via view configuration
typically return a dictionary, as above.  Making assertions about results
returned in a dictionary is almost always more direct and straightforward
than needing to parse HTML.</p>
</div>
<p>By default, views rendered via a template renderer return a <a class="reference internal" href="../glossary.html#term-response"><span class="xref std std-term">Response</span></a>
object which has a <em>status code</em> of <code class="docutils literal notranslate"><span class="pre">200</span> <span class="pre">OK</span></code>, and a <em>content-type</em> of
<code class="docutils literal notranslate"><span class="pre">text/html</span></code>.  To vary attributes of the response of a view that uses a
renderer, such as the content-type, headers, or status attributes, you must use
the API of the <a class="reference internal" href="../api/response.html#pyramid.response.Response" title="pyramid.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.response.Response</span></code></a> object exposed as
<code class="docutils literal notranslate"><span class="pre">request.response</span></code> within the view before returning the dictionary.  See
<a class="reference internal" href="renderers.html#request-response-attr"><span class="std std-ref">Varying Attributes of Rendered Responses</span></a> for more information.</p>
<p>The same set of system values are provided to templates rendered via a renderer
view configuration as those provided to templates rendered imperatively.  See
<a class="reference internal" href="#renderer-system-values"><span class="std std-ref">System Values Used During Rendering</span></a>.</p>
</div>
<div class="section" id="debugging-templates">
<span id="index-4"></span><span id="id1"></span><h2>Debugging Templates<a class="headerlink" href="#debugging-templates" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NameError" title="(in Python v3.7)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NameError</span></code></a> exception resulting from rendering a template with an
undefined variable (e.g. <code class="docutils literal notranslate"><span class="pre">${wrong}</span></code>) might end up looking like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>RuntimeError: Caught exception rendering template.
 - Expression: ``wrong``
 - Filename:   /home/fred/env/proj/proj/templates/mytemplate.pt
 - Arguments:  renderer_name: proj:templates/mytemplate.pt
               template: &lt;PageTemplateFile - at 0x1d2ecf0&gt;
               xincludes: &lt;XIncludes - at 0x1d3a130&gt;
               request: &lt;Request - at 0x1d2ecd0&gt;
               project: proj
               macros: &lt;Macros - at 0x1d3aed0&gt;
               context: &lt;MyResource None at 0x1d39130&gt;
               view: &lt;function my_view at 0x1d23570&gt;

NameError: wrong
</pre></div>
</div>
<p>The output tells you which template the error occurred in, as well as
displaying the arguments passed to the template itself.</p>
</div>
<div class="section" id="automatically-reloading-templates">
<span id="reload-templates-section"></span><span id="index-5"></span><h2>Automatically Reloading Templates<a class="headerlink" href="#automatically-reloading-templates" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>It's often convenient to see changes you make to a template file appear
immediately without needing to restart the application process. <span>Pyramid</span>
allows you to configure your application development environment so that a
change to a template will be automatically detected, and the template will be
reloaded on the next rendering.</p>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">Auto-template-reload behavior is not recommended for production sites as it
slows rendering slightly; it's usually only desirable during development.</p>
</div>
<p>In order to turn on automatic reloading of templates, you can use an
environment variable or a configuration file setting.</p>
<p>To use an environment variable, start your application under a shell using the
<code class="docutils literal notranslate"><span class="pre">PYRAMID_RELOAD_TEMPLATES</span></code> operating system environment variable set to
<code class="docutils literal notranslate"><span class="pre">1</span></code>, For example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ PYRAMID_RELOAD_TEMPLATES=1 $VENV/bin/pserve myproject.ini
</pre></div>
</div>
<p>To use a setting in the application <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file for the same purpose, set the
<code class="docutils literal notranslate"><span class="pre">pyramid.reload_templates</span></code> key to <code class="docutils literal notranslate"><span class="pre">true</span></code> within the application's
configuration section, e.g.:</p>
<div class="highlight-ini notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">[app:main]</span>
<span class="na">use</span> <span class="o">=</span> <span class="s">egg:MyProject</span>
<span class="na">pyramid.reload_templates</span> <span class="o">=</span> <span class="s">true</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="available-add-on-template-system-bindings">
<span id="available-template-system-bindings"></span><span id="index-6"></span><h2>Available Add-On Template System Bindings<a class="headerlink" href="#available-add-on-template-system-bindings" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The Pylons Project maintains several packages providing bindings to different
templating languages including the following:</p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="37%" />
<col width="27%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Template Language</th>
<th class="head">Pyramid Bindings</th>
<th class="head">Default Extensions</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="https://chameleon.readthedocs.io/en/latest/">Chameleon</a></td>
<td><a class="reference external" href="https://docs.pylonsproject.org/projects/pyramid-chameleon/en/latest/">pyramid_chameleon</a></td>
<td>.pt, .txt</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="http://jinja.pocoo.org/docs/dev/">Jinja2</a></td>
<td><a class="reference external" href="https://docs.pylonsproject.org/projects/pyramid-jinja2/en/latest/">pyramid_jinja2</a></td>
<td>.jinja2</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="http://www.makotemplates.org/">Mako</a></td>
<td><a class="reference external" href="https://docs.pylonsproject.org/projects/pyramid-mako/en/latest/">pyramid_mako</a></td>
<td>.mak, .mako</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Templates</a><ul>
<li><a class="reference internal" href="#using-templates-directly">Using Templates Directly</a></li>
<li><a class="reference internal" href="#system-values-used-during-rendering">System Values Used During Rendering</a></li>
<li><a class="reference internal" href="#templates-used-as-renderers-via-configuration">Templates Used as Renderers via Configuration</a></li>
<li><a class="reference internal" href="#debugging-templates">Debugging Templates</a></li>
<li><a class="reference internal" href="#automatically-reloading-templates">Automatically Reloading Templates</a></li>
<li><a class="reference internal" href="#available-add-on-template-system-bindings">Available Add-On Template System Bindings</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="renderers.html"
                        title="前の章へ">Renderers</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="viewconfig.html"
                        title="次の章へ">View Configuration</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/narr/templates.rst.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="viewconfig.html" title="View Configuration"
             >次へ</a> |</li>
        <li class="right" >
          <a href="renderers.html" title="Renderers"
             >前へ</a> |</li>
    	<li><a href="../index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2008-2018, Agendaless Consulting.
      最終更新: 11月 02, 2018
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1 で生成しました。
    </div>
  </body>
</html>