
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Basic Layout &#8212; The Pyramid Web Framework v1.9.2</title>
    <link rel="stylesheet" href="../../_static/pylons.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/translations.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="copyright" title="著作権" href="../../copyright.html" />
    <link rel="next" title="Defining the Domain Model" href="definingmodels.html" />
    <link rel="prev" title="Installation" href="installation.html" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/nobile/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/neuton/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="shortcut icon" href="../../_static/pyramid.ico"/>

  </head><body>







<div class="header-small">
	
	<div class="logo-small">
		<a href="../../index.html">
      		<img class="logo" src="../../_static/pyramid-small.png" alt="Logo"/>
		</a>
  	</div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="definingmodels.html" title="Defining the Domain Model"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="P">前へ</a> |</li>
    	<li><a href="../../index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">ZODB + Traversal Wiki Tutorial</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="basic-layout">
<span id="wiki-basic-layout"></span><h1>Basic Layout<a class="headerlink" href="#basic-layout" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>The starter files generated by the <code class="docutils literal notranslate"><span class="pre">zodb</span></code> cookiecutter are very basic, but
they provide a good orientation for the high-level patterns common to most
<a class="reference internal" href="../../glossary.html#term-traversal"><span class="xref std std-term">traversal</span></a>-based (and <a class="reference internal" href="../../glossary.html#term-zodb"><span class="xref std std-term">ZODB</span></a>-based) <span>Pyramid</span> projects.</p>
<div class="section" id="application-configuration-with-init-py">
<h2>Application configuration with <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code><a class="headerlink" href="#application-configuration-with-init-py" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A directory on disk can be turned into a Python <a class="reference internal" href="../../glossary.html#term-package"><span class="xref std std-term">package</span></a> by containing
an <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file.  Even if empty, this marks a directory as a Python
package.  We use <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> both as a marker, indicating the directory in
which it's contained is a package, and to contain application configuration
code.</p>
<p>When you run the application using the <code class="docutils literal notranslate"><span class="pre">pserve</span></code> command using the
<code class="docutils literal notranslate"><span class="pre">development.ini</span></code> generated configuration file, the application
configuration points at a setuptools <em>entry point</em> described as
<code class="docutils literal notranslate"><span class="pre">egg:tutorial</span></code>.  In our application, because the application's <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>
file says so, this entry point happens to be the <code class="docutils literal notranslate"><span class="pre">main</span></code> function within the
file named <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>.</p>
<p>Open <code class="docutils literal notranslate"><span class="pre">tutorial/__init__.py</span></code>.  It should already contain the following:</p>
<div class="highlight-py notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.config</span> <span class="kn">import</span> <span class="n">Configurator</span>
<span class="kn">from</span> <span class="nn">pyramid_zodbconn</span> <span class="kn">import</span> <span class="n">get_connection</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">appmaker</span>


<span class="k">def</span> <span class="nf">root_factory</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">get_connection</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">appmaker</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">root</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">global_config</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This function returns a Pyramid WSGI application.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;tm.manager_hook&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pyramid_tm.explicit_manager&#39;</span>
    <span class="k">with</span> <span class="n">Configurator</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">)</span> <span class="k">as</span> <span class="n">config</span><span class="p">:</span>
        <span class="n">config</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="s1">&#39;pyramid_chameleon&#39;</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="s1">&#39;pyramid_tm&#39;</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="s1">&#39;pyramid_retry&#39;</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="s1">&#39;pyramid_zodbconn&#39;</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_root_factory</span><span class="p">(</span><span class="n">root_factory</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">add_static_view</span><span class="p">(</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="n">cache_max_age</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">scan</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">make_wsgi_app</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<ol class="arabic simple">
<li><em>Lines 1-3</em>.  Perform some dependency imports.</li>
<li><em>Lines 6-8</em>.  Define a <a class="reference internal" href="../../glossary.html#term-root-factory"><span class="xref std std-term">root factory</span></a> for our Pyramid application.</li>
<li><em>Line 11</em>.  <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> defines a function named <code class="docutils literal notranslate"><span class="pre">main</span></code>.</li>
<li><em>Line 14</em>.  Use an explicit transaction manager for apps so that they do not implicitly create new transactions when touching the manager outside of the <code class="docutils literal notranslate"><span class="pre">pyramid_tm</span></code> lifecycle.</li>
<li><em>Line 15</em>.  Construct a <a class="reference internal" href="../../glossary.html#term-configurator"><span class="xref std std-term">Configurator</span></a> as a <a class="reference internal" href="../../glossary.html#term-context-manager"><span class="xref std std-term">context manager</span></a> with the settings keyword parsed by <a class="reference internal" href="../../glossary.html#term-pastedeploy"><span class="xref std std-term">PasteDeploy</span></a>.</li>
<li><em>Line 16</em>.  Include support for the <a class="reference internal" href="../../glossary.html#term-chameleon"><span class="xref std std-term">Chameleon</span></a> template rendering
bindings, allowing us to use the <code class="docutils literal notranslate"><span class="pre">.pt</span></code> templates.</li>
<li><em>Line 17</em>.  Include support for <code class="docutils literal notranslate"><span class="pre">pyramid_tm</span></code>, allowing Pyramid requests to join the active transaction as provided by the <a class="reference external" href="https://pypi.org/project/transaction/">transaction</a> package.</li>
<li><em>Line 18</em>.  Include support for <code class="docutils literal notranslate"><span class="pre">pyramid_retry</span></code> to retry a request when transient exceptions occur.</li>
<li><em>Line 19</em>.  Include support for <code class="docutils literal notranslate"><span class="pre">pyramid_zodbconn</span></code>, providing integration between <a class="reference internal" href="../../glossary.html#term-zodb"><span class="xref std std-term">ZODB</span></a> and a Pyramid application.</li>
<li><em>Line 20</em>.  Set a root factory using our function named <code class="docutils literal notranslate"><span class="pre">root_factory</span></code>.</li>
<li><em>Line 21</em>.  Register a &quot;static view&quot;, which answers requests whose URL
paths start with <code class="docutils literal notranslate"><span class="pre">/static</span></code>, using the
<a class="reference internal" href="../../api/config.html#pyramid.config.Configurator.add_static_view" title="pyramid.config.Configurator.add_static_view"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.add_static_view()</span></code></a> method.  This
statement registers a view that will serve up static assets, such as CSS
and image files, for us, in this case, at
<code class="docutils literal notranslate"><span class="pre">http://localhost:6543/static/</span></code> and below.  The first argument is the
&quot;name&quot; <code class="docutils literal notranslate"><span class="pre">static</span></code>, which indicates that the URL path prefix of the view
will be <code class="docutils literal notranslate"><span class="pre">/static</span></code>.  The second argument of this tag is the &quot;path&quot;,
which is a relative <a class="reference internal" href="../../glossary.html#term-asset-specification"><span class="xref std std-term">asset specification</span></a>, so it finds the resources
it should serve within the <code class="docutils literal notranslate"><span class="pre">static</span></code> directory inside the <code class="docutils literal notranslate"><span class="pre">tutorial</span></code>
package.  Alternatively the cookiecutter could have used an <em>absolute</em> asset
specification as the path (<code class="docutils literal notranslate"><span class="pre">tutorial:static</span></code>).</li>
<li><em>Line 22</em>.  Perform a <a class="reference internal" href="../../glossary.html#term-scan"><span class="xref std std-term">scan</span></a>.  A scan will find <a class="reference internal" href="../../glossary.html#term-configuration-decoration"><span class="xref std std-term">configuration
decoration</span></a>, such as view configuration decorators (e.g., <code class="docutils literal notranslate"><span class="pre">&#64;view_config</span></code>)
in the source code of the <code class="docutils literal notranslate"><span class="pre">tutorial</span></code> package and will take actions based
on these decorators.  We don't pass any arguments to
<a class="reference internal" href="../../api/config.html#pyramid.config.Configurator.scan" title="pyramid.config.Configurator.scan"><code class="xref py py-meth docutils literal notranslate"><span class="pre">scan()</span></code></a>, which implies that the scan
should take place in the current package (in this case, <code class="docutils literal notranslate"><span class="pre">tutorial</span></code>).
The cookiecutter could have equivalently said <code class="docutils literal notranslate"><span class="pre">config.scan('tutorial')</span></code>, but
it chose to omit the package name argument.</li>
<li><em>Line 23</em>.  Use the
<a class="reference internal" href="../../api/config.html#pyramid.config.Configurator.make_wsgi_app" title="pyramid.config.Configurator.make_wsgi_app"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.make_wsgi_app()</span></code></a> method
to return a <a class="reference internal" href="../../glossary.html#term-wsgi"><span class="xref std std-term">WSGI</span></a> application.</li>
</ol>
</div>
<div class="section" id="resources-and-models-with-models-py">
<h2>Resources and models with <code class="docutils literal notranslate"><span class="pre">models.py</span></code><a class="headerlink" href="#resources-and-models-with-models-py" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><span>Pyramid</span> uses the word <a class="reference internal" href="../../glossary.html#term-resource"><span class="xref std std-term">resource</span></a> to describe objects arranged
hierarchically in a <a class="reference internal" href="../../glossary.html#term-resource-tree"><span class="xref std std-term">resource tree</span></a>.  This tree is consulted by
<a class="reference internal" href="../../glossary.html#term-traversal"><span class="xref std std-term">traversal</span></a> to map URLs to code.  In this application, the resource
tree represents the site structure, but it <em>also</em> represents the
<a class="reference internal" href="../../glossary.html#term-domain-model"><span class="xref std std-term">domain model</span></a> of the application, because each resource is a node
stored persistently in a <a class="reference internal" href="../../glossary.html#term-zodb"><span class="xref std std-term">ZODB</span></a> database.  The <code class="docutils literal notranslate"><span class="pre">models.py</span></code> file is
where the <code class="docutils literal notranslate"><span class="pre">zodb</span></code> cookiecutter put the classes that implement our
resource objects, each of which also happens to be a domain model object.</p>
<p>Here is the source for <code class="docutils literal notranslate"><span class="pre">models.py</span></code>:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">persistent.mapping</span> <span class="kn">import</span> <span class="n">PersistentMapping</span>


<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">PersistentMapping</span><span class="p">):</span>
    <span class="n">__parent__</span> <span class="o">=</span> <span class="vm">__name__</span> <span class="o">=</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">appmaker</span><span class="p">(</span><span class="n">zodb_root</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;app_root&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">zodb_root</span><span class="p">:</span>
        <span class="n">app_root</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
        <span class="n">zodb_root</span><span class="p">[</span><span class="s1">&#39;app_root&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">app_root</span>
    <span class="k">return</span> <span class="n">zodb_root</span><span class="p">[</span><span class="s1">&#39;app_root&#39;</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
<ol class="arabic">
<li><p class="first"><em>Lines 4-5</em>.  The <code class="docutils literal notranslate"><span class="pre">MyModel</span></code> <a class="reference internal" href="../../glossary.html#term-resource"><span class="xref std std-term">resource</span></a> class is implemented here.
Instances of this class are capable of being persisted in <a class="reference internal" href="../../glossary.html#term-zodb"><span class="xref std std-term">ZODB</span></a>
because the class inherits from the
<code class="xref py py-class docutils literal notranslate"><span class="pre">persistent.mapping.PersistentMapping</span></code> class.  The <code class="docutils literal notranslate"><span class="pre">__parent__</span></code>
and <code class="docutils literal notranslate"><span class="pre">__name__</span></code> are important parts of the <a class="reference internal" href="../../glossary.html#term-traversal"><span class="xref std std-term">traversal</span></a> protocol.
By default, set these to <code class="docutils literal notranslate"><span class="pre">None</span></code> to indicate that this is the
<a class="reference internal" href="../../glossary.html#term-root"><span class="xref std std-term">root</span></a> object.</p>
</li>
<li><p class="first"><em>Lines 8-12</em>.  <code class="docutils literal notranslate"><span class="pre">appmaker</span></code> is used to return the <em>application
root</em> object.  It is called on <em>every request</em> to the
<span>Pyramid</span> application.  It also performs bootstrapping by
<em>creating</em> an application root (inside the ZODB root object) if one
does not already exist.  It is used by the <code class="docutils literal notranslate"><span class="pre">root_factory</span></code> we've defined
in our <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>.</p>
<p>Bootstrapping is done by first seeing if the database has the persistent
application root.  If not, we make an instance, store it, and commit the
transaction.  We then return the application root object.</p>
</li>
</ol>
</div>
<div class="section" id="views-with-views-py">
<h2>Views With <code class="docutils literal notranslate"><span class="pre">views.py</span></code><a class="headerlink" href="#views-with-views-py" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Our cookiecutter generated a default <code class="docutils literal notranslate"><span class="pre">views.py</span></code> on our behalf.  It
contains a single view, which is used to render the page shown when you visit
the URL <code class="docutils literal notranslate"><span class="pre">http://localhost:6543/</span></code>.</p>
<p>Here is the source for <code class="docutils literal notranslate"><span class="pre">views.py</span></code>:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.view</span> <span class="kn">import</span> <span class="n">view_config</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">MyModel</span>


<span class="nd">@view_config</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">MyModel</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="s1">&#39;templates/mytemplate.pt&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;project&#39;</span><span class="p">:</span> <span class="s1">&#39;myproj&#39;</span><span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Let's try to understand the components in this module:</p>
<ol class="arabic">
<li><p class="first"><em>Lines 1-2</em>. Perform some dependency imports.</p>
</li>
<li><p class="first"><em>Line 5</em>.  Use the <a class="reference internal" href="../../api/view.html#pyramid.view.view_config" title="pyramid.view.view_config"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.view.view_config()</span></code></a> <a class="reference internal" href="../../glossary.html#term-configuration-decoration"><span class="xref std std-term">configuration
decoration</span></a> to perform a <a class="reference internal" href="../../glossary.html#term-view-configuration"><span class="xref std std-term">view configuration</span></a> registration.  This
view configuration registration will be activated when the application is
started.  It will be activated by virtue of it being found as the result
of a <a class="reference internal" href="../../glossary.html#term-scan"><span class="xref std std-term">scan</span></a> (when Line 14 of <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> is run).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;view_config</span></code> decorator accepts a number of keyword arguments.  We
use two keyword arguments here: <code class="docutils literal notranslate"><span class="pre">context</span></code> and <code class="docutils literal notranslate"><span class="pre">renderer</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">context</span></code> argument signifies that the decorated view callable should
only be run when <a class="reference internal" href="../../glossary.html#term-traversal"><span class="xref std std-term">traversal</span></a> finds the <code class="docutils literal notranslate"><span class="pre">tutorial.models.MyModel</span></code>
<a class="reference internal" href="../../glossary.html#term-resource"><span class="xref std std-term">resource</span></a> to be the <a class="reference internal" href="../../glossary.html#term-context"><span class="xref std std-term">context</span></a> of a request.  In English, this
means that when the URL <code class="docutils literal notranslate"><span class="pre">/</span></code> is visited, because <code class="docutils literal notranslate"><span class="pre">MyModel</span></code> is the root
model, this view callable will be invoked.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">renderer</span></code> argument names an <a class="reference internal" href="../../glossary.html#term-asset-specification"><span class="xref std std-term">asset specification</span></a> of
<code class="docutils literal notranslate"><span class="pre">templates/mytemplate.pt</span></code>.  This asset specification points at a
<a class="reference internal" href="../../glossary.html#term-chameleon"><span class="xref std std-term">Chameleon</span></a> template which lives in the <code class="docutils literal notranslate"><span class="pre">mytemplate.pt</span></code> file
within the <code class="docutils literal notranslate"><span class="pre">templates</span></code> directory of the <code class="docutils literal notranslate"><span class="pre">tutorial</span></code> package.  And
indeed if you look in the <code class="docutils literal notranslate"><span class="pre">templates</span></code> directory of this package, you'll
see a <code class="docutils literal notranslate"><span class="pre">mytemplate.pt</span></code> template file, which renders the default home page
of the generated project.  This asset specification is <em>relative</em> (to the
view.py's current package).  Alternatively we could have used the
absolute asset specification <code class="docutils literal notranslate"><span class="pre">tutorial:templates/mytemplate.pt</span></code>, but
chose to use the relative version.</p>
<p>Since this call to <code class="docutils literal notranslate"><span class="pre">&#64;view_config</span></code> doesn't pass a <code class="docutils literal notranslate"><span class="pre">name</span></code> argument, the
<code class="docutils literal notranslate"><span class="pre">my_view</span></code> function which it decorates represents the &quot;default&quot; view
callable used when the context is of the type <code class="docutils literal notranslate"><span class="pre">MyModel</span></code>.</p>
</li>
<li><p class="first"><em>Lines 6-7</em>.  We define a <a class="reference internal" href="../../glossary.html#term-view-callable"><span class="xref std std-term">view callable</span></a> named <code class="docutils literal notranslate"><span class="pre">my_view</span></code>, which
we decorated in the step above.  This view callable is a <em>function</em> we
write generated by the <code class="docutils literal notranslate"><span class="pre">zodb</span></code> cookiecutter that is given a
<code class="docutils literal notranslate"><span class="pre">request</span></code> and which returns a dictionary.  The <code class="docutils literal notranslate"><span class="pre">mytemplate.pt</span></code>
<a class="reference internal" href="../../glossary.html#term-renderer"><span class="xref std std-term">renderer</span></a> named by the asset specification in the step above will
convert this dictionary to a <a class="reference internal" href="../../glossary.html#term-response"><span class="xref std std-term">response</span></a> on our behalf.</p>
<p>The function returns the dictionary <code class="docutils literal notranslate"><span class="pre">{'project':'tutorial'}</span></code>.  This
dictionary is used by the template named by the <code class="docutils literal notranslate"><span class="pre">mytemplate.pt</span></code> asset
specification to fill in certain values on the page.</p>
</li>
</ol>
</div>
<div class="section" id="configuration-in-development-ini">
<h2>Configuration in <code class="docutils literal notranslate"><span class="pre">development.ini</span></code><a class="headerlink" href="#configuration-in-development-ini" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">development.ini</span></code> (in the <code class="docutils literal notranslate"><span class="pre">tutorial</span></code> <a class="reference internal" href="../../glossary.html#term-project"><span class="xref std std-term">project</span></a> directory, as
opposed to the <code class="docutils literal notranslate"><span class="pre">tutorial</span></code> <a class="reference internal" href="../../glossary.html#term-package"><span class="xref std std-term">package</span></a> directory) looks like this:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1">###</span>
<span class="c1"># app configuration</span>
<span class="c1"># https://docs.pylonsproject.org/projects/pyramid/en/latest/narr/environment.html</span>
<span class="c1">###</span>

<span class="k">[app:main]</span>
<span class="na">use</span> <span class="o">=</span> <span class="s">egg:tutorial</span>

<span class="na">pyramid.reload_templates</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">pyramid.debug_authorization</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">pyramid.debug_notfound</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">pyramid.debug_routematch</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">pyramid.default_locale_name</span> <span class="o">=</span> <span class="s">en</span>
<span class="na">pyramid.includes</span> <span class="o">=</span><span class="s"></span>
<span class="s">    pyramid_debugtoolbar</span>

<span class="na">zodbconn.uri</span> <span class="o">=</span> <span class="s">file://%(here)s/Data.fs?connection_cache_size=20000</span>

<span class="na">retry.attempts</span> <span class="o">=</span> <span class="s">3</span>

<span class="c1"># By default, the toolbar only appears for clients from IP addresses</span>
<span class="c1"># &#39;127.0.0.1&#39; and &#39;::1&#39;.</span>
<span class="c1"># debugtoolbar.hosts = 127.0.0.1 ::1</span>

<span class="c1">###</span>
<span class="c1"># wsgi server configuration</span>
<span class="c1">###</span>

<span class="k">[server:main]</span>
<span class="na">use</span> <span class="o">=</span> <span class="s">egg:waitress#main</span>
<span class="na">listen</span> <span class="o">=</span> <span class="s">localhost:6543</span>

<span class="c1">###</span>
<span class="c1"># logging configuration</span>
<span class="c1"># https://docs.pylonsproject.org/projects/pyramid/en/latest/narr/logging.html</span>
<span class="c1">###</span>

<span class="k">[loggers]</span>
<span class="na">keys</span> <span class="o">=</span> <span class="s">root, tutorial</span>

<span class="k">[handlers]</span>
<span class="na">keys</span> <span class="o">=</span> <span class="s">console</span>

<span class="k">[formatters]</span>
<span class="na">keys</span> <span class="o">=</span> <span class="s">generic</span>

<span class="k">[logger_root]</span>
<span class="na">level</span> <span class="o">=</span> <span class="s">INFO</span>
<span class="na">handlers</span> <span class="o">=</span> <span class="s">console</span>

<span class="k">[logger_tutorial]</span>
<span class="na">level</span> <span class="o">=</span> <span class="s">DEBUG</span>
<span class="na">handlers</span> <span class="o">=</span>
<span class="na">qualname</span> <span class="o">=</span> <span class="s">tutorial</span>

<span class="k">[handler_console]</span>
<span class="na">class</span> <span class="o">=</span> <span class="s">StreamHandler</span>
<span class="na">args</span> <span class="o">=</span> <span class="s">(sys.stderr,)</span>
<span class="na">level</span> <span class="o">=</span> <span class="s">NOTSET</span>
<span class="na">formatter</span> <span class="o">=</span> <span class="s">generic</span>

<span class="k">[formatter_generic]</span>
<span class="na">format</span> <span class="o">=</span> <span class="s">%(asctime)s %(levelname)-5.5s [%(name)s:%(lineno)s][%(threadName)s] %(message)s</span>
</pre></div>
</div>
<p>Note the existence of a <code class="docutils literal notranslate"><span class="pre">[app:main]</span></code> section which specifies our WSGI
application.  Our ZODB database settings are specified as the
<code class="docutils literal notranslate"><span class="pre">zodbconn.uri</span></code> setting within this section.  This value, and the other
values within this section, are passed as <code class="docutils literal notranslate"><span class="pre">**settings</span></code> to the <code class="docutils literal notranslate"><span class="pre">main</span></code>
function we defined in <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> when the server is started via
<code class="docutils literal notranslate"><span class="pre">pserve</span></code>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">Basic Layout</a><ul>
<li><a class="reference internal" href="#application-configuration-with-init-py">Application configuration with <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code></a></li>
<li><a class="reference internal" href="#resources-and-models-with-models-py">Resources and models with <code class="docutils literal notranslate"><span class="pre">models.py</span></code></a></li>
<li><a class="reference internal" href="#views-with-views-py">Views With <code class="docutils literal notranslate"><span class="pre">views.py</span></code></a></li>
<li><a class="reference internal" href="#configuration-in-development-ini">Configuration in <code class="docutils literal notranslate"><span class="pre">development.ini</span></code></a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="installation.html"
                        title="前の章へ">Installation</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="definingmodels.html"
                        title="次の章へ">Defining the Domain Model</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/tutorials/wiki/basiclayout.rst.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="definingmodels.html" title="Defining the Domain Model"
             >次へ</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >前へ</a> |</li>
    	<li><a href="../../index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >ZODB + Traversal Wiki Tutorial</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../../copyright.html">Copyright</a> 2008-2018, Agendaless Consulting.
      最終更新: 8月 18, 2018
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4 で生成しました。
    </div>
  </body>
</html>