
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Internationalization and Localization &#8212; The Pyramid Web Framework v1.9.2</title>
    <link rel="stylesheet" href="../_static/pylons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="next" title="Virtual Hosting" href="vhosting.html" />
    <link rel="prev" title="Command-Line Pyramid" href="commandline.html" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/nobile/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/neuton/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="shortcut icon" href="../_static/pyramid.ico"/>

  </head><body>







<div class="header-small">
	
	<div class="logo-small">
		<a href="../index.html">
      		<img class="logo" src="../_static/pyramid-small.png" alt="Logo"/>
		</a>
  	</div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="vhosting.html" title="Virtual Hosting"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="commandline.html" title="Command-Line Pyramid"
             accesskey="P">前へ</a> |</li>
    	<li><a href="../index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="internationalization-and-localization">
<span id="i18n-chapter"></span><span id="index-0"></span><h1>Internationalization and Localization<a class="headerlink" href="#internationalization-and-localization" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p><a class="reference internal" href="../glossary.html#term-internationalization"><span class="xref std std-term">Internationalization</span></a> (i18n) is the act of creating software with a user
interface that can potentially be displayed in more than one language or
cultural context.  <a class="reference internal" href="../glossary.html#term-localization"><span class="xref std std-term">Localization</span></a> (l10n) is the process of displaying the
user interface of an internationalized application in a <em>particular</em> language
or cultural context.</p>
<p><span>Pyramid</span> offers internationalization and localization subsystems that can
be used to translate the text of buttons, error messages, and other software-
and template-defined values into the native language of a user of your
application.</p>
<div class="section" id="creating-a-translation-string">
<span id="index-1"></span><h2>Creating a Translation String<a class="headerlink" href="#creating-a-translation-string" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>While you write your software, you can insert specialized markup into your
Python code that makes it possible for the system to translate text values into
the languages used by your application's users.  This markup creates a
<a class="reference internal" href="../glossary.html#term-translation-string"><span class="xref std std-term">translation string</span></a>.  A translation string is an object that behaves
mostly like a normal Unicode object, except that it also carries around extra
information related to its job as part of the <span>Pyramid</span> translation
machinery.</p>
<div class="section" id="using-the-translationstring-class">
<h3>Using the <code class="docutils literal notranslate"><span class="pre">TranslationString</span></code> Class<a class="headerlink" href="#using-the-translationstring-class" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>The most primitive way to create a translation string is to use the
<code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.i18n.TranslationString</span></code> callable:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.i18n</span> <span class="kn">import</span> <span class="n">TranslationString</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TranslationString</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>This creates a Unicode-like object that is a TranslationString.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">For people more familiar with <a class="reference internal" href="../glossary.html#term-zope"><span class="xref std std-term">Zope</span></a> i18n, a TranslationString is a
lot like a <code class="docutils literal notranslate"><span class="pre">zope.i18nmessageid.Message</span></code> object.  It is not a subclass,
however.  For people more familiar with <a class="reference internal" href="../glossary.html#term-pylons"><span class="xref std std-term">Pylons</span></a> or <a class="reference internal" href="../glossary.html#term-django"><span class="xref std std-term">Django</span></a>
i18n, using a TranslationString is a lot like using &quot;lazy&quot; versions of
related gettext APIs.</p>
</div>
<p>The first argument to <code class="xref py py-class docutils literal notranslate"><span class="pre">TranslationString</span></code> is the
<code class="docutils literal notranslate"><span class="pre">msgid</span></code>; it is required.  It represents the key into the translation mappings
provided by a particular localization. The <code class="docutils literal notranslate"><span class="pre">msgid</span></code> argument must be a Unicode
object or an ASCII string.  The msgid may optionally contain <em>replacement
markers</em>.  For instance:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.i18n</span> <span class="kn">import</span> <span class="n">TranslationString</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TranslationString</span><span class="p">(</span><span class="s1">&#39;Add ${number}&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Within the string above, <code class="docutils literal notranslate"><span class="pre">${number}</span></code> is a replacement marker.  It will be
replaced by whatever is in the <em>mapping</em> for a translation string.  The mapping
may be supplied at the same time as the replacement marker itself:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.i18n</span> <span class="kn">import</span> <span class="n">TranslationString</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TranslationString</span><span class="p">(</span><span class="s1">&#39;Add ${number}&#39;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
</pre></div>
</td></tr></table></div>
<p>Any number of replacement markers can be present in the msgid value, any number
of times.  Only markers which can be replaced by the values in the <em>mapping</em>
will be replaced at translation time.  The others will not be interpolated and
will be output literally.</p>
<p>A translation string should also usually carry a <em>domain</em>.  The domain
represents a translation category to disambiguate it from other translations of
the same msgid, in case they conflict.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.i18n</span> <span class="kn">import</span> <span class="n">TranslationString</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TranslationString</span><span class="p">(</span><span class="s1">&#39;Add ${number}&#39;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
                       <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;form&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The above translation string named a domain of <code class="docutils literal notranslate"><span class="pre">form</span></code>.  A <a class="reference internal" href="../glossary.html#term-translator"><span class="xref std std-term">translator</span></a>
function will often use the domain to locate the right translator file on the
filesystem which contains translations for a given domain.  In this case, if it
were trying to translate our msgid to German, it might try to find a
translation from a <a class="reference internal" href="../glossary.html#term-gettext"><span class="xref std std-term">gettext</span></a> file within a <a class="reference internal" href="../glossary.html#term-translation-directory"><span class="xref std std-term">translation directory</span></a>
like this one:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>locale/de/LC_MESSAGES/form.mo
</pre></div>
</div>
<p>In other words, it would want to take translations from the <code class="docutils literal notranslate"><span class="pre">form.mo</span></code>
translation file in the German language.</p>
<p>Finally, the TranslationString constructor accepts a <code class="docutils literal notranslate"><span class="pre">default</span></code> argument.  If
a <code class="docutils literal notranslate"><span class="pre">default</span></code> argument is supplied, it replaces usages of the <code class="docutils literal notranslate"><span class="pre">msgid</span></code> as the
<em>default value</em> for the translation string. When <code class="docutils literal notranslate"><span class="pre">default</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the
<code class="docutils literal notranslate"><span class="pre">msgid</span></code> value passed to a TranslationString is used as an implicit message
identifier.  Message identifiers are matched with translations in translation
files, so it is often useful to create translation strings with &quot;opaque&quot;
message identifiers unrelated to their default text:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.i18n</span> <span class="kn">import</span> <span class="n">TranslationString</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TranslationString</span><span class="p">(</span><span class="s1">&#39;add-number&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;Add ${number}&#39;</span><span class="p">,</span>
                        <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;form&#39;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
</pre></div>
</td></tr></table></div>
<p>When default text is used, Default text objects may contain replacement values.</p>
</div>
<div class="section" id="using-the-translationstringfactory-class">
<span id="index-2"></span><h3>Using the <code class="docutils literal notranslate"><span class="pre">TranslationStringFactory</span></code> Class<a class="headerlink" href="#using-the-translationstringfactory-class" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Another way to generate a translation string is to use the
<a class="reference internal" href="../api/i18n.html#pyramid.i18n.TranslationStringFactory" title="pyramid.i18n.TranslationStringFactory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TranslationStringFactory</span></code></a> object.  This object is a
<em>translation string factory</em>.  Basically a translation string factory presets
the <code class="docutils literal notranslate"><span class="pre">domain</span></code> value of any <a class="reference internal" href="../glossary.html#term-translation-string"><span class="xref std std-term">translation string</span></a> generated by using it.
For example:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.i18n</span> <span class="kn">import</span> <span class="n">TranslationStringFactory</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">TranslationStringFactory</span><span class="p">(</span><span class="s1">&#39;pyramid&#39;</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;add-number&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;Add ${number}&#39;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">We assigned the translation string factory to the name <code class="docutils literal notranslate"><span class="pre">_</span></code>.  This
is a convention which will be supported by translation file generation
tools.</p>
</div>
<p>After assigning <code class="docutils literal notranslate"><span class="pre">_</span></code> to the result of a
<a class="reference internal" href="../api/i18n.html#pyramid.i18n.TranslationStringFactory" title="pyramid.i18n.TranslationStringFactory"><code class="xref py py-func docutils literal notranslate"><span class="pre">TranslationStringFactory()</span></code></a>, the subsequent result of
calling <code class="docutils literal notranslate"><span class="pre">_</span></code> will be a <code class="xref py py-class docutils literal notranslate"><span class="pre">TranslationString</span></code> instance.
Even though a <code class="docutils literal notranslate"><span class="pre">domain</span></code> value was not passed to <code class="docutils literal notranslate"><span class="pre">_</span></code> (as would have been
necessary if the <code class="xref py py-class docutils literal notranslate"><span class="pre">TranslationString</span></code> constructor were used
instead of a translation string factory), the <code class="docutils literal notranslate"><span class="pre">domain</span></code> attribute of the
resulting translation string will be <code class="docutils literal notranslate"><span class="pre">pyramid</span></code>.  As a result, the previous
code example is completely equivalent (except for spelling) to:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.i18n</span> <span class="kn">import</span> <span class="n">TranslationString</span> <span class="k">as</span> <span class="n">_</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;add-number&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;Add ${number}&#39;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
       <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;pyramid&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>You can set up your own translation string factory much like the one provided
above by using the <a class="reference internal" href="../api/i18n.html#pyramid.i18n.TranslationStringFactory" title="pyramid.i18n.TranslationStringFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">TranslationStringFactory</span></code></a> class.  For
example, if you'd like to create a translation string factory which presets the
<code class="docutils literal notranslate"><span class="pre">domain</span></code> value of generated translation strings to <code class="docutils literal notranslate"><span class="pre">form</span></code>, you'd do
something like this:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.i18n</span> <span class="kn">import</span> <span class="n">TranslationStringFactory</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">TranslationStringFactory</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;add-number&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;Add ${number}&#39;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
</pre></div>
</td></tr></table></div>
<p>Creating a unique domain for your application via a translation string factory
is best practice.  Using your own unique translation domain allows another
person to reuse your application without needing to merge your translation
files with their own.  Instead they can just include your package's
<a class="reference internal" href="../glossary.html#term-translation-directory"><span class="xref std std-term">translation directory</span></a> via the
<a class="reference internal" href="../api/config.html#pyramid.config.Configurator.add_translation_dirs" title="pyramid.config.Configurator.add_translation_dirs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.add_translation_dirs()</span></code></a> method.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">For people familiar with Zope internationalization, a
TranslationStringFactory is a lot like a
<code class="docutils literal notranslate"><span class="pre">zope.i18nmessageid.MessageFactory</span></code> object.  It is not a subclass,
however.</p>
</div>
</div>
</div>
<div class="section" id="working-with-gettext-translation-files">
<span id="index-3"></span><h2>Working with <code class="docutils literal notranslate"><span class="pre">gettext</span></code> Translation Files<a class="headerlink" href="#working-with-gettext-translation-files" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The basis of <span>Pyramid</span> translation services is GNU <a class="reference internal" href="../glossary.html#term-gettext"><span class="xref std std-term">gettext</span></a>. Once
your application source code files and templates are marked up with translation
markers, you can work on translations by creating various kinds of gettext
files.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">The steps a developer must take to work with <a class="reference internal" href="../glossary.html#term-gettext"><span class="xref std std-term">gettext</span></a> <a class="reference internal" href="../glossary.html#term-message-catalog"><span class="xref std std-term">message
catalog</span></a> files within a <span>Pyramid</span> application are very similar to the
steps a <a class="reference internal" href="../glossary.html#term-pylons"><span class="xref std std-term">Pylons</span></a> developer must take to do the same.  See the
<a class="reference external" href="https://docs.pylonsproject.org/projects/pylons-webframework/en/latest/i18n.html#i18n" title="(in Pylons Framework v1.0.2)"><span class="xref std std-ref">Pylons Internationalization and Localization documentation</span></a> for more information.</p>
</div>
<p>GNU gettext uses three types of files in the translation framework, <code class="docutils literal notranslate"><span class="pre">.pot</span></code>
files, <code class="docutils literal notranslate"><span class="pre">.po</span></code> files, and <code class="docutils literal notranslate"><span class="pre">.mo</span></code> files.</p>
<p><code class="docutils literal notranslate"><span class="pre">.pot</span></code> (Portable Object Template) files</p>
<blockquote>
<div>A <code class="docutils literal notranslate"><span class="pre">.pot</span></code> file is created by a program which searches through your project's
source code and which picks out every <a class="reference internal" href="../glossary.html#term-message-identifier"><span class="xref std std-term">message identifier</span></a> passed to
one of the <code class="docutils literal notranslate"><span class="pre">_()</span></code> functions (e.g., <a class="reference internal" href="../glossary.html#term-translation-string"><span class="xref std std-term">translation string</span></a>
constructions). The list of all message identifiers is placed into a <code class="docutils literal notranslate"><span class="pre">.pot</span></code>
file, which serves as a template for creating <code class="docutils literal notranslate"><span class="pre">.po</span></code> files.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">.po</span></code> (Portable Object) files</p>
<blockquote>
<div>The list of messages in a <code class="docutils literal notranslate"><span class="pre">.pot</span></code> file are translated by a human to a
particular language; the result is saved as a <code class="docutils literal notranslate"><span class="pre">.po</span></code> file.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">.mo</span></code> (Machine Object) files</p>
<blockquote>
<div>A <code class="docutils literal notranslate"><span class="pre">.po</span></code> file is turned into a machine-readable binary file, which is the
<code class="docutils literal notranslate"><span class="pre">.mo</span></code> file. Compiling the translations to machine code makes the
localized program start faster.</div></blockquote>
<p>The tools for working with <a class="reference internal" href="../glossary.html#term-gettext"><span class="xref std std-term">gettext</span></a> translation files related to a
<span>Pyramid</span> application are <a class="reference internal" href="../glossary.html#term-lingua"><span class="xref std std-term">Lingua</span></a> and <a class="reference internal" href="../glossary.html#term-gettext"><span class="xref std std-term">Gettext</span></a>. Lingua can
scrape i18n references out of Python and Chameleon files and create the
<code class="docutils literal notranslate"><span class="pre">.pot</span></code> file. Gettext includes <code class="docutils literal notranslate"><span class="pre">msgmerge</span></code> tool to update a <code class="docutils literal notranslate"><span class="pre">.po</span></code> file from
an updated <code class="docutils literal notranslate"><span class="pre">.pot</span></code> file and <code class="docutils literal notranslate"><span class="pre">msgfmt</span></code> to compile <code class="docutils literal notranslate"><span class="pre">.po</span></code> files to <code class="docutils literal notranslate"><span class="pre">.mo</span></code>
files.</p>
<div class="section" id="installing-lingua-and-gettext">
<span id="installing-babel"></span><span id="index-4"></span><h3>Installing Lingua and Gettext<a class="headerlink" href="#installing-lingua-and-gettext" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>In order for the commands related to working with <code class="docutils literal notranslate"><span class="pre">gettext</span></code> translation files
to work properly, you will need to have <a class="reference internal" href="../glossary.html#term-lingua"><span class="xref std std-term">Lingua</span></a> and <a class="reference internal" href="../glossary.html#term-gettext"><span class="xref std std-term">Gettext</span></a>
installed into the same environment in which <span>Pyramid</span> is installed.</p>
<div class="section" id="installation-on-unix">
<h4>Installation on UNIX<a class="headerlink" href="#installation-on-unix" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>Gettext is often already installed on UNIX systems. You can check if it is
installed by testing if the <code class="docutils literal notranslate"><span class="pre">msgfmt</span></code> command is available. If it is not
available you can install it through the packaging system from your OS; the
package name is almost always <code class="docutils literal notranslate"><span class="pre">gettext</span></code>. For example on a Debian or Ubuntu
system run this command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo apt-get install gettext
</pre></div>
</div>
<p>Installing Lingua is done with the Python packaging tools. If the
<a class="reference internal" href="../glossary.html#term-virtual-environment"><span class="xref std std-term">virtual environment</span></a> into which you've installed your <span>Pyramid</span>
application lives at the environment variable <code class="docutils literal notranslate"><span class="pre">$VENV</span></code>, you can install Lingua
like so:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nv">$VENV</span>/bin/pip install lingua
</pre></div>
</div>
</div>
<div class="section" id="installation-on-windows">
<h4>Installation on Windows<a class="headerlink" href="#installation-on-windows" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>There are several ways to install Gettext on Windows: it is included in the
<a class="reference external" href="http://www.cygwin.com/">Cygwin</a> collection, or you can use the <a class="reference external" href="http://gnuwin32.sourceforge.net/packages/gettext.htm">installer
from the GnuWin32</a>, or
compile it yourself. Make sure the installation path is added to your
<code class="docutils literal notranslate"><span class="pre">$PATH</span></code>.</p>
<p>Installing Lingua is done with the Python packaging tools. If the
<a class="reference internal" href="../glossary.html#term-virtual-environment"><span class="xref std std-term">virtual environment</span></a> into which you've installed your <span>Pyramid</span>
application lives at the environment variable <code class="docutils literal notranslate"><span class="pre">%VENV%</span></code>, you can install
Lingua like so:</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">c:\&gt;</span> <span class="nv">%VENV%</span>\Scripts\pip install lingua
</pre></div>
</div>
</div>
</div>
<div class="section" id="extracting-messages-from-code-and-templates">
<span id="extracting-messages"></span><span id="index-5"></span><h3>Extracting Messages from Code and Templates<a class="headerlink" href="#extracting-messages-from-code-and-templates" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Once Lingua is installed, you may extract a message catalog template from the
code and <a class="reference internal" href="../glossary.html#term-chameleon"><span class="xref std std-term">Chameleon</span></a> templates which reside in your <span>Pyramid</span>
application.  You run a <code class="docutils literal notranslate"><span class="pre">pot-create</span></code> command to extract the messages:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /file/path/to/myapplication_setup.py
$ mkdir -p myapplication/locale
$ <span class="nv">$VENV</span>/bin/pot-create -o myapplication/locale/myapplication.pot src
</pre></div>
</div>
<p>The message catalog <code class="docutils literal notranslate"><span class="pre">.pot</span></code> template will end up in
<code class="docutils literal notranslate"><span class="pre">myapplication/locale/myapplication.pot</span></code>.</p>
</div>
<div class="section" id="initializing-a-message-catalog-file">
<span id="index-6"></span><h3>Initializing a Message Catalog File<a class="headerlink" href="#initializing-a-message-catalog-file" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Once you've extracted messages into a <code class="docutils literal notranslate"><span class="pre">.pot</span></code> file (see
<a class="reference internal" href="#extracting-messages"><span class="std std-ref">Extracting Messages from Code and Templates</span></a>), to begin localizing the messages present in the
<code class="docutils literal notranslate"><span class="pre">.pot</span></code> file, you need to generate at least one <code class="docutils literal notranslate"><span class="pre">.po</span></code> file. A <code class="docutils literal notranslate"><span class="pre">.po</span></code> file
represents translations of a particular set of messages to a particular locale.
Initialize a <code class="docutils literal notranslate"><span class="pre">.po</span></code> file for a specific locale from a pre-generated <code class="docutils literal notranslate"><span class="pre">.pot</span></code>
template by using the <code class="docutils literal notranslate"><span class="pre">msginit</span></code> command from Gettext:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /file/path/to/myapplication_setup.py
$ <span class="nb">cd</span> myapplication/locale
$ mkdir -p es/LC_MESSAGES
$ msginit -l es -o es/LC_MESSAGES/myapplication.po
</pre></div>
</div>
<p>This will create a new message catalog <code class="docutils literal notranslate"><span class="pre">.po</span></code> file in
<code class="docutils literal notranslate"><span class="pre">myapplication/locale/es/LC_MESSAGES/myapplication.po</span></code>.</p>
<p>Once the file is there, it can be worked on by a human translator. One tool
which may help with this is <a class="reference external" href="https://poedit.net/">Poedit</a>.</p>
<p>Note that <span>Pyramid</span> itself ignores the existence of all <code class="docutils literal notranslate"><span class="pre">.po</span></code> files.
For a running application to have translations available, a <code class="docutils literal notranslate"><span class="pre">.mo</span></code> file must
exist.  See <a class="reference internal" href="#compiling-message-catalog"><span class="std std-ref">Compiling a Message Catalog File</span></a>.</p>
</div>
<div class="section" id="updating-a-catalog-file">
<span id="index-7"></span><h3>Updating a Catalog File<a class="headerlink" href="#updating-a-catalog-file" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>If more translation strings are added to your application, or translation
strings change, you will need to update existing <code class="docutils literal notranslate"><span class="pre">.po</span></code> files based on changes
to the <code class="docutils literal notranslate"><span class="pre">.pot</span></code> file, so that the new and changed messages can also be
translated or re-translated.</p>
<p>First, regenerate the <code class="docutils literal notranslate"><span class="pre">.pot</span></code> file as per <a class="reference internal" href="#extracting-messages"><span class="std std-ref">Extracting Messages from Code and Templates</span></a>. Then use
the <code class="docutils literal notranslate"><span class="pre">msgmerge</span></code> command from Gettext.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /file/path/to/myapplication_setup.py
$ <span class="nb">cd</span> myapplication/locale
$ msgmerge --update es/LC_MESSAGES/myapplication.po myapplication.pot
</pre></div>
</div>
</div>
<div class="section" id="compiling-a-message-catalog-file">
<span id="compiling-message-catalog"></span><span id="index-8"></span><h3>Compiling a Message Catalog File<a class="headerlink" href="#compiling-a-message-catalog-file" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Finally, to prepare an application for performing actual runtime translations,
compile <code class="docutils literal notranslate"><span class="pre">.po</span></code> files to <code class="docutils literal notranslate"><span class="pre">.mo</span></code> files using the <code class="docutils literal notranslate"><span class="pre">msgfmt</span></code> command from
Gettext:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /file/path/to/myapplication_setup.py
$ msgfmt -o myapplication/locale/es/LC_MESSAGES/myapplication.mo <span class="se">\</span>
      myapplication/locale/es/LC_MESSAGES/myapplication.po
</pre></div>
</div>
<p>This will create a <code class="docutils literal notranslate"><span class="pre">.mo</span></code> file for each <code class="docutils literal notranslate"><span class="pre">.po</span></code> file in your application.  As
long as the <a class="reference internal" href="../glossary.html#term-translation-directory"><span class="xref std std-term">translation directory</span></a> in which the <code class="docutils literal notranslate"><span class="pre">.mo</span></code> file ends up in
is configured into your application (see
<a class="reference internal" href="#adding-a-translation-directory"><span class="std std-ref">Adding a Translation Directory</span></a>), these translations will be available to
<span>Pyramid</span>.</p>
</div>
</div>
<div class="section" id="using-a-localizer">
<span id="index-9"></span><h2>Using a Localizer<a class="headerlink" href="#using-a-localizer" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A <a class="reference internal" href="../glossary.html#term-localizer"><span class="xref std std-term">localizer</span></a> is an object that allows you to perform translation or
pluralization &quot;by hand&quot; in an application.  You may use the
<a class="reference internal" href="../api/request.html#pyramid.request.Request.localizer" title="pyramid.request.Request.localizer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pyramid.request.Request.localizer</span></code></a> attribute to obtain a
<a class="reference internal" href="../glossary.html#term-localizer"><span class="xref std std-term">localizer</span></a>.  The localizer object will be configured to produce
translations implied by the active <a class="reference internal" href="../glossary.html#term-locale-negotiator"><span class="xref std std-term">locale negotiator</span></a>, or a default
localizer object if no explicit locale negotiator is registered.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">aview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">localizer</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">localizer</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">If you need to create a localizer for a locale, use the
<a class="reference internal" href="../api/i18n.html#pyramid.i18n.make_localizer" title="pyramid.i18n.make_localizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.i18n.make_localizer()</span></code></a> function.</p>
</div>
<div class="section" id="performing-a-translation">
<span id="index-10"></span><span id="id1"></span><h3>Performing a Translation<a class="headerlink" href="#performing-a-translation" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>A <a class="reference internal" href="../glossary.html#term-localizer"><span class="xref std std-term">localizer</span></a> has a <code class="docutils literal notranslate"><span class="pre">translate</span></code> method which accepts either a
<a class="reference internal" href="../glossary.html#term-translation-string"><span class="xref std std-term">translation string</span></a> or a Unicode string and which returns a Unicode
object representing the translation.  Generating a translation in a view
component of an application might look like so:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.i18n</span> <span class="kn">import</span> <span class="n">TranslationString</span>

<span class="n">ts</span> <span class="o">=</span> <span class="n">TranslationString</span><span class="p">(</span><span class="s1">&#39;Add ${number}&#39;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
                       <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;pyramid&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">aview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">localizer</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">localizer</span>
    <span class="n">translated</span> <span class="o">=</span> <span class="n">localizer</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="c1"># translation string</span>
    <span class="c1"># ... use translated ...</span>
</pre></div>
</td></tr></table></div>
<p>The <code class="docutils literal notranslate"><span class="pre">request.localizer</span></code> attribute will be a <a class="reference internal" href="../api/i18n.html#pyramid.i18n.Localizer" title="pyramid.i18n.Localizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyramid.i18n.Localizer</span></code></a>
object bound to the locale name represented by the request.  The translation
returned from its <a class="reference internal" href="../api/i18n.html#pyramid.i18n.Localizer.translate" title="pyramid.i18n.Localizer.translate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.i18n.Localizer.translate()</span></code></a> method will depend
on the <code class="docutils literal notranslate"><span class="pre">domain</span></code> attribute of the provided translation string as well as the
locale of the localizer.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">If you're using <a class="reference internal" href="../glossary.html#term-chameleon"><span class="xref std std-term">Chameleon</span></a> templates, you don't need to pre-translate
translation strings this way.  See <a class="reference internal" href="#chameleon-translation-strings"><span class="std std-ref">Chameleon Template Support for Translation Strings</span></a>.</p>
</div>
</div>
<div class="section" id="performing-a-pluralization">
<span id="index-11"></span><span id="id2"></span><h3>Performing a Pluralization<a class="headerlink" href="#performing-a-pluralization" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>A <a class="reference internal" href="../glossary.html#term-localizer"><span class="xref std std-term">localizer</span></a> has a <code class="docutils literal notranslate"><span class="pre">pluralize</span></code> method with the following signature:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pluralize</span><span class="p">(</span><span class="n">singular</span><span class="p">,</span> <span class="n">plural</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</td></tr></table></div>
<p>The simplest case is the <code class="docutils literal notranslate"><span class="pre">singular</span></code> and <code class="docutils literal notranslate"><span class="pre">plural</span></code> arguments being passed as
Unicode literals. This returns the appropriate literal according to the locale
pluralization rules for the number <code class="docutils literal notranslate"><span class="pre">n</span></code>, and interpolates <code class="docutils literal notranslate"><span class="pre">mapping</span></code>.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">aview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">localizer</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">localizer</span>
    <span class="n">translated</span> <span class="o">=</span> <span class="n">localizer</span><span class="o">.</span><span class="n">pluralize</span><span class="p">(</span><span class="s1">&#39;Item&#39;</span><span class="p">,</span> <span class="s1">&#39;Items&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;mydomain&#39;</span><span class="p">)</span>
    <span class="c1"># ... use translated ...</span>
</pre></div>
</td></tr></table></div>
<p>However, for support of other languages, the <code class="docutils literal notranslate"><span class="pre">singular</span></code> argument should be a
Unicode value representing a <a class="reference internal" href="../glossary.html#term-message-identifier"><span class="xref std std-term">message identifier</span></a>.  In this case the
<code class="docutils literal notranslate"><span class="pre">plural</span></code> value is ignored. <code class="docutils literal notranslate"><span class="pre">domain</span></code> should be a <a class="reference internal" href="../glossary.html#term-translation-domain"><span class="xref std std-term">translation domain</span></a>,
and <code class="docutils literal notranslate"><span class="pre">mapping</span></code> should be a dictionary that is used for <em>replacement value</em>
interpolation of the translated string.</p>
<p>The value of <code class="docutils literal notranslate"><span class="pre">n</span></code> will be used to find the appropriate plural form for the
current language, and <code class="docutils literal notranslate"><span class="pre">pluralize</span></code> will return a Unicode translation for the
message id <code class="docutils literal notranslate"><span class="pre">singular</span></code>. The message file must have defined <code class="docutils literal notranslate"><span class="pre">singular</span></code> as a
translation with plural forms.</p>
<p>The argument provided as <code class="docutils literal notranslate"><span class="pre">singular</span></code> may be a <a class="reference internal" href="../glossary.html#term-translation-string"><span class="xref std std-term">translation string</span></a>
object, but the domain and mapping information attached is ignored.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">aview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">localizer</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">localizer</span>
    <span class="n">num</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">translated</span> <span class="o">=</span> <span class="n">localizer</span><span class="o">.</span><span class="n">pluralize</span><span class="p">(</span><span class="s1">&#39;item_plural&#39;</span><span class="p">,</span> <span class="s1">&#39;${number} items&#39;</span><span class="p">,</span>
        <span class="n">num</span><span class="p">,</span> <span class="s1">&#39;mydomain&#39;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span><span class="n">num</span><span class="p">})</span>
</pre></div>
</td></tr></table></div>
<p>The corresponding message catalog must have language plural definitions and
plural alternatives set.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span>&quot;Plural-Forms: nplurals=3; plural=n==0 ? 0 : n==1 ? 1 : 2;&quot;

msgid &quot;item_plural&quot;
msgid_plural &quot;&quot;
msgstr[0] &quot;No items&quot;
msgstr[1] &quot;${number} item&quot;
msgstr[2] &quot;${number} items&quot;
</pre></div>
</td></tr></table></div>
<p>More information on complex plurals can be found in the <a class="reference external" href="https://www.gnu.org/savannah-checkouts/gnu/gettext/manual/html_node/Plural-forms.html">gettext documentation</a>.</p>
</div>
</div>
<div class="section" id="obtaining-the-locale-name-for-a-request">
<span id="obtaining-the-locale-name"></span><span id="index-12"></span><h2>Obtaining the Locale Name for a Request<a class="headerlink" href="#obtaining-the-locale-name-for-a-request" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>You can obtain the locale name related to a request by using the
<a class="reference internal" href="../api/request.html#pyramid.request.Request.locale_name" title="pyramid.request.Request.locale_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.request.Request.locale_name()</span></code></a> attribute of the request.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">aview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">locale_name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">locale_name</span>
</pre></div>
</td></tr></table></div>
<p>The locale name of a request is dynamically computed; it will be the locale
name negotiated by the currently active <a class="reference internal" href="../glossary.html#term-locale-negotiator"><span class="xref std std-term">locale negotiator</span></a>, or the
<a class="reference internal" href="../glossary.html#term-default-locale-name"><span class="xref std std-term">default locale name</span></a> if the locale negotiator returns <code class="docutils literal notranslate"><span class="pre">None</span></code>. You can
change the default locale name by changing the <code class="docutils literal notranslate"><span class="pre">pyramid.default_locale_name</span></code>
setting. See <a class="reference internal" href="environment.html#default-locale-name-setting"><span class="std std-ref">Default Locale Name</span></a>.</p>
<p>Once <a class="reference internal" href="../api/request.html#pyramid.request.Request.locale_name" title="pyramid.request.Request.locale_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale_name()</span></code></a> is first run, the locale name
is stored on the request object.  Subsequent calls to
<a class="reference internal" href="../api/request.html#pyramid.request.Request.locale_name" title="pyramid.request.Request.locale_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale_name()</span></code></a> will return the stored locale name
without invoking the <a class="reference internal" href="../glossary.html#term-locale-negotiator"><span class="xref std std-term">locale negotiator</span></a>.  To avoid this caching, you can
use the <a class="reference internal" href="../api/i18n.html#pyramid.i18n.negotiate_locale_name" title="pyramid.i18n.negotiate_locale_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyramid.i18n.negotiate_locale_name()</span></code></a> function:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.i18n</span> <span class="kn">import</span> <span class="n">negotiate_locale_name</span>

<span class="k">def</span> <span class="nf">aview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">locale_name</span> <span class="o">=</span> <span class="n">negotiate_locale_name</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>You can also obtain the locale name related to a request using the
<code class="docutils literal notranslate"><span class="pre">locale_name</span></code> attribute of a <a class="reference internal" href="../glossary.html#term-localizer"><span class="xref std std-term">localizer</span></a>.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">aview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">localizer</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">localizer</span>
    <span class="n">locale_name</span> <span class="o">=</span> <span class="n">localizer</span><span class="o">.</span><span class="n">locale_name</span>
</pre></div>
</td></tr></table></div>
<p>Obtaining the locale name as an attribute of a localizer is equivalent to
obtaining a locale name by asking for the
<a class="reference internal" href="../api/request.html#pyramid.request.Request.locale_name" title="pyramid.request.Request.locale_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale_name()</span></code></a> attribute.</p>
</div>
<div class="section" id="performing-date-formatting-and-currency-formatting">
<span id="index-13"></span><h2>Performing Date Formatting and Currency Formatting<a class="headerlink" href="#performing-date-formatting-and-currency-formatting" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><span>Pyramid</span> does not itself perform date and currency formatting for
different locales.  However, <a class="reference internal" href="../glossary.html#term-babel"><span class="xref std std-term">Babel</span></a> can help you do this via the
<code class="xref py py-class docutils literal notranslate"><span class="pre">babel.core.Locale</span></code> class.  The <a class="reference external" href="http://babel.pocoo.org/en/latest/api/core.html#basic-interface">Babel documentation for this class</a> provides
minimal information about how to perform date and currency related locale
operations. See <a class="reference internal" href="#installing-babel"><span class="std std-ref">Installing Lingua and Gettext</span></a> for information about how to install
Babel.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">babel.core.Locale</span></code> class requires a <a class="reference internal" href="../glossary.html#term-locale-name"><span class="xref std std-term">locale name</span></a> as an
argument to its constructor. You can use <span>Pyramid</span> APIs to obtain the
locale name for a request to pass to the <code class="xref py py-class docutils literal notranslate"><span class="pre">babel.core.Locale</span></code>
constructor.  See <a class="reference internal" href="#obtaining-the-locale-name"><span class="std std-ref">Obtaining the Locale Name for a Request</span></a>.  For example:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">babel.core</span> <span class="kn">import</span> <span class="n">Locale</span>

<span class="k">def</span> <span class="nf">aview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">locale_name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">locale_name</span>
    <span class="n">locale</span> <span class="o">=</span> <span class="n">Locale</span><span class="p">(</span><span class="n">locale_name</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="chameleon-template-support-for-translation-strings">
<span id="chameleon-translation-strings"></span><span id="index-14"></span><h2>Chameleon Template Support for Translation Strings<a class="headerlink" href="#chameleon-template-support-for-translation-strings" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>When a <a class="reference internal" href="../glossary.html#term-translation-string"><span class="xref std std-term">translation string</span></a> is used as the subject of textual rendering
by a <a class="reference internal" href="../glossary.html#term-chameleon"><span class="xref std std-term">Chameleon</span></a> template renderer, it will automatically be translated
to the requesting user's language if a suitable translation exists. This is
true of both the ZPT and text variants of the Chameleon template renderers.</p>
<p>For example, in a Chameleon ZPT template, the translation string represented by
&quot;some_translation_string&quot; in each example below will go through translation
before being rendered:</p>
<div class="highlight-xml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;span</span> <span class="na">tal:content=</span><span class="s">&quot;some_translation_string&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-xml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;span</span> <span class="na">tal:replace=</span><span class="s">&quot;some_translation_string&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-xml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;span&gt;</span>${some_translation_string}<span class="nt">&lt;/span&gt;</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-xml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">&lt;a</span> <span class="na">tal:attributes=</span><span class="s">&quot;href some_translation_string&quot;</span><span class="nt">&gt;</span>Click here<span class="nt">&lt;/a&gt;</span>
</pre></div>
</td></tr></table></div>
<p>The features represented by attributes of the <code class="docutils literal notranslate"><span class="pre">i18n</span></code> namespace of Chameleon
will also consult the <span>Pyramid</span> translations. See
<a class="reference external" href="https://chameleon.readthedocs.io/en/latest/reference.html#translation-i18n">https://chameleon.readthedocs.io/en/latest/reference.html#translation-i18n</a>.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">Unlike when Chameleon is used outside of <span>Pyramid</span>, when it is used
<em>within</em> <span>Pyramid</span>, it does not support use of the <code class="docutils literal notranslate"><span class="pre">zope.i18n</span></code>
translation framework.  Applications which use <span>Pyramid</span> should use the
features documented in this chapter rather than <code class="docutils literal notranslate"><span class="pre">zope.i18n</span></code>.</p>
</div>
<p>Third party <span>Pyramid</span> template renderers might not provide this support
out of the box and may need special code to do an equivalent.  For those, you
can always use the more manual translation facility described in
<a class="reference internal" href="#performing-a-translation"><span class="std std-ref">Performing a Translation</span></a>.</p>
</div>
<div class="section" id="mako-pyramid-i18n-support">
<span id="index-15"></span><h2>Mako Pyramid i18n Support<a class="headerlink" href="#mako-pyramid-i18n-support" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>There exists a recipe within the <a class="reference internal" href="../glossary.html#term-pyramid-community-cookbook"><span class="xref std std-term">Pyramid Community Cookbook</span></a> named
<a class="reference external" href="https://docs.pylonsproject.org/projects/pyramid-cookbook/en/latest/templates/mako_i18n.html#mako-i18n" title="(in Pyramid Community Cookbook v0.2)"><span class="xref std std-ref">Mako Internationalization</span></a> which explains how to add
idiomatic i18n support to <a class="reference internal" href="../glossary.html#term-mako"><span class="xref std std-term">Mako</span></a> templates.</p>
</div>
<div class="section" id="jinja2-pyramid-i18n-support">
<span id="index-16"></span><h2>Jinja2 Pyramid i18n Support<a class="headerlink" href="#jinja2-pyramid-i18n-support" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The add-on <a class="reference external" href="https://github.com/Pylons/pyramid_jinja2">pyramid_jinja2</a>
provides a scaffold with an example of how to use internationalization with
Jinja2 in Pyramid. See the documentation sections <a class="reference external" href="https://docs.pylonsproject.org/projects/pyramid-jinja2/en/latest/#internalization-i18n">Internalization (i18n)</a>
and <a class="reference external" href="https://docs.pylonsproject.org/projects/pyramid-jinja2/en/latest/#paster-template-i18n">Paster Template I18N</a>.</p>
</div>
<div class="section" id="localization-related-deployment-settings">
<span id="localization-deployment-settings"></span><span id="index-17"></span><h2>Localization-Related Deployment Settings<a class="headerlink" href="#localization-related-deployment-settings" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A <span>Pyramid</span> application will have a <code class="docutils literal notranslate"><span class="pre">pyramid.default_locale_name</span></code>
setting.  This value represents the <a class="reference internal" href="../glossary.html#term-default-locale-name"><span class="xref std std-term">default locale name</span></a> used when the
<a class="reference internal" href="../glossary.html#term-locale-negotiator"><span class="xref std std-term">locale negotiator</span></a> returns <code class="docutils literal notranslate"><span class="pre">None</span></code>.  Pass it to the
<a class="reference internal" href="../api/config.html#pyramid.config.Configurator" title="pyramid.config.Configurator"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Configurator</span></code></a> constructor at startup time:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.config</span> <span class="kn">import</span> <span class="n">Configurator</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">Configurator</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pyramid.default_locale_name&#39;</span><span class="p">:</span><span class="s1">&#39;de&#39;</span><span class="p">})</span>
</pre></div>
</td></tr></table></div>
<p>You may alternately supply a <code class="docutils literal notranslate"><span class="pre">pyramid.default_locale_name</span></code> via an
application's <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file:</p>
<div class="highlight-ini notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">[app:main]</span>
<span class="na">use</span> <span class="o">=</span> <span class="s">egg:MyProject</span>
<span class="na">pyramid.reload_templates</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">pyramid.debug_authorization</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">pyramid.debug_notfound</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">pyramid.default_locale_name</span> <span class="o">=</span> <span class="s">de</span>
</pre></div>
</td></tr></table></div>
<p>If this value is not supplied via the Configurator constructor or via a config
file, it will default to <code class="docutils literal notranslate"><span class="pre">en</span></code>.</p>
<p>If this setting is supplied within the <span>Pyramid</span> application <code class="docutils literal notranslate"><span class="pre">.ini</span></code>
file, it will be available as a settings key:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.threadlocal</span> <span class="kn">import</span> <span class="n">get_current_registry</span>
<span class="n">settings</span> <span class="o">=</span> <span class="n">get_current_registry</span><span class="p">()</span><span class="o">.</span><span class="n">settings</span>
<span class="n">default_locale_name</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;pyramid.default_locale_name&#39;</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="detecting-available-languages">
<span id="index-18"></span><h2>&quot;Detecting&quot; Available Languages<a class="headerlink" href="#detecting-available-languages" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Other systems provide an API that returns the set of &quot;available languages&quot; as
indicated by the union of all languages in all translation directories on disk
at the time of the call to the API.</p>
<p>It is by design that <span>Pyramid</span> doesn't supply such an API. Instead the
application itself is responsible for knowing the &quot;available languages&quot;.  The
rationale is this: any particular application deployment must always know which
languages it should be translatable to anyway, regardless of which translation
files are on disk.</p>
<p>Here's why: it's not a given that because translations exist in a particular
language within the registered set of translation directories that this
particular deployment wants to allow translation to that language.  For
example, some translations may exist but they may be incomplete or incorrect.
Or there may be translations to a language but not for all translation domains.</p>
<p>Any nontrivial application deployment will always need to be able to
selectively choose to allow only some languages even if that set of languages
is smaller than all those detected within registered translation directories.
The easiest way to allow for this is to make the application entirely
responsible for knowing which languages are allowed to be translated to instead
of relying on the framework to divine this information from translation
directory file info.</p>
<p>You can set up a system to allow a deployer to select available languages based
on convention by using the <a class="reference internal" href="../api/settings.html#module-pyramid.settings" title="pyramid.settings"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyramid.settings</span></code></a> mechanism.</p>
<p>Allow a deployer to modify your application's <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file:</p>
<div class="highlight-ini notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">[app:main]</span>
<span class="na">use</span> <span class="o">=</span> <span class="s">egg:MyProject</span>
<span class="c1"># ...</span>
<span class="na">available_languages</span> <span class="o">=</span> <span class="s">fr de en ru</span>
</pre></div>
</td></tr></table></div>
<p>Then as a part of the code of a custom <a class="reference internal" href="../glossary.html#term-locale-negotiator"><span class="xref std std-term">locale negotiator</span></a>:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.settings</span> <span class="kn">import</span> <span class="n">aslist</span>

<span class="k">def</span> <span class="nf">my_locale_negotiator</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">languages</span> <span class="o">=</span> <span class="n">aslist</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;available_languages&#39;</span><span class="p">])</span>
    <span class="c1"># ...</span>
</pre></div>
</td></tr></table></div>
<p>This is only a suggestion.  You can create your own &quot;available languages&quot;
configuration scheme as necessary.</p>
<span class="target" id="index-19"></span></div>
<div class="section" id="activating-translation">
<span id="index-20"></span><span id="id3"></span><h2>Activating Translation<a class="headerlink" href="#activating-translation" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>By default, a <span>Pyramid</span> application performs no translation. To turn
translation on you must:</p>
<ul class="simple">
<li>add at least one <a class="reference internal" href="../glossary.html#term-translation-directory"><span class="xref std std-term">translation directory</span></a> to your application.</li>
<li>ensure that your application sets the <a class="reference internal" href="../glossary.html#term-locale-name"><span class="xref std std-term">locale name</span></a> correctly.</li>
</ul>
<div class="section" id="adding-a-translation-directory">
<span id="index-21"></span><span id="id4"></span><h3>Adding a Translation Directory<a class="headerlink" href="#adding-a-translation-directory" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p><a class="reference internal" href="../glossary.html#term-gettext"><span class="xref std std-term">gettext</span></a> is the underlying machinery behind the <span>Pyramid</span>
translation machinery.  A translation directory is a directory organized to be
useful to <a class="reference internal" href="../glossary.html#term-gettext"><span class="xref std std-term">gettext</span></a>.  A translation directory usually includes a listing
of language directories, each of which itself includes an <code class="docutils literal notranslate"><span class="pre">LC_MESSAGES</span></code>
directory.  Each <code class="docutils literal notranslate"><span class="pre">LC_MESSAGES</span></code> directory should contain one or more <code class="docutils literal notranslate"><span class="pre">.mo</span></code>
files. Each <code class="docutils literal notranslate"><span class="pre">.mo</span></code> file represents a <a class="reference internal" href="../glossary.html#term-message-catalog"><span class="xref std std-term">message catalog</span></a>, which is used to
provide translations to your application.</p>
<p>Adding a <a class="reference internal" href="../glossary.html#term-translation-directory"><span class="xref std std-term">translation directory</span></a> registers all of its constituent
<a class="reference internal" href="../glossary.html#term-message-catalog"><span class="xref std std-term">message catalog</span></a> files within your <span>Pyramid</span> application to be
available to use for translation services.  This includes all of the <code class="docutils literal notranslate"><span class="pre">.mo</span></code>
files found within all <code class="docutils literal notranslate"><span class="pre">LC_MESSAGES</span></code> directories within each locale directory
in the translation directory.</p>
<p>You can add a translation directory imperatively by using the
<a class="reference internal" href="../api/config.html#pyramid.config.Configurator.add_translation_dirs" title="pyramid.config.Configurator.add_translation_dirs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.add_translation_dirs()</span></code></a> during application
startup.  For example:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.config</span> <span class="kn">import</span> <span class="n">Configurator</span>
<span class="n">config</span><span class="o">.</span><span class="n">add_translation_dirs</span><span class="p">(</span><span class="s1">&#39;my.application:locale/&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;another.application:locale/&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>A message catalog in a translation directory added via
<a class="reference internal" href="../api/config.html#pyramid.config.Configurator.add_translation_dirs" title="pyramid.config.Configurator.add_translation_dirs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_translation_dirs()</span></code></a> will be merged into
translations from a message catalog added earlier if both translation
directories contain translations for the same locale and <a class="reference internal" href="../glossary.html#term-translation-domain"><span class="xref std std-term">translation
domain</span></a>.</p>
</div>
<div class="section" id="setting-the-locale">
<span id="index-22"></span><h3>Setting the Locale<a class="headerlink" href="#setting-the-locale" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>When the <em>default locale negotiator</em> (see <a class="reference internal" href="#default-locale-negotiator"><span class="std std-ref">The Default Locale Negotiator</span></a>) is
in use, you can inform <span>Pyramid</span> of the current locale name by doing any
of these things before any translations need to be performed:</p>
<ul class="simple">
<li>Set the <code class="docutils literal notranslate"><span class="pre">_LOCALE_</span></code> attribute of the request to a valid locale name (usually
directly within view code), e.g., <code class="docutils literal notranslate"><span class="pre">request._LOCALE_</span> <span class="pre">=</span> <span class="pre">'de'</span></code>.</li>
<li>Ensure that a valid locale name value is in the <code class="docutils literal notranslate"><span class="pre">request.params</span></code> dictionary
under the key named <code class="docutils literal notranslate"><span class="pre">_LOCALE_</span></code>.  This is usually the result of passing a
<code class="docutils literal notranslate"><span class="pre">_LOCALE_</span></code> value in the query string or in the body of a form post
associated with a request.  For example, visiting
<code class="docutils literal notranslate"><span class="pre">http://my.application?_LOCALE_=de</span></code>.</li>
<li>Ensure that a valid locale name value is in the <code class="docutils literal notranslate"><span class="pre">request.cookies</span></code>
dictionary under the key named <code class="docutils literal notranslate"><span class="pre">_LOCALE_</span></code>.  This is usually the result of
setting a <code class="docutils literal notranslate"><span class="pre">_LOCALE_</span></code> cookie in a prior response, e.g.,
<code class="docutils literal notranslate"><span class="pre">response.set_cookie('_LOCALE_',</span> <span class="pre">'de')</span></code>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">If this locale negotiation scheme is inappropriate for a particular
application, you can configure a custom <a class="reference internal" href="../glossary.html#term-locale-negotiator"><span class="xref std std-term">locale negotiator</span></a> function
into that application as required.  See <a class="reference internal" href="#custom-locale-negotiator"><span class="std std-ref">Using a Custom Locale Negotiator</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="locale-negotiators">
<span id="index-23"></span><span id="id5"></span><h2>Locale Negotiators<a class="headerlink" href="#locale-negotiators" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>A <a class="reference internal" href="../glossary.html#term-locale-negotiator"><span class="xref std std-term">locale negotiator</span></a> informs the operation of a <a class="reference internal" href="../glossary.html#term-localizer"><span class="xref std std-term">localizer</span></a> by
telling it what <a class="reference internal" href="../glossary.html#term-locale-name"><span class="xref std std-term">locale name</span></a> is related to a particular request.  A
locale negotiator is a bit of code which accepts a request and which returns a
<a class="reference internal" href="../glossary.html#term-locale-name"><span class="xref std std-term">locale name</span></a>.  It is consulted when
<a class="reference internal" href="../api/i18n.html#pyramid.i18n.Localizer.translate" title="pyramid.i18n.Localizer.translate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.i18n.Localizer.translate()</span></code></a> or
<a class="reference internal" href="../api/i18n.html#pyramid.i18n.Localizer.pluralize" title="pyramid.i18n.Localizer.pluralize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.i18n.Localizer.pluralize()</span></code></a> is invoked.  It is also consulted when
<a class="reference internal" href="../api/request.html#pyramid.request.Request.locale_name" title="pyramid.request.Request.locale_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale_name()</span></code></a> is accessed or when
<a class="reference internal" href="../api/i18n.html#pyramid.i18n.negotiate_locale_name" title="pyramid.i18n.negotiate_locale_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">negotiate_locale_name()</span></code></a> is invoked.</p>
<div class="section" id="the-default-locale-negotiator">
<span id="default-locale-negotiator"></span><h3>The Default Locale Negotiator<a class="headerlink" href="#the-default-locale-negotiator" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Most applications can make use of the default locale negotiator, which requires
no additional coding or configuration.</p>
<p>The default locale negotiator implementation named
<a class="reference internal" href="../api/i18n.html#pyramid.i18n.default_locale_negotiator" title="pyramid.i18n.default_locale_negotiator"><code class="xref py py-class docutils literal notranslate"><span class="pre">default_locale_negotiator</span></code></a> uses the following set of
steps to determine the locale name.</p>
<ul class="simple">
<li>First the negotiator looks for the <code class="docutils literal notranslate"><span class="pre">_LOCALE_</span></code> attribute of the request
object (possibly set directly by view code or by a listener for an
<a class="reference internal" href="../glossary.html#term-event"><span class="xref std std-term">event</span></a>).</li>
<li>Then it looks for the <code class="docutils literal notranslate"><span class="pre">request.params['_LOCALE_']</span></code> value.</li>
<li>Then it looks for the <code class="docutils literal notranslate"><span class="pre">request.cookies['_LOCALE_']</span></code> value.</li>
<li>If no locale can be found via the request, it falls back to using the
<a class="reference internal" href="../glossary.html#term-default-locale-name"><span class="xref std std-term">default locale name</span></a> (see <a class="reference internal" href="#localization-deployment-settings"><span class="std std-ref">Localization-Related Deployment Settings</span></a>).</li>
<li>Finally if the default locale name is not explicitly set, it uses the locale
name <code class="docutils literal notranslate"><span class="pre">en</span></code>.</li>
</ul>
</div>
<div class="section" id="using-a-custom-locale-negotiator">
<span id="custom-locale-negotiator"></span><h3>Using a Custom Locale Negotiator<a class="headerlink" href="#using-a-custom-locale-negotiator" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Locale negotiation is sometimes policy-laden and complex.  If the (simple)
default locale negotiation scheme described in <a class="reference internal" href="#activating-translation"><span class="std std-ref">Activating Translation</span></a> is
inappropriate for your application, you may create a special <a class="reference internal" href="../glossary.html#term-locale-negotiator"><span class="xref std std-term">locale
negotiator</span></a>.  Subsequently you may override the default locale negotiator by
adding your newly created locale negotiator to your application's
configuration.</p>
<p>A locale negotiator is simply a callable which accepts a request and returns a
single <a class="reference internal" href="../glossary.html#term-locale-name"><span class="xref std std-term">locale name</span></a> or <code class="docutils literal notranslate"><span class="pre">None</span></code> if no locale can be determined.</p>
<p>Here's an implementation of a simple locale negotiator:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_locale_negotiator</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">locale_name</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;my_locale&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">locale_name</span>
</pre></div>
</td></tr></table></div>
<p>If a locale negotiator returns <code class="docutils literal notranslate"><span class="pre">None</span></code>, it signifies to <span>Pyramid</span> that
the default application locale name should be used.</p>
<p>You may add your newly created locale negotiator to your application's
configuration by passing an object which can act as the negotiator (or a
<a class="reference internal" href="../glossary.html#term-dotted-python-name"><span class="xref std std-term">dotted Python name</span></a> referring to the object) as the
<code class="docutils literal notranslate"><span class="pre">locale_negotiator</span></code> argument of the <a class="reference internal" href="../api/config.html#pyramid.config.Configurator" title="pyramid.config.Configurator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Configurator</span></code></a>
instance during application startup.  For example:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.config</span> <span class="kn">import</span> <span class="n">Configurator</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">Configurator</span><span class="p">(</span><span class="n">locale_negotiator</span><span class="o">=</span><span class="n">my_locale_negotiator</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Alternatively, use the
<a class="reference internal" href="../api/config.html#pyramid.config.Configurator.set_locale_negotiator" title="pyramid.config.Configurator.set_locale_negotiator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyramid.config.Configurator.set_locale_negotiator()</span></code></a> method.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.config</span> <span class="kn">import</span> <span class="n">Configurator</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">Configurator</span><span class="p">()</span>
<span class="n">config</span><span class="o">.</span><span class="n">set_locale_negotiator</span><span class="p">(</span><span class="n">my_locale_negotiator</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Internationalization and Localization</a><ul>
<li><a class="reference internal" href="#creating-a-translation-string">Creating a Translation String</a><ul>
<li><a class="reference internal" href="#using-the-translationstring-class">Using the <code class="docutils literal notranslate"><span class="pre">TranslationString</span></code> Class</a></li>
<li><a class="reference internal" href="#using-the-translationstringfactory-class">Using the <code class="docutils literal notranslate"><span class="pre">TranslationStringFactory</span></code> Class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-gettext-translation-files">Working with <code class="docutils literal notranslate"><span class="pre">gettext</span></code> Translation Files</a><ul>
<li><a class="reference internal" href="#installing-lingua-and-gettext">Installing Lingua and Gettext</a><ul>
<li><a class="reference internal" href="#installation-on-unix">Installation on UNIX</a></li>
<li><a class="reference internal" href="#installation-on-windows">Installation on Windows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extracting-messages-from-code-and-templates">Extracting Messages from Code and Templates</a></li>
<li><a class="reference internal" href="#initializing-a-message-catalog-file">Initializing a Message Catalog File</a></li>
<li><a class="reference internal" href="#updating-a-catalog-file">Updating a Catalog File</a></li>
<li><a class="reference internal" href="#compiling-a-message-catalog-file">Compiling a Message Catalog File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-a-localizer">Using a Localizer</a><ul>
<li><a class="reference internal" href="#performing-a-translation">Performing a Translation</a></li>
<li><a class="reference internal" href="#performing-a-pluralization">Performing a Pluralization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#obtaining-the-locale-name-for-a-request">Obtaining the Locale Name for a Request</a></li>
<li><a class="reference internal" href="#performing-date-formatting-and-currency-formatting">Performing Date Formatting and Currency Formatting</a></li>
<li><a class="reference internal" href="#chameleon-template-support-for-translation-strings">Chameleon Template Support for Translation Strings</a></li>
<li><a class="reference internal" href="#mako-pyramid-i18n-support">Mako Pyramid i18n Support</a></li>
<li><a class="reference internal" href="#jinja2-pyramid-i18n-support">Jinja2 Pyramid i18n Support</a></li>
<li><a class="reference internal" href="#localization-related-deployment-settings">Localization-Related Deployment Settings</a></li>
<li><a class="reference internal" href="#detecting-available-languages">&quot;Detecting&quot; Available Languages</a></li>
<li><a class="reference internal" href="#activating-translation">Activating Translation</a><ul>
<li><a class="reference internal" href="#adding-a-translation-directory">Adding a Translation Directory</a></li>
<li><a class="reference internal" href="#setting-the-locale">Setting the Locale</a></li>
</ul>
</li>
<li><a class="reference internal" href="#locale-negotiators">Locale Negotiators</a><ul>
<li><a class="reference internal" href="#the-default-locale-negotiator">The Default Locale Negotiator</a></li>
<li><a class="reference internal" href="#using-a-custom-locale-negotiator">Using a Custom Locale Negotiator</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="commandline.html"
                        title="前の章へ">Command-Line Pyramid</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="vhosting.html"
                        title="次の章へ">Virtual Hosting</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/narr/i18n.rst.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="vhosting.html" title="Virtual Hosting"
             >次へ</a> |</li>
        <li class="right" >
          <a href="commandline.html" title="Command-Line Pyramid"
             >前へ</a> |</li>
    	<li><a href="../index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2008-2018, Agendaless Consulting.
      最終更新: 11月 02, 2018
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1 で生成しました。
    </div>
  </body>
</html>