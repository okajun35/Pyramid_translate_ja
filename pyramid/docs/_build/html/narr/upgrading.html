
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Upgrading Pyramid &#8212; The Pyramid Web Framework v1.9.2</title>
    <link rel="stylesheet" href="../_static/pylons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="next" title="Thread Locals" href="threadlocals.html" />
    <link rel="prev" title="Creating Pyramid Scaffolds" href="scaffolding.html" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/nobile/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="//static.pylonsproject.org/fonts/neuton/stylesheet.css" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->
<link rel="shortcut icon" href="../_static/pyramid.ico"/>

  </head><body>







<div class="header-small">
	
	<div class="logo-small">
		<a href="../index.html">
      		<img class="logo" src="../_static/pyramid-small.png" alt="Logo"/>
		</a>
  	</div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="threadlocals.html" title="Thread Locals"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="scaffolding.html" title="Creating Pyramid Scaffolds"
             accesskey="P">前へ</a> |</li>
    	<li><a href="../index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="upgrading-pyramid">
<span id="upgrading-chapter"></span><h1>Upgrading Pyramid<a class="headerlink" href="#upgrading-pyramid" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>When a new version of Pyramid is released, it will sometimes deprecate a
feature or remove a feature that was deprecated in an older release.  When
features are removed from Pyramid, applications that depend on those features
will begin to break.  This chapter explains how to ensure your Pyramid
applications keep working when you upgrade the Pyramid version you're using.</p>
<div class="sidebar">
<p class="first sidebar-title">About Release Numbering</p>
<p class="last">Conventionally, application version numbering in Python is described as
<code class="docutils literal notranslate"><span class="pre">major.minor.micro</span></code>.  If your Pyramid version is &quot;1.2.3&quot;, it means you're
running a version of Pyramid with the major version &quot;1&quot;, the minor version
&quot;2&quot; and the micro version &quot;3&quot;.  A &quot;major&quot; release is one that increments the
first-dot number; 2.X.X might follow 1.X.X.  A &quot;minor&quot; release is one that
increments the second-dot number; 1.3.X might follow 1.2.X.  A &quot;micro&quot;
release is one that increments the third-dot number; 1.2.3 might follow
1.2.2.  In general, micro releases are &quot;bugfix-only&quot;, and contain no new
features, minor releases contain new features but are largely backwards
compatible with older versions, and a major release indicates a large set of
backwards incompatibilities.</p>
</div>
<p>The Pyramid core team is conservative when it comes to removing features.  We
don't remove features unnecessarily, but we're human and we make mistakes which
cause some features to be evolutionary dead ends.  Though we are willing to
support dead-end features for some amount of time, some eventually have to be
removed when the cost of supporting them outweighs the benefit of keeping them
around, because each feature in Pyramid represents a certain documentation and
maintenance burden.</p>
<div class="section" id="deprecation-and-removal-policy">
<h2>Deprecation and removal policy<a class="headerlink" href="#deprecation-and-removal-policy" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>When a feature is scheduled for removal from Pyramid or any of its official
add-ons, the core development team takes these steps:</p>
<ul class="simple">
<li>Using the feature will begin to generate a <cite>DeprecationWarning</cite>, indicating
the version in which the feature became deprecated.</li>
<li>A note is added to the documentation indicating that the feature is
deprecated.</li>
<li>A note is added to the <a class="reference internal" href="../changes.html#changelog"><span class="std std-ref">Pyramid Change History</span></a> about the deprecation.</li>
</ul>
<p>When a deprecated feature is eventually removed:</p>
<ul class="simple">
<li>The feature is removed.</li>
<li>A note is added to the <a class="reference internal" href="../changes.html#changelog"><span class="std std-ref">Pyramid Change History</span></a> about the removal.</li>
</ul>
<p>Features are never removed in <em>micro</em> releases.  They are only removed in minor
and major releases.  Deprecated features are kept around for at least <em>three</em>
minor releases from the time the feature became deprecated. Therefore, if a
feature is added in Pyramid 1.0, but it's deprecated in Pyramid 1.1, it will be
kept around through all 1.1.X releases, all 1.2.X releases and all 1.3.X
releases.  It will finally be removed in the first 1.4.X release.</p>
<p>Sometimes features are &quot;docs-deprecated&quot; instead of formally deprecated. This
means that the feature will be kept around indefinitely, but it will be removed
from the documentation or a note will be added to the documentation telling
folks to use some other newer feature.  This happens when the cost of keeping
an old feature around is very minimal and the support and documentation burden
is very low.  For example, we might rename a function that is an API without
changing the arguments it accepts.  In this case, we'll often rename the
function, and change the docs to point at the new function name, but leave
around a backwards compatibility alias to the old function name so older code
doesn't break.</p>
<p>&quot;Docs deprecated&quot; features tend to work &quot;forever&quot;, meaning that they won't be
removed, and they'll never generate a deprecation warning.  However, such
changes are noted in the <a class="reference internal" href="../changes.html#changelog"><span class="std std-ref">Pyramid Change History</span></a>, so it's possible to know that you
should change older spellings to newer ones to ensure that people reading your
code can find the APIs you're using in the Pyramid docs.</p>
<div class="section" id="python-support-policy">
<h3>Python support policy<a class="headerlink" href="#python-support-policy" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>At the time of a Pyramid version release, each supports all versions of Python
through the end of their lifespans. The end-of-life for a given version of
Python is when security updates are no longer released.</p>
<ul class="simple">
<li><a class="reference external" href="https://www.python.org/dev/peps/pep-0392/#lifespan">Python 3.2 Lifespan</a>
ends February 2016.</li>
<li><a class="reference external" href="https://www.python.org/dev/peps/pep-0392/#lifespan">Python 3.3 Lifespan</a>
ends September 2017.</li>
<li><a class="reference external" href="https://www.python.org/dev/peps/pep-0429/">Python 3.4 Lifespan</a> TBD.</li>
<li><a class="reference external" href="https://www.python.org/dev/peps/pep-0478/">Python 3.5 Lifespan</a> TBD.</li>
<li><a class="reference external" href="https://www.python.org/dev/peps/pep-0494/#id4">Python 3.6 Lifespan</a>
December 2021.</li>
</ul>
<p>To determine the Python support for a specific release of Pyramid, view its
<code class="docutils literal notranslate"><span class="pre">tox.ini</span></code> file at the root of the repository's version.</p>
</div>
</div>
<div class="section" id="consulting-the-change-history">
<h2>Consulting the change history<a class="headerlink" href="#consulting-the-change-history" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Your first line of defense against application failures caused by upgrading to
a newer Pyramid release is always to read the <a class="reference internal" href="../changes.html#changelog"><span class="std std-ref">Pyramid Change History</span></a> to find the
deprecations and removals for each release between the release you're currently
running and the one to which you wish to upgrade.  The change history notes
every deprecation within a <code class="docutils literal notranslate"><span class="pre">Deprecation</span></code> section and every removal within a
<code class="docutils literal notranslate"><span class="pre">Backwards</span> <span class="pre">Incompatibilies</span></code> section for each release.</p>
<p>The change history often contains instructions for changing your code to avoid
deprecation warnings and how to change docs-deprecated spellings to newer ones.
You can follow along with each deprecation explanation in the change history,
simply doing a grep or other code search to your application, using the change
log examples to remediate each potential problem.</p>
</div>
<div class="section" id="testing-your-application-under-a-new-pyramid-release">
<span id="testing-under-new-release"></span><h2>Testing your application under a new Pyramid release<a class="headerlink" href="#testing-your-application-under-a-new-pyramid-release" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Once you've upgraded your application to a new Pyramid release and you've
remediated as much as possible by using the change history notes, you'll want
to run your application's tests (see <a class="reference internal" href="../tutorials/wiki/installation.html#running-tests"><span class="std std-ref">Run the tests</span></a>) in such a way that
you can see DeprecationWarnings printed to the console when the tests run.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python -Wd setup.py <span class="nb">test</span> -q
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-Wd</span></code> argument tells Python to print deprecation warnings to the console.
See <a class="reference external" href="https://docs.python.org/2/using/cmdline.html#cmdoption-W">the Python -W flag documentation</a> for more
information.</p>
<p>As your tests run, deprecation warnings will be printed to the console
explaining the deprecation and providing instructions about how to prevent the
deprecation warning from being issued.  For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python -Wd setup.py <span class="nb">test</span> -q
<span class="c1"># .. elided ...</span>
running build_ext
/home/chrism/projects/pyramid/env27/myproj/myproj/views.py:3:
DeprecationWarning: static: The <span class="s2">&quot;pyramid.view.static&quot;</span> class is deprecated
as of Pyramid <span class="m">1</span>.1<span class="p">;</span> use the <span class="s2">&quot;pyramid.static.static_view&quot;</span> class instead with
the <span class="s2">&quot;use_subpath&quot;</span> argument <span class="nb">set</span> to True.
  from pyramid.view import static
.
----------------------------------------------------------------------
Ran <span class="m">1</span> <span class="nb">test</span> in <span class="m">0</span>.014s

OK
</pre></div>
</div>
<p>In the above case, it's line #3 in the <code class="docutils literal notranslate"><span class="pre">myproj.views</span></code> module (<code class="docutils literal notranslate"><span class="pre">from</span>
<span class="pre">pyramid.view</span> <span class="pre">import</span> <span class="pre">static</span></code>) that is causing the problem:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.view</span> <span class="kn">import</span> <span class="n">view_config</span>

<span class="kn">from</span> <span class="nn">pyramid.view</span> <span class="kn">import</span> <span class="n">static</span>
<span class="n">myview</span> <span class="o">=</span> <span class="n">static</span><span class="p">(</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;static&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The deprecation warning tells me how to fix it, so I can change the code to do
things the newer way:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyramid.view</span> <span class="kn">import</span> <span class="n">view_config</span>

<span class="kn">from</span> <span class="nn">pyramid.static</span> <span class="kn">import</span> <span class="n">static_view</span>
<span class="n">myview</span> <span class="o">=</span> <span class="n">static_view</span><span class="p">(</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="n">use_subpath</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>When I run the tests again, the deprecation warning is no longer printed to my
console:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python -Wd setup.py <span class="nb">test</span> -q
<span class="c1"># .. elided ...</span>
running build_ext
.
----------------------------------------------------------------------
Ran <span class="m">1</span> <span class="nb">test</span> in <span class="m">0</span>.014s

OK
</pre></div>
</div>
</div>
<div class="section" id="my-application-doesn-t-have-any-tests-or-has-few-tests">
<h2>My application doesn't have any tests or has few tests<a class="headerlink" href="#my-application-doesn-t-have-any-tests-or-has-few-tests" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>If your application has no tests, or has only moderate test coverage, running
tests won't tell you very much, because the Pyramid codepaths that generate
deprecation warnings won't be executed.</p>
<p>In this circumstance, you can start your application interactively under a
server run with the <code class="docutils literal notranslate"><span class="pre">PYTHONWARNINGS</span></code> environment variable set to <code class="docutils literal notranslate"><span class="pre">default</span></code>.
On UNIX, you can do that via:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nv">PYTHONWARNINGS</span><span class="o">=</span>default <span class="nv">$VENV</span>/bin/pserve development.ini
</pre></div>
</div>
<p>On Windows, you need to issue two commands:</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">c:\&gt;</span> <span class="k">set</span> <span class="nv">PYTHONWARNINGS</span><span class="p">=</span>default
<span class="gp">c:\&gt;</span> Scripts\pserve development.ini
</pre></div>
</div>
<p>At this point, it's ensured that deprecation warnings will be printed to the
console whenever a codepath is hit that generates one.  You can then click
around in your application interactively to try to generate them, and remediate
as explained in <a class="reference internal" href="#testing-under-new-release"><span class="std std-ref">Testing your application under a new Pyramid release</span></a>.</p>
<p>See <a class="reference external" href="https://docs.python.org/2/using/cmdline.html#envvar-PYTHONWARNINGS">the PYTHONWARNINGS environment variable documentation</a> or <a class="reference external" href="https://docs.python.org/2/using/cmdline.html#cmdoption-W">the
Python -W flag documentation</a> for more
information.</p>
</div>
<div class="section" id="upgrading-to-the-very-latest-pyramid-release">
<h2>Upgrading to the very latest Pyramid release<a class="headerlink" href="#upgrading-to-the-very-latest-pyramid-release" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>When you upgrade your application to the most recent Pyramid release,
it's advisable to upgrade step-wise through each most recent minor release,
beginning with the one that you know your application currently runs under,
and ending on the most recent release.  For example, if your application is
running in production on Pyramid 1.2.1, and the most recent Pyramid 1.3
release is Pyramid 1.3.3, and the most recent Pyramid release is 1.4.4, it's
advisable to do this:</p>
<ul class="simple">
<li>Upgrade your environment to the most recent 1.2 release.  For example, the
most recent 1.2 release might be 1.2.3, so upgrade to it.  Then run your
application's tests under 1.2.3 as described in
<a class="reference internal" href="#testing-under-new-release"><span class="std std-ref">Testing your application under a new Pyramid release</span></a>.  Note any deprecation warnings and
remediate.</li>
<li>Upgrade to the most recent 1.3 release, 1.3.3.  Run your application's tests,
note any deprecation warnings, and remediate.</li>
<li>Upgrade to 1.4.4.  Run your application's tests, note any deprecation
warnings, and remediate.</li>
</ul>
<p>If you skip testing your application under each minor release (for example if
you upgrade directly from 1.2.1 to 1.4.4), you might miss a deprecation warning
and waste more time trying to figure out an error caused by a feature removal
than it would take to upgrade stepwise through each minor release.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Upgrading Pyramid</a><ul>
<li><a class="reference internal" href="#deprecation-and-removal-policy">Deprecation and removal policy</a><ul>
<li><a class="reference internal" href="#python-support-policy">Python support policy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#consulting-the-change-history">Consulting the change history</a></li>
<li><a class="reference internal" href="#testing-your-application-under-a-new-pyramid-release">Testing your application under a new Pyramid release</a></li>
<li><a class="reference internal" href="#my-application-doesn-t-have-any-tests-or-has-few-tests">My application doesn't have any tests or has few tests</a></li>
<li><a class="reference internal" href="#upgrading-to-the-very-latest-pyramid-release">Upgrading to the very latest Pyramid release</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="scaffolding.html"
                        title="前の章へ">Creating Pyramid Scaffolds</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="threadlocals.html"
                        title="次の章へ">Thread Locals</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/narr/upgrading.rst.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="threadlocals.html" title="Thread Locals"
             >次へ</a> |</li>
        <li class="right" >
          <a href="scaffolding.html" title="Creating Pyramid Scaffolds"
             >前へ</a> |</li>
    	<li><a href="../index.html">The Pyramid Web Framework v1.9.2</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2008-2018, Agendaless Consulting.
      最終更新: 10月 30, 2018
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1 で生成しました。
    </div>
  </body>
</html>